<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synesthesia - MIDI Visualizer Collection</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #000;
            color: #fff;
            overflow-x: hidden;
        }
        
        .bg-gradient {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at top, #1e3a8a 0%, #000 50%);
            opacity: 0.6;
            z-index: -1;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 60px;
            padding: 40px 20px;
        }
        
        h1 {
            font-size: 48px;
            font-weight: 700;
            background: linear-gradient(135deg, #3a86ff, #8338ec, #ff006e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
        }
        
        .subtitle {
            font-size: 24px;
            color: #aaa;
            margin-bottom: 10px;
        }
        
        .visualizers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 60px;
        }
        
        .visualizer-card {
            background: rgba(20, 20, 40, 0.8);
            border: 2px solid rgba(58, 134, 255, 0.3);
            border-radius: 15px;
            padding: 30px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .visualizer-card:hover {
            border-color: rgba(58, 134, 255, 0.8);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(58, 134, 255, 0.3);
        }
        
        .visualizer-card h3 {
            color: #3a86ff;
            font-size: 24px;
            margin-bottom: 15px;
        }
        
        .visualizer-card p {
            color: #aaa;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        .badge {
            display: inline-block;
            padding: 6px 12px;
            background: rgba(58, 134, 255, 0.2);
            color: #3a86ff;
            border-radius: 6px;
            font-size: 12px;
            margin-right: 8px;
            margin-bottom: 8px;
        }
        
        .launch-btn {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(135deg, #3a86ff, #8338ec);
            color: #fff;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 14px;
        }
        
        .launch-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(58, 134, 255, 0.4);
        }
        
        .back-btn {
            display: inline-block;
            padding: 12px 24px;
            background: rgba(58, 134, 255, 0.2);
            color: #3a86ff;
            border: 2px solid rgba(58, 134, 255, 0.3);
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 20px;
        }
        
        .back-btn:hover {
            background: rgba(58, 134, 255, 0.3);
            border-color: rgba(58, 134, 255, 0.6);
        }
        
        .visualizer-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 1000;
        }
        
        .visualizer-container.active {
            display: flex;
            flex-direction: column;
        }
        
        .visualizer-header {
            padding: 15px 20px;
            background: rgba(20, 20, 40, 0.95);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid rgba(58, 134, 255, 0.3);
        }
        
        .visualizer-header h2 {
            color: #3a86ff;
            font-size: 20px;
        }
        
        .visualizer-content {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        .visualizer-iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        
        footer {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            h1 { font-size: 32px; }
            .subtitle { font-size: 18px; }
            .visualizers-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="bg-gradient"></div>
    
    <!-- Main Landing Page -->
    <div id="landing" class="container">
        <header>
            <h1>Synesthesia</h1>
            <p class="subtitle">The Sound of Colour</p>
        </header>
        
        <div class="visualizers-grid">
            <div class="visualizer-card" onclick="loadVisualizer('visualizer1')">
                <h3>Original Lightweight</h3>
                <div>
                    <span class="badge">Core</span>
                    <span class="badge">v1.0</span>
                </div>
                <p>The foundation version with Newton's color wheel mapping, chord detection, and extensive background customization options including gradient mixer and additive color modes.</p>
                <button class="launch-btn">Launch →</button>
            </div>
            
            <div class="visualizer-card" onclick="loadVisualizer('visualizer2')">
                <h3>Oscilloscope</h3>
                <div>
                    <span class="badge">Technical</span>
                    <span class="badge">v1.1</span>
                </div>
                <p>Real-time waveform visualization. MIDI notes converted to sine waves at their actual frequencies, with dynamic horizontal scrolling and additive color mixing.</p>
                <button class="launch-btn">Launch →</button>
            </div>
            
            <div class="visualizer-card" onclick="loadVisualizer('visualizer3')">
                <h3>MIDI Grid Visualizer</h3>
                <div>
                    <span class="badge">Grid</span>
                    <span class="badge">v1.0</span>
                </div>
                <p>Grid-based visualization displaying MIDI notes in a structured layout with precise timing and visual feedback.</p>
                <button class="launch-btn">Launch →</button>
            </div>
            
            <div class="visualizer-card" onclick="loadVisualizer('visualizer4')">
                <h3>MIDI Visualizer Recorder</h3>
                <div>
                    <span class="badge">Recorder</span>
                    <span class="badge">v1.0</span>
                </div>
                <p>Advanced visualizer with recording capabilities, allowing you to capture and replay your MIDI performances.</p>
                <button class="launch-btn">Launch →</button>
            </div>
        </div>
        
        <footer>
            <p>The Sound Of Colour - Ruby Purches</p>
            <p style="margin-top: 10px; color: #444;">MIDI Visualizer Collection</p>
        </footer>
    </div>
    
    <!-- Visualizer 1: Original Lightweight -->
    <div id="visualizer1" class="visualizer-container">
        <div class="visualizer-header">
            <h2>Original Lightweight</h2>
            <button class="back-btn" onclick="closeVisualizer('visualizer1')">← Back</button>
        </div>
        <div class="visualizer-content">
            <iframe id="iframe1" class="visualizer-iframe"></iframe>
        </div>
    </div>
    
    <!-- Visualizer 2: Oscilloscope -->
    <div id="visualizer2" class="visualizer-container">
        <div class="visualizer-header">
            <h2>Oscilloscope</h2>
            <button class="back-btn" onclick="closeVisualizer('visualizer2')">← Back</button>
        </div>
        <div class="visualizer-content">
            <iframe id="iframe2" class="visualizer-iframe"></iframe>
        </div>
    </div>
    
    <!-- Visualizer 3: Grid -->
    <div id="visualizer3" class="visualizer-container">
        <div class="visualizer-header">
            <h2>MIDI Grid Visualizer</h2>
            <button class="back-btn" onclick="closeVisualizer('visualizer3')">← Back</button>
        </div>
        <div class="visualizer-content">
            <iframe id="iframe3" class="visualizer-iframe"></iframe>
        </div>
    </div>
    
    <!-- Visualizer 4: Recorder -->
    <div id="visualizer4" class="visualizer-container">
        <div class="visualizer-header">
            <h2>MIDI Visualizer Recorder</h2>
            <button class="back-btn" onclick="closeVisualizer('visualizer4')">← Back</button>
        </div>
        <div class="visualizer-content">
            <iframe id="iframe4" class="visualizer-iframe"></iframe>
        </div>
    </div>
    
    <script>
        // Store visualizer HTML content as base64 encoded strings
        const visualizers = {
            visualizer1: null,
            visualizer2: null,
            visualizer3: null,
            visualizer4: null
        };
        
        function loadVisualizer(id) {
            const container = document.getElementById(id);
            const iframe = document.getElementById('iframe' + id.slice(-1));
            
            // Show container
            container.classList.add('active');
            
            // Load content only once
            if (!visualizers[id]) {
                const content = getVisualizerContent(id);
                iframe.srcdoc = content;
                visualizers[id] = true;
            }
        }
        
        function closeVisualizer(id) {
            const container = document.getElementById(id);
            container.classList.remove('active');
        }
        
        function base64Decode(base64String) {
            const binaryString = atob(base64String);
            const bytes = new Uint8Array(binaryString.length);
            for (let i = 0; i < binaryString.length; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            const decoder = new TextDecoder('utf-8');
            return decoder.decode(bytes);
        }
        
        function getVisualizerContent(id) {
            // Return the appropriate visualizer HTML based on ID
            switch(id) {
                case 'visualizer1':
                    return base64Decode(VISUALIZER_1_B64);
                case 'visualizer2':
                    return base64Decode(VISUALIZER_2_B64);
                case 'visualizer3':
                    return base64Decode(VISUALIZER_3_B64);
                case 'visualizer4':
                    return base64Decode(VISUALIZER_4_B64);
                default:
                    return '';
            }
        }
        
        // Embedded visualizer HTML content as base64
        const VISUALIZER_1_B64 = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+TmV3dG9uIE1JREkgVmlzdWFsaXplciAtIExpZ2h0d2VpZ2h0PC90aXRsZT4KICAgIDxzdHlsZT4KICAgICAgICAqIHsgbWFyZ2luOiAwOyBwYWRkaW5nOiAwOyBib3gtc2l6aW5nOiBib3JkZXItYm94OyB9CiAgICAgICAgYm9keSB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMxYTFhMmU7CiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgIH0KICAgICAgICAjY29udGFpbmVyIHsKICAgICAgICAgICAgd2lkdGg6IDEwMHZ3OwogICAgICAgICAgICBoZWlnaHQ6IDEwMHZoOwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgIH0KICAgICAgICAjaGVhZGVyIHsKICAgICAgICAgICAgcGFkZGluZzogMTBweCAxNXB4OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuNCk7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgZmxleC13cmFwOiB3cmFwOwogICAgICAgICAgICBnYXA6IDEwcHg7CiAgICAgICAgfQogICAgICAgICN0aXRsZSB7IGZvbnQtc2l6ZTogMjBweDsgZm9udC13ZWlnaHQ6IGJvbGQ7IH0KICAgICAgICAjY29udHJvbHMgewogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBnYXA6IDhweDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICB9CiAgICAgICAgLmJ0biB7CiAgICAgICAgICAgIHBhZGRpbmc6IDZweCAxMnB4OwogICAgICAgICAgICBib3JkZXI6IG5vbmU7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgICAgICBmb250LXNpemU6IDEycHg7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgICAgIH0KICAgICAgICAuYnRuOmhvdmVyIHsgb3BhY2l0eTogMC44OyB9CiAgICAgICAgI3N0YXR1cyB7IGJhY2tncm91bmQ6ICNkYzI2MjY7IGNvbG9yOiB3aGl0ZTsgfQogICAgICAgICNzdGF0dXMuY29ubmVjdGVkIHsgYmFja2dyb3VuZDogIzE2YTM0YTsgfQogICAgICAgICNtb2RlQnRuIHsgYmFja2dyb3VuZDogIzBlYTVlOTsgY29sb3I6IHdoaXRlOyB9CiAgICAgICAgI2d1aWRlQnRuIHsgYmFja2dyb3VuZDogIzkzMzNlYTsgY29sb3I6IHdoaXRlOyB9CiAgICAgICAgI3Zpc3VhbENhbnZhcyB7CiAgICAgICAgICAgIGZsZXg6IDE7CiAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOwogICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICB9CiAgICAgICAgI3BpYW5vQ29udGFpbmVyIHsKICAgICAgICAgICAgaGVpZ2h0OiAxODBweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjQpOwogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgcGFkZGluZzogNXB4OwogICAgICAgIH0KICAgICAgICAjY29sb3JNYXBDYW52YXMsICNwaWFub0NhbnZhcyB7CiAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOwogICAgICAgIH0KICAgICAgICAjaW5mbyB7CiAgICAgICAgICAgIHBhZGRpbmc6IDhweDsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgICAgICBmb250LXNpemU6IDExcHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC40KTsKICAgICAgICB9CiAgICAgICAgI2d1aWRlIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICB0b3A6IDUwJTsKICAgICAgICAgICAgbGVmdDogNTAlOwogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyMCwgMjAsIDQwLCAwLjk4KTsKICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgIzkzMzNlYTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgICAgICBwYWRkaW5nOiAyMHB4OwogICAgICAgICAgICBtYXgtd2lkdGg6IDYwMHB4OwogICAgICAgICAgICBtYXgtaGVpZ2h0OiA4MHZoOwogICAgICAgICAgICBvdmVyZmxvdy15OiBhdXRvOwogICAgICAgICAgICB6LWluZGV4OiAxMDAwOwogICAgICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgIH0KICAgICAgICAjZ3VpZGUuc2hvdyB7IGRpc3BsYXk6IGJsb2NrOyB9CiAgICAgICAgI2d1aWRlIGgzIHsgbWFyZ2luLWJvdHRvbTogMTVweDsgY29sb3I6ICM5MzMzZWE7IH0KICAgICAgICAjZ3VpZGUgcCB7IG1hcmdpbi1ib3R0b206IDEwcHg7IGZvbnQtc2l6ZTogMTNweDsgbGluZS1oZWlnaHQ6IDEuNTsgfQogICAgICAgICNndWlkZSAuY2xvc2UgewogICAgICAgICAgICBmbG9hdDogcmlnaHQ7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNkYzI2MjY7CiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsKICAgICAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICAgICAgICAgIHBhZGRpbmc6IDRweCAxMHB4OwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgfQogICAgICAgICNzZXR0aW5ncyB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICAgICAgdG9wOiA2MHB4OwogICAgICAgICAgICByaWdodDogMjBweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyMCwgMjAsIDQwLCAwLjk1KTsKICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgIzBlYTVlOTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgICAgICBwYWRkaW5nOiAxNXB4OwogICAgICAgICAgICB3aWR0aDogMjgwcHg7CiAgICAgICAgICAgIHotaW5kZXg6IDEwMDA7CiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICAgICAgICAgIG1heC1oZWlnaHQ6IDgwdmg7CiAgICAgICAgICAgIG92ZXJmbG93LXk6IGF1dG87CiAgICAgICAgfQogICAgICAgICNzZXR0aW5ncy5zaG93IHsgZGlzcGxheTogYmxvY2s7IH0KICAgICAgICAjc2V0dGluZ3MgaDMgeyAKICAgICAgICAgICAgbWFyZ2luOiAwIDAgMTVweCAwOyAKICAgICAgICAgICAgY29sb3I6ICMwZWE1ZTk7IAogICAgICAgICAgICBmb250LXNpemU6IDE2cHg7CiAgICAgICAgfQogICAgICAgIC5zZXR0aW5nLWdyb3VwIHsKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsKICAgICAgICAgICAgcGFkZGluZy1ib3R0b206IDE1cHg7CiAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMSk7CiAgICAgICAgfQogICAgICAgIC5zZXR0aW5nLWdyb3VwOmxhc3QtY2hpbGQgewogICAgICAgICAgICBib3JkZXItYm90dG9tOiBub25lOwogICAgICAgIH0KICAgICAgICAuc2V0dGluZy1sYWJlbCB7CiAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOwogICAgICAgICAgICBmb250LXNpemU6IDEycHg7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDVweDsKICAgICAgICAgICAgY29sb3I6ICNhYWE7CiAgICAgICAgfQogICAgICAgIC5zZXR0aW5nLWlucHV0IHsKICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgIHBhZGRpbmc6IDVweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwwLjEpOwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMik7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgICAgICBmb250LXNpemU6IDEycHg7CiAgICAgICAgfQogICAgICAgIGlucHV0W3R5cGU9InJhbmdlIl0gewogICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgbWFyZ2luOiA1cHggMDsKICAgICAgICB9CiAgICAgICAgLnNldHRpbmctdmFsdWUgewogICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICAgICAgICAgIGZsb2F0OiByaWdodDsKICAgICAgICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICAgICAgICBjb2xvcjogIzBlYTVlOTsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgICAgfQogICAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KICAgIDxkaXYgaWQ9ImNvbnRhaW5lciI+CiAgICAgICAgPGRpdiBpZD0iaGVhZGVyIj4KICAgICAgICAgICAgPGRpdiBpZD0idGl0bGUiPk5ld3RvbiBNSURJIFZpc3VhbGl6ZXIgLSBMaWdodHdlaWdodDwvZGl2PgogICAgICAgICAgICA8ZGl2IGlkPSJjb250cm9scyI+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJzdGF0dXMiIGNsYXNzPSJidG4iPuKXjyBEaXNjb25uZWN0ZWQ8L2Rpdj4KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9Im1vZGVCdG4iIGNsYXNzPSJidG4iPvCfjprvuI8gTGFuZXM8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9Imd1aWRlQnRuIiBjbGFzcz0iYnRuIj7wn5OWIEd1aWRlPC9idXR0b24+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJzZXR0aW5nc0J0biIgY2xhc3M9ImJ0biIgc3R5bGU9ImJhY2tncm91bmQ6ICMwZWE1ZTk7IGNvbG9yOiB3aGl0ZTsiPuKame+4jyBTZXR0aW5nczwvYnV0dG9uPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8Y2FudmFzIGlkPSJ2aXN1YWxDYW52YXMiPjwvY2FudmFzPgogICAgICAgIDxkaXYgaWQ9InBpYW5vQ29udGFpbmVyIj4KICAgICAgICAgICAgPGNhbnZhcyBpZD0iY29sb3JNYXBDYW52YXMiPjwvY2FudmFzPgogICAgICAgICAgICA8Y2FudmFzIGlkPSJwaWFub0NhbnZhcyI+PC9jYW52YXM+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBpZD0iaW5mbyI+CiAgICAgICAgICAgIDxzcGFuIGlkPSJ0cmFja0NvdW50Ij5ObyB0cmFja3MgY29ubmVjdGVkPC9zcGFuPiDigKIgCiAgICAgICAgICAgIFZlbG9jaXR5IGFmZmVjdHMgc2l6ZSAmIHNhdHVyYXRpb24g4oCiIAogICAgICAgICAgICBOZXd0b24ncyBjb2xvciB3aGVlbCBDMC1DMTAKICAgICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgaWQ9Imd1aWRlIj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJjbG9zZSIgb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2d1aWRlJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpIj7inJUgQ2xvc2U8L2J1dHRvbj4KICAgICAgICA8aDM+SG93IEl0IFdvcmtzPC9oMz4KICAgICAgICA8cD48c3Ryb25nPk9jdGF2ZSDihpIgQnJpZ2h0bmVzczo8L3N0cm9uZz4gTG93ZXIgb2N0YXZlcyAoQzApIGFyZSBkYXJrLCBoaWdoZXIgb2N0YXZlcyAoQzEwKSBhcmUgYnJpZ2h0LjwvcD4KICAgICAgICA8cD48c3Ryb25nPlZlbG9jaXR5IOKGkiBTaXplICYgU2F0dXJhdGlvbjo8L3N0cm9uZz4gU29mdCBwbGF5aW5nID0gc21hbGwsIHBhc3RlbCBjaXJjbGVzLiBIYXJkIHBsYXlpbmcgPSBsYXJnZSwgdml2aWQgY2lyY2xlcy48L3A+CiAgICAgICAgPHA+PHN0cm9uZz5Ob3RlIOKGkiBDb2xvcjo8L3N0cm9uZz4gRWFjaCBub3RlIGhhcyBpdHMgb3duIE5ld3RvbiBjb2xvciAoRD1SZWQsIEU9T3JhbmdlLCBGPVllbGxvdywgRz1HcmVlbiwgQT1CbHVlLCBCPUluZGlnbywgQz1WaW9sZXQpLjwvcD4KICAgICAgICA8cD48c3Ryb25nPkxhbmVzIE1vZGU6PC9zdHJvbmc+IEVhY2ggTUlESSB0cmFjayBpbiBpdHMgb3duIGhvcml6b250YWwgbGFuZS48L3A+CiAgICAgICAgPHA+PHN0cm9uZz5MYXllcnMgTW9kZTo8L3N0cm9uZz4gQWxsIHRyYWNrcyBjb21iaW5lZCB3aXRoIGRlcHRoIGJsdXIgZWZmZWN0LjwvcD4KICAgICAgICA8aHIgc3R5bGU9Im1hcmdpbjogMTVweCAwOyBib3JkZXItY29sb3I6ICM0NDQ7Ij4KICAgICAgICA8cD48c3Ryb25nPkxvZ2ljIFBybyBTZXR1cDo8L3N0cm9uZz48L3A+CiAgICAgICAgPHA+MS4gT3BlbiBBdWRpbyBNSURJIFNldHVwIOKGkiBDcmVhdGUgbXVsdGlwbGUgSUFDIGJ1c2VzPC9wPgogICAgICAgIDxwPjIuIEluIExvZ2ljLCByb3V0ZSBlYWNoIHRyYWNrIHRvIGRpZmZlcmVudCBJQUMgYnVzZXM8L3A+CiAgICAgICAgPHA+My4gUHJlc3MgUGxheSBvciBSZWNvcmQtZW5hYmxlIHRyYWNrcyB0byBzZW5kIE1JREk8L3A+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGlkPSJzZXR0aW5ncyI+CiAgICAgICAgPGgzPuKame+4jyBWaXN1YWxpemVyIFNldHRpbmdzPC9oMz4KICAgICAgICAKICAgICAgICA8ZGl2IGNsYXNzPSJzZXR0aW5nLWdyb3VwIj4KICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJzZXR0aW5nLWxhYmVsIj4KICAgICAgICAgICAgICAgIFBhcnRpY2xlIFNpemUKICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzZXR0aW5nLXZhbHVlIiBpZD0ic2l6ZVZhbHVlIj4zNTwvc3Bhbj4KICAgICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBpZD0icGFydGljbGVTaXplIiBtaW49IjIwIiBtYXg9IjgwIiB2YWx1ZT0iMzUiIGNsYXNzPSJzZXR0aW5nLWlucHV0Ij4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBjbGFzcz0ic2V0dGluZy1ncm91cCI+CiAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic2V0dGluZy1sYWJlbCI+CiAgICAgICAgICAgICAgICBQYXJ0aWNsZSBMaWZldGltZSAobXMpCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2V0dGluZy12YWx1ZSIgaWQ9ImxpZmV0aW1lVmFsdWUiPjE1MDA8L3NwYW4+CiAgICAgICAgICAgIDwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgaWQ9InBhcnRpY2xlTGlmZXRpbWUiIG1pbj0iNTAwIiBtYXg9IjMwMDAiIHN0ZXA9IjEwMCIgdmFsdWU9IjE1MDAiIGNsYXNzPSJzZXR0aW5nLWlucHV0Ij4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBjbGFzcz0ic2V0dGluZy1ncm91cCI+CiAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic2V0dGluZy1sYWJlbCI+CiAgICAgICAgICAgICAgICBNYXggUGFydGljbGVzIHBlciBUcmFjawogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNldHRpbmctdmFsdWUiIGlkPSJtYXhQYXJ0aWNsZXNWYWx1ZSI+MjA8L3NwYW4+CiAgICAgICAgICAgIDwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgaWQ9Im1heFBhcnRpY2xlcyIgbWluPSIxMCIgbWF4PSI1MCIgdmFsdWU9IjIwIiBjbGFzcz0ic2V0dGluZy1pbnB1dCI+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9InNldHRpbmctZ3JvdXAiPgogICAgICAgICAgICA8bGFiZWwgY2xhc3M9InNldHRpbmctbGFiZWwiPgogICAgICAgICAgICAgICAgQ2hvcmQgRGV0ZWN0aW9uIFdpbmRvdyAobXMpCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2V0dGluZy12YWx1ZSIgaWQ9ImNob3JkV2luZG93VmFsdWUiPjIwMDwvc3Bhbj4KICAgICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBpZD0iY2hvcmRXaW5kb3ciIG1pbj0iNTAiIG1heD0iNTAwIiBzdGVwPSI1MCIgdmFsdWU9IjIwMCIgY2xhc3M9InNldHRpbmctaW5wdXQiPgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJzZXR0aW5nLWdyb3VwIj4KICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJzZXR0aW5nLWxhYmVsIj4KICAgICAgICAgICAgICAgIENob3JkIFNoYXBlIFBhZGRpbmcKICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzZXR0aW5nLXZhbHVlIiBpZD0iY2hvcmRQYWRkaW5nVmFsdWUiPjE1PC9zcGFuPgogICAgICAgICAgICA8L2xhYmVsPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGlkPSJjaG9yZFBhZGRpbmciIG1pbj0iNSIgbWF4PSIzMCIgdmFsdWU9IjE1IiBjbGFzcz0ic2V0dGluZy1pbnB1dCI+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9InNldHRpbmctZ3JvdXAiPgogICAgICAgICAgICA8bGFiZWwgY2xhc3M9InNldHRpbmctbGFiZWwiPgogICAgICAgICAgICAgICAgQ2hvcmQgRmlsbCBPcGFjaXR5CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2V0dGluZy12YWx1ZSIgaWQ9ImNob3JkT3BhY2l0eVZhbHVlIj44MCU8L3NwYW4+CiAgICAgICAgICAgIDwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgaWQ9ImNob3JkT3BhY2l0eSIgbWluPSIwIiBtYXg9IjEwMCIgdmFsdWU9IjgwIiBjbGFzcz0ic2V0dGluZy1pbnB1dCI+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9InNldHRpbmctZ3JvdXAiPgogICAgICAgICAgICA8bGFiZWwgY2xhc3M9InNldHRpbmctbGFiZWwiPkJhY2tncm91bmQgVHlwZTwvbGFiZWw+CiAgICAgICAgICAgIDxzZWxlY3QgaWQ9ImJnVHlwZSIgY2xhc3M9InNldHRpbmctaW5wdXQiPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iZ3JhZGllbnQiPkdyYWRpZW50PC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJzb2xpZCI+U29saWQgQ29sb3I8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImFkZGl0aXZlIj5BZGRpdGl2ZS9TdW0gKExpdmUgUmVhY3RpdmUpPC9vcHRpb24+CiAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJzZXR0aW5nLWdyb3VwIj4KICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJzZXR0aW5nLWxhYmVsIj4KICAgICAgICAgICAgICAgIEJhY2tncm91bmQgT3BhY2l0eQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNldHRpbmctdmFsdWUiIGlkPSJiZ09wYWNpdHlWYWx1ZSI+MTAwJTwvc3Bhbj4KICAgICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBpZD0iYmdPcGFjaXR5IiBtaW49IjAiIG1heD0iMTAwIiB2YWx1ZT0iMTAwIiBjbGFzcz0ic2V0dGluZy1pbnB1dCI+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMTBweDsgY29sb3I6ICM2NjY7IG1hcmdpbi10b3A6IDVweDsiPgogICAgICAgICAgICAgICAgTWFzdGVyIG9wYWNpdHkgZm9yIGFsbCBiYWNrZ3JvdW5kIHR5cGVzCiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJzZXR0aW5nLWdyb3VwIiBpZD0iZ3JhZGllbnRTZXR0aW5ncyI+CiAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic2V0dGluZy1sYWJlbCI+R3JhZGllbnQgVHlwZTwvbGFiZWw+CiAgICAgICAgICAgIDxzZWxlY3QgaWQ9ImdyYWRpZW50VHlwZSIgY2xhc3M9InNldHRpbmctaW5wdXQiPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iY3VzdG9tIj5DdXN0b20gQ29sb3JzPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJtaXhlciI+Q29sb3IgTWl4ZXIgKFczU2Nob29scyk8L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CgogICAgICAgICAgICA8ZGl2IGlkPSJjdXN0b21HcmFkaWVudFNldHRpbmdzIj4KICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic2V0dGluZy1sYWJlbCIgc3R5bGU9Im1hcmdpbi10b3A6IDEwcHg7Ij5HcmFkaWVudCBEaXJlY3Rpb248L2xhYmVsPgogICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0iYmdHcmFkaWVudCIgY2xhc3M9InNldHRpbmctaW5wdXQiPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImxyIj5MZWZ04oaSUmlnaHQ8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJybCI+UmlnaHTihpJMZWZ0PC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0idGIiPlRvcOKGkkJvdHRvbTwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImJ0Ij5Cb3R0b23ihpJUb3A8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJkaWFnMSI+RGlhZ29uYWwg4oaYPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJzZXR0aW5nLWxhYmVsIiBzdHlsZT0ibWFyZ2luLXRvcDogMTBweDsiPlN0YXJ0IENvbG9yPC9sYWJlbD4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJjb2xvciIgaWQ9ImdyYWRpZW50Q29sb3IxIiB2YWx1ZT0iI2ZmZmZmZiIgY2xhc3M9InNldHRpbmctaW5wdXQiIHN0eWxlPSJoZWlnaHQ6IDQwcHg7Ij4KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJzZXR0aW5nLWxhYmVsIiBzdHlsZT0ibWFyZ2luLXRvcDogMTBweDsiPkVuZCBDb2xvcjwvbGFiZWw+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0iY29sb3IiIGlkPSJncmFkaWVudENvbG9yMiIgdmFsdWU9IiMwMDAwMDAiIGNsYXNzPSJzZXR0aW5nLWlucHV0IiBzdHlsZT0iaGVpZ2h0OiA0MHB4OyI+CiAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgPGRpdiBpZD0ibWl4ZXJHcmFkaWVudFNldHRpbmdzIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPgogICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJzZXR0aW5nLWxhYmVsIiBzdHlsZT0ibWFyZ2luLXRvcDogMTBweDsiPkRpcmVjdGlvbjwvbGFiZWw+CiAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSJtaXhlckRpcmVjdGlvbiIgY2xhc3M9InNldHRpbmctaW5wdXQiPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImxyIj5MZWZ04oaSUmlnaHQ8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJybCI+UmlnaHTihpJMZWZ0PC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0idGIiPlRvcOKGkkJvdHRvbTwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImJ0Ij5Cb3R0b23ihpJUb3A8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJkaWFnMSI+RGlhZ29uYWwg4oaYPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8L3NlbGVjdD4KCiAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9InNldHRpbmctbGFiZWwiIHN0eWxlPSJtYXJnaW4tdG9wOiAxMHB4OyI+Q29sb3IgMTwvbGFiZWw+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0iY29sb3IiIGlkPSJtaXhlckNvbG9yMSIgdmFsdWU9IiNmZjAwMDAiIGNsYXNzPSJzZXR0aW5nLWlucHV0IiBzdHlsZT0iaGVpZ2h0OiA0MHB4OyI+CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic2V0dGluZy1sYWJlbCIgc3R5bGU9Im1hcmdpbi10b3A6IDEwcHg7Ij5Db2xvciAyPC9sYWJlbD4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJjb2xvciIgaWQ9Im1peGVyQ29sb3IyIiB2YWx1ZT0iIzAwMDBmZiIgY2xhc3M9InNldHRpbmctaW5wdXQiIHN0eWxlPSJoZWlnaHQ6IDQwcHg7Ij4KCiAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9InNldHRpbmctbGFiZWwiIHN0eWxlPSJtYXJnaW4tdG9wOiAxMHB4OyI+CiAgICAgICAgICAgICAgICAgICAgTWl4IFJhdGlvIChDb2xvciAxIDogQ29sb3IgMikKICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2V0dGluZy12YWx1ZSIgaWQ9Im1peFJhdGlvVmFsdWUiPjUwOjUwPC9zcGFuPgogICAgICAgICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgaWQ9Im1peFJhdGlvIiBtaW49IjAiIG1heD0iMTAwIiB2YWx1ZT0iNTAiIGNsYXNzPSJzZXR0aW5nLWlucHV0Ij4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMTBweDsgY29sb3I6ICM2NjY7IG1hcmdpbi10b3A6IDVweDsiPgogICAgICAgICAgICAgICAgICAgIENyZWF0ZXMgc21vb3RoIGdyYWRpZW50IHRocm91Z2ggbWl4ZWQgY29sb3IKICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBjbGFzcz0ic2V0dGluZy1ncm91cCIgaWQ9InNvbGlkU2V0dGluZ3MiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+CiAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic2V0dGluZy1sYWJlbCI+QmFja2dyb3VuZCBDb2xvcjwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJjb2xvciIgaWQ9InNvbGlkQ29sb3IiIHZhbHVlPSIjMTYyMTNlIiBjbGFzcz0ic2V0dGluZy1pbnB1dCIgc3R5bGU9ImhlaWdodDogNDBweDsiPgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJzZXR0aW5nLWdyb3VwIiBpZD0iYWRkaXRpdmVTZXR0aW5ncyIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4KICAgICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC1zaXplOiAxMXB4OyBjb2xvcjogI2FhYTsgbGluZS1oZWlnaHQ6IDEuNDsgbWFyZ2luLWJvdHRvbTogMTBweDsiPgogICAgICAgICAgICAgICAgQmFja2dyb3VuZCBjb2xvciBjaGFuZ2VzIGJhc2VkIG9uIGFsbCBhY3RpdmUgbm90ZXMgdXNpbmcgYWRkaXRpdmUgUkdCIGNvbG9yIG1peGluZy4gTXVsdGlwbGUgbm90ZXMgYmxlbmQgdG9nZXRoZXIgbGlrZSBsaWdodC4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic2V0dGluZy1sYWJlbCI+CiAgICAgICAgICAgICAgICBCYXNlIERhcmtuZXNzCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2V0dGluZy12YWx1ZSIgaWQ9ImJhc2VDb2xvclZhbHVlIj4xMCU8L3NwYW4+CiAgICAgICAgICAgIDwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgaWQ9ImJhc2VDb2xvckludGVuc2l0eSIgbWluPSIwIiBtYXg9IjUwIiB2YWx1ZT0iMTAiIGNsYXNzPSJzZXR0aW5nLWlucHV0Ij4KICAgICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC1zaXplOiAxMHB4OyBjb2xvcjogIzY2NjsgbWFyZ2luLXRvcDogNXB4OyI+CiAgICAgICAgICAgICAgICBIb3cgbXVjaCBibGFjayB0byBtaXggd2l0aCB0aGUgc3VtIGNvbG9yCiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAKICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJzZXR0aW5nLWxhYmVsIiBzdHlsZT0ibWFyZ2luLXRvcDogMTBweDsiPgogICAgICAgICAgICAgICAgQXR0YWNrIFNwZWVkCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2V0dGluZy12YWx1ZSIgaWQ9ImF0dGFja1NwZWVkVmFsdWUiPkZhc3Q8L3NwYW4+CiAgICAgICAgICAgIDwvbGFiZWw+CiAgICAgICAgICAgIDxzZWxlY3QgaWQ9ImF0dGFja1NwZWVkIiBjbGFzcz0ic2V0dGluZy1pbnB1dCI+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJpbnN0YW50Ij5JbnN0YW50PC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJmYXN0IiBzZWxlY3RlZD5GYXN0PC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJtZWRpdW0iPk1lZGl1bTwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ic2xvdyI+U2xvdzwvb3B0aW9uPgogICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC1zaXplOiAxMHB4OyBjb2xvcjogIzY2NjsgbWFyZ2luLXRvcDogNXB4OyI+CiAgICAgICAgICAgICAgICBIb3cgcXVpY2tseSBuZXcgY29sb3JzIGFwcGVhcgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic2V0dGluZy1sYWJlbCIgc3R5bGU9Im1hcmdpbi10b3A6IDEwcHg7Ij4KICAgICAgICAgICAgICAgIFJlbGVhc2UgVGltZSAobXMpCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2V0dGluZy12YWx1ZSIgaWQ9InJlbGVhc2VUaW1lVmFsdWUiPjgwMDwvc3Bhbj4KICAgICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBpZD0icmVsZWFzZVRpbWUiIG1pbj0iMTAwIiBtYXg9IjMwMDAiIHN0ZXA9IjEwMCIgdmFsdWU9IjgwMCIgY2xhc3M9InNldHRpbmctaW5wdXQiPgogICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDEwcHg7IGNvbG9yOiAjNjY2OyBtYXJnaW4tdG9wOiA1cHg7Ij4KICAgICAgICAgICAgICAgIEhvdyBsb25nIGNvbG9ycyBsaW5nZXIgYWZ0ZXIgbm90ZXMgc3RvcAogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBjbGFzcz0ic2V0dGluZy1ncm91cCI+CiAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic2V0dGluZy1sYWJlbCI+TmV3dG9uIENvbG9yIFJlZmVyZW5jZTwvbGFiZWw+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMTBweDsgY29sb3I6ICM4ODg7IG1hcmdpbi1ib3R0b206IDhweDsiPlJPWUdCSVYgU2NhbGUgKGJ5IE5vdGUpPC9kaXY+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6IGdyaWQ7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KDEyLCAxZnIpOyBnYXA6IDJweDsgbWFyZ2luLWJvdHRvbTogNXB4OyI+CiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOiByZ2IoMTQ4LDAsMjExKTsgaGVpZ2h0OiAyMHB4OyBib3JkZXItcmFkaXVzOiAycHg7IiB0aXRsZT0iQy1WaW9sZXQiPjwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iYmFja2dyb3VuZDogcmdiKDIwNCwwLDEwMik7IGhlaWdodDogMjBweDsgYm9yZGVyLXJhZGl1czogMnB4OyIgdGl0bGU9IkMjIj48L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImJhY2tncm91bmQ6IHJnYigyNTUsMCwwKTsgaGVpZ2h0OiAyMHB4OyBib3JkZXItcmFkaXVzOiAycHg7IiB0aXRsZT0iRC1SZWQiPjwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iYmFja2dyb3VuZDogcmdiKDI1NSw2OSwwKTsgaGVpZ2h0OiAyMHB4OyBib3JkZXItcmFkaXVzOiAycHg7IiB0aXRsZT0iRCMiPjwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iYmFja2dyb3VuZDogcmdiKDI1NSwxNDAsMCk7IGhlaWdodDogMjBweDsgYm9yZGVyLXJhZGl1czogMnB4OyIgdGl0bGU9IkUtT3JhbmdlIj48L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImJhY2tncm91bmQ6IHJnYigyNTUsMjU1LDApOyBoZWlnaHQ6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDJweDsiIHRpdGxlPSJGLVllbGxvdyI+PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOiByZ2IoMTI3LDI1NSwwKTsgaGVpZ2h0OiAyMHB4OyBib3JkZXItcmFkaXVzOiAycHg7IiB0aXRsZT0iRiMiPjwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iYmFja2dyb3VuZDogcmdiKDAsMjU1LDApOyBoZWlnaHQ6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDJweDsiIHRpdGxlPSJHLUdyZWVuIj48L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImJhY2tncm91bmQ6IHJnYigwLDEyOCwyNTUpOyBoZWlnaHQ6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDJweDsiIHRpdGxlPSJHIyI+PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOiByZ2IoMCwwLDI1NSk7IGhlaWdodDogMjBweDsgYm9yZGVyLXJhZGl1czogMnB4OyIgdGl0bGU9IkEtQmx1ZSI+PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOiByZ2IoNzUsMCwxMzApOyBoZWlnaHQ6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDJweDsiIHRpdGxlPSJBIy1JbmRpZ28iPjwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iYmFja2dyb3VuZDogcmdiKDEzOSwwLDI1NSk7IGhlaWdodDogMjBweDsgYm9yZGVyLXJhZGl1czogMnB4OyIgdGl0bGU9IkItVmlvbGV0Ij48L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogOXB4OyBjb2xvcjogIzY2NjsgZGlzcGxheTogZ3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoMTIsIDFmcik7IHRleHQtYWxpZ246IGNlbnRlcjsiPgogICAgICAgICAgICAgICAgPHNwYW4+Qzwvc3Bhbj48c3Bhbj5DIzwvc3Bhbj48c3Bhbj5EPC9zcGFuPjxzcGFuPkQjPC9zcGFuPjxzcGFuPkU8L3NwYW4+PHNwYW4+Rjwvc3Bhbj48c3Bhbj5GIzwvc3Bhbj48c3Bhbj5HPC9zcGFuPjxzcGFuPkcjPC9zcGFuPjxzcGFuPkE8L3NwYW4+PHNwYW4+QSM8L3NwYW4+PHNwYW4+Qjwvc3Bhbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9InNldHRpbmctZ3JvdXAiPgogICAgICAgICAgICA8bGFiZWwgY2xhc3M9InNldHRpbmctbGFiZWwiPkJyaWdodG5lc3MgYnkgT2N0YXZlPC9sYWJlbD4KICAgICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC1zaXplOiAxMHB4OyBjb2xvcjogIzg4ODsgbWFyZ2luLWJvdHRvbTogOHB4OyI+VmFsdWUgU2NhbGUgKEMw4oaSQzEwKTwvZGl2PgogICAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBnYXA6IDJweDsgbWFyZ2luLWJvdHRvbTogNXB4OyI+CiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOiByZ2IoMjIsMCwzMik7IGZsZXg6IDE7IGhlaWdodDogMjBweDsgYm9yZGVyLXJhZGl1czogMnB4OyIgdGl0bGU9IkMwIChWaW9sZXQpIj48L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImJhY2tncm91bmQ6IHJnYigzNywwLDUzKTsgZmxleDogMTsgaGVpZ2h0OiAyMHB4OyBib3JkZXItcmFkaXVzOiAycHg7IiB0aXRsZT0iQzEiPjwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iYmFja2dyb3VuZDogcmdiKDUyLDAsNzQpOyBmbGV4OiAxOyBoZWlnaHQ6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDJweDsiIHRpdGxlPSJDMiI+PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOiByZ2IoNjcsMCw5NSk7IGZsZXg6IDE7IGhlaWdodDogMjBweDsgYm9yZGVyLXJhZGl1czogMnB4OyIgdGl0bGU9IkMzIj48L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImJhY2tncm91bmQ6IHJnYig4MiwwLDExNik7IGZsZXg6IDE7IGhlaWdodDogMjBweDsgYm9yZGVyLXJhZGl1czogMnB4OyIgdGl0bGU9IkM0Ij48L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImJhY2tncm91bmQ6IHJnYig5NiwwLDEzNyk7IGZsZXg6IDE7IGhlaWdodDogMjBweDsgYm9yZGVyLXJhZGl1czogMnB4OyIgdGl0bGU9IkM1Ij48L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImJhY2tncm91bmQ6IHJnYigxMTEsMCwxNTgpOyBmbGV4OiAxOyBoZWlnaHQ6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDJweDsiIHRpdGxlPSJDNiI+PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOiByZ2IoMTI2LDAsMTc5KTsgZmxleDogMTsgaGVpZ2h0OiAyMHB4OyBib3JkZXItcmFkaXVzOiAycHg7IiB0aXRsZT0iQzciPjwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iYmFja2dyb3VuZDogcmdiKDEzMywwLDE5MCk7IGZsZXg6IDE7IGhlaWdodDogMjBweDsgYm9yZGVyLXJhZGl1czogMnB4OyIgdGl0bGU9IkM4Ij48L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImJhY2tncm91bmQ6IHJnYigxNDEsMCwyMDApOyBmbGV4OiAxOyBoZWlnaHQ6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDJweDsiIHRpdGxlPSJDOSI+PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOiByZ2IoMTQ4LDAsMjExKTsgZmxleDogMTsgaGVpZ2h0OiAyMHB4OyBib3JkZXItcmFkaXVzOiAycHg7IiB0aXRsZT0iQzEwIj48L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogOXB4OyBjb2xvcjogIzY2NjsgZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyI+CiAgICAgICAgICAgICAgICA8c3Bhbj5DMDwvc3Bhbj48c3Bhbj5DMjwvc3Bhbj48c3Bhbj5DNDwvc3Bhbj48c3Bhbj5DNjwvc3Bhbj48c3Bhbj5DODwvc3Bhbj48c3Bhbj5DMTA8L3NwYW4+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDEwcHg7IGNvbG9yOiAjODg4OyBtYXJnaW4tdG9wOiA1cHg7IHRleHQtYWxpZ246IGNlbnRlcjsiPkRhcmvihpJCcmlnaHQgKEMgbm90ZSBzaG93biBhcyBleGFtcGxlKTwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5ncycpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKSIgc3R5bGU9IndpZHRoOiAxMDAlOyBwYWRkaW5nOiA4cHg7IGJhY2tncm91bmQ6ICMwZWE1ZTk7IGNvbG9yOiB3aGl0ZTsgYm9yZGVyOiBub25lOyBib3JkZXItcmFkaXVzOiA0cHg7IGN1cnNvcjogcG9pbnRlcjsgbWFyZ2luLXRvcDogMTBweDsiPgogICAgICAgICAgICDinJMgQXBwbHkgJiBDbG9zZQogICAgICAgIDwvYnV0dG9uPgogICAgPC9kaXY+CgogICAgPHNjcmlwdD4KICAgICAgICAvLyBOZXd0b24ncyBjb2xvciB3aGVlbAogICAgICAgIGNvbnN0IE5FV1RPTiA9IFsKICAgICAgICAgICAgWzE0OCwgMCwgMjExXSwgWzIwNCwgMCwgMTAyXSwgWzI1NSwgMCwgMF0sIFsyNTUsIDY5LCAwXSwKICAgICAgICAgICAgWzI1NSwgMTQwLCAwXSwgWzI1NSwgMjU1LCAwXSwgWzEyNywgMjU1LCAwXSwgWzAsIDI1NSwgMF0sCiAgICAgICAgICAgIFswLCAxMjgsIDI1NV0sIFswLCAwLCAyNTVdLCBbNzUsIDAsIDEzMF0sIFsxMzksIDAsIDI1NV0KICAgICAgICBdOwoKICAgICAgICAvLyBTdGF0ZQogICAgICAgIGxldCBtb2RlID0gJ2xhbmVzJzsKICAgICAgICBsZXQgZGV2aWNlcyA9IFtdOwogICAgICAgIGxldCBhY3RpdmVOb3RlcyA9IHt9OwogICAgICAgIGxldCBwYXJ0aWNsZXMgPSB7fTsKICAgICAgICBsZXQgbGFzdEZyYW1lID0gMDsKICAgICAgICAKICAgICAgICAvLyBDdXN0b21pemFibGUgc2V0dGluZ3MKICAgICAgICBsZXQgc2V0dGluZ3MgPSB7CiAgICAgICAgICAgIHBhcnRpY2xlU2l6ZTogMzUsCiAgICAgICAgICAgIHBhcnRpY2xlTGlmZXRpbWU6IDE1MDAsCiAgICAgICAgICAgIG1heFBhcnRpY2xlczogMjAsCiAgICAgICAgICAgIGNob3JkV2luZG93OiAyMDAsCiAgICAgICAgICAgIGNob3JkUGFkZGluZzogMTUsCiAgICAgICAgICAgIGNob3JkT3BhY2l0eTogMC44LAogICAgICAgICAgICBiZ1R5cGU6ICdncmFkaWVudCcsCiAgICAgICAgICAgIGJnT3BhY2l0eTogMS4wLAogICAgICAgICAgICBncmFkaWVudFR5cGU6ICdjdXN0b20nLAogICAgICAgICAgICBiZ0dyYWRpZW50OiAnbHInLAogICAgICAgICAgICBncmFkaWVudENvbG9yMTogJyNmZmZmZmYnLAogICAgICAgICAgICBncmFkaWVudENvbG9yMjogJyMwMDAwMDAnLAogICAgICAgICAgICBtaXhlckRpcmVjdGlvbjogJ2xyJywKICAgICAgICAgICAgbWl4ZXJDb2xvcjE6ICcjZmYwMDAwJywKICAgICAgICAgICAgbWl4ZXJDb2xvcjI6ICcjMDAwMGZmJywKICAgICAgICAgICAgbWl4UmF0aW86IDAuNSwKICAgICAgICAgICAgc29saWRDb2xvcjogJyMxNjIxM2UnLAogICAgICAgICAgICBiYXNlQ29sb3JJbnRlbnNpdHk6IDAuMSwKICAgICAgICAgICAgYXR0YWNrU3BlZWQ6ICdmYXN0JywKICAgICAgICAgICAgcmVsZWFzZVRpbWU6IDgwMAogICAgICAgIH07CgogICAgICAgIGxldCBjdXJyZW50QmdDb2xvciA9IFsyMiwgMzMsIDYyXTsgLy8gQ3VycmVudCBkaXNwbGF5ZWQgY29sb3IKICAgICAgICBsZXQgdGFyZ2V0QmdDb2xvciA9IFsyMiwgMzMsIDYyXTsgLy8gVGFyZ2V0IGNvbG9yIGZyb20gYWN0aXZlIG5vdGVzCiAgICAgICAgbGV0IHJlbGVhc2luZ0NvbG9ycyA9IFtdOyAvLyBDb2xvcnMgdGhhdCBhcmUgZmFkaW5nIG91dCBhZnRlciBub3RlIHJlbGVhc2UKCiAgICAgICAgLy8gQ2FudmFzCiAgICAgICAgY29uc3QgdmMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlzdWFsQ2FudmFzJyk7CiAgICAgICAgY29uc3QgdmN0eCA9IHZjLmdldENvbnRleHQoJzJkJywgeyBhbHBoYTogdHJ1ZSB9KTsKICAgICAgICBjb25zdCBjbWMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29sb3JNYXBDYW52YXMnKTsKICAgICAgICBjb25zdCBjbWN0eCA9IGNtYy5nZXRDb250ZXh0KCcyZCcpOwogICAgICAgIGNvbnN0IHBjID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BpYW5vQ2FudmFzJyk7CiAgICAgICAgY29uc3QgcGN0eCA9IHBjLmdldENvbnRleHQoJzJkJyk7CgogICAgICAgIGZ1bmN0aW9uIHJlc2l6ZSgpIHsKICAgICAgICAgICAgdmMud2lkdGggPSB2Yy5vZmZzZXRXaWR0aDsKICAgICAgICAgICAgdmMuaGVpZ2h0ID0gdmMub2Zmc2V0SGVpZ2h0OwogICAgICAgICAgICBjbWMud2lkdGggPSAxMDAwOwogICAgICAgICAgICBjbWMuaGVpZ2h0ID0gNDU7CiAgICAgICAgICAgIHBjLndpZHRoID0gMTAwMDsKICAgICAgICAgICAgcGMuaGVpZ2h0ID0gMTIwOwogICAgICAgICAgICB1cGRhdGVCYWNrZ3JvdW5kKCk7CiAgICAgICAgfQogICAgICAgIHJlc2l6ZSgpOwogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemUpOwoKICAgICAgICBmdW5jdGlvbiBoZXhUb1JnYihoZXgpIHsKICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gL14jPyhbYS1mXGRdezJ9KShbYS1mXGRdezJ9KShbYS1mXGRdezJ9KSQvaS5leGVjKGhleCk7CiAgICAgICAgICAgIHJldHVybiByZXN1bHQgPyB7CiAgICAgICAgICAgICAgICByOiBwYXJzZUludChyZXN1bHRbMV0sIDE2KSwKICAgICAgICAgICAgICAgIGc6IHBhcnNlSW50KHJlc3VsdFsyXSwgMTYpLAogICAgICAgICAgICAgICAgYjogcGFyc2VJbnQocmVzdWx0WzNdLCAxNikKICAgICAgICAgICAgfSA6IG51bGw7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiByZ2JUb0hleChyLCBnLCBiKSB7CiAgICAgICAgICAgIHJldHVybiAiIyIgKyAoKDEgPDwgMjQpICsgKHIgPDwgMTYpICsgKGcgPDwgOCkgKyBiKS50b1N0cmluZygxNikuc2xpY2UoMSk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBtaXhDb2xvcnNXM1NjaG9vbHMoY29sb3IxLCBjb2xvcjIsIHJhdGlvKSB7CiAgICAgICAgICAgIC8vIFczU2Nob29scyBjb2xvciBtaXhlciB1c2VzIFJHQiBhdmVyYWdpbmcKICAgICAgICAgICAgY29uc3QgYzEgPSBoZXhUb1JnYihjb2xvcjEpOwogICAgICAgICAgICBjb25zdCBjMiA9IGhleFRvUmdiKGNvbG9yMik7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCByID0gTWF0aC5yb3VuZChjMS5yICogcmF0aW8gKyBjMi5yICogKDEgLSByYXRpbykpOwogICAgICAgICAgICBjb25zdCBnID0gTWF0aC5yb3VuZChjMS5nICogcmF0aW8gKyBjMi5nICogKDEgLSByYXRpbykpOwogICAgICAgICAgICBjb25zdCBiID0gTWF0aC5yb3VuZChjMS5iICogcmF0aW8gKyBjMi5iICogKDEgLSByYXRpbykpOwogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIHJnYlRvSGV4KHIsIGcsIGIpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gcmdiYUZyb21IZXgoaGV4LCBhbHBoYSkgewogICAgICAgICAgICBjb25zdCByZ2IgPSBoZXhUb1JnYihoZXgpOwogICAgICAgICAgICByZXR1cm4gYHJnYmEoJHtyZ2Iucn0sICR7cmdiLmd9LCAke3JnYi5ifSwgJHthbHBoYX0pYDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJhY2tncm91bmQoKSB7CiAgICAgICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aXN1YWxDYW52YXMnKTsKICAgICAgICAgICAgY29uc3Qgb3BhY2l0eSA9IHNldHRpbmdzLmJnT3BhY2l0eTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChzZXR0aW5ncy5iZ1R5cGUgPT09ICdzb2xpZCcpIHsKICAgICAgICAgICAgICAgIGlmIChvcGFjaXR5IDwgMS4wKSB7CiAgICAgICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlLmJhY2tncm91bmQgPSByZ2JhRnJvbUhleChzZXR0aW5ncy5zb2xpZENvbG9yLCBvcGFjaXR5KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlLmJhY2tncm91bmQgPSBzZXR0aW5ncy5zb2xpZENvbG9yOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYgKHNldHRpbmdzLmJnVHlwZSA9PT0gJ2dyYWRpZW50JykgewogICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLmdyYWRpZW50VHlwZSA9PT0gJ2N1c3RvbScpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBjMSA9IG9wYWNpdHkgPCAxLjAgPyByZ2JhRnJvbUhleChzZXR0aW5ncy5ncmFkaWVudENvbG9yMSwgb3BhY2l0eSkgOiBzZXR0aW5ncy5ncmFkaWVudENvbG9yMTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBjMiA9IG9wYWNpdHkgPCAxLjAgPyByZ2JhRnJvbUhleChzZXR0aW5ncy5ncmFkaWVudENvbG9yMiwgb3BhY2l0eSkgOiBzZXR0aW5ncy5ncmFkaWVudENvbG9yMjsKICAgICAgICAgICAgICAgICAgICBjb25zdCBncmFkaWVudHMgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICdscic6IGBsaW5lYXItZ3JhZGllbnQodG8gcmlnaHQsICR7YzF9IDAlLCAke2MyfSAxMDAlKWAsCiAgICAgICAgICAgICAgICAgICAgICAgICdybCc6IGBsaW5lYXItZ3JhZGllbnQodG8gbGVmdCwgJHtjMX0gMCUsICR7YzJ9IDEwMCUpYCwKICAgICAgICAgICAgICAgICAgICAgICAgJ3RiJzogYGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sICR7YzF9IDAlLCAke2MyfSAxMDAlKWAsCiAgICAgICAgICAgICAgICAgICAgICAgICdidCc6IGBsaW5lYXItZ3JhZGllbnQodG8gdG9wLCAke2MxfSAwJSwgJHtjMn0gMTAwJSlgLAogICAgICAgICAgICAgICAgICAgICAgICAnZGlhZzEnOiBgbGluZWFyLWdyYWRpZW50KDEzNWRlZywgJHtjMX0gMCUsICR7YzJ9IDEwMCUpYAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgY2FudmFzLnN0eWxlLmJhY2tncm91bmQgPSBncmFkaWVudHNbc2V0dGluZ3MuYmdHcmFkaWVudF07CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vIE1peGVyIGdyYWRpZW50IC0gY3JlYXRlIDMtY29sb3IgZ3JhZGllbnQgdGhyb3VnaCBtaXhlZCBtaWRkbGUKICAgICAgICAgICAgICAgICAgICBjb25zdCBjMVJhdyA9IHNldHRpbmdzLm1peGVyQ29sb3IxOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGMyUmF3ID0gc2V0dGluZ3MubWl4ZXJDb2xvcjI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWl4ZWRSYXcgPSBtaXhDb2xvcnNXM1NjaG9vbHMoYzFSYXcsIGMyUmF3LCBzZXR0aW5ncy5taXhSYXRpbyk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgY29uc3QgYzEgPSBvcGFjaXR5IDwgMS4wID8gcmdiYUZyb21IZXgoYzFSYXcsIG9wYWNpdHkpIDogYzFSYXc7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYzIgPSBvcGFjaXR5IDwgMS4wID8gcmdiYUZyb21IZXgoYzJSYXcsIG9wYWNpdHkpIDogYzJSYXc7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWl4ZWQgPSBvcGFjaXR5IDwgMS4wID8gcmdiYUZyb21IZXgobWl4ZWRSYXcsIG9wYWNpdHkpIDogbWl4ZWRSYXc7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ3JhZGllbnRzID0gewogICAgICAgICAgICAgICAgICAgICAgICAnbHInOiBgbGluZWFyLWdyYWRpZW50KHRvIHJpZ2h0LCAke2MxfSAwJSwgJHttaXhlZH0gNTAlLCAke2MyfSAxMDAlKWAsCiAgICAgICAgICAgICAgICAgICAgICAgICdybCc6IGBsaW5lYXItZ3JhZGllbnQodG8gbGVmdCwgJHtjMX0gMCUsICR7bWl4ZWR9IDUwJSwgJHtjMn0gMTAwJSlgLAogICAgICAgICAgICAgICAgICAgICAgICAndGInOiBgbGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgJHtjMX0gMCUsICR7bWl4ZWR9IDUwJSwgJHtjMn0gMTAwJSlgLAogICAgICAgICAgICAgICAgICAgICAgICAnYnQnOiBgbGluZWFyLWdyYWRpZW50KHRvIHRvcCwgJHtjMX0gMCUsICR7bWl4ZWR9IDUwJSwgJHtjMn0gMTAwJSlgLAogICAgICAgICAgICAgICAgICAgICAgICAnZGlhZzEnOiBgbGluZWFyLWdyYWRpZW50KDEzNWRlZywgJHtjMX0gMCUsICR7bWl4ZWR9IDUwJSwgJHtjMn0gMTAwJSlgCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjYW52YXMuc3R5bGUuYmFja2dyb3VuZCA9IGdyYWRpZW50c1tzZXR0aW5ncy5taXhlckRpcmVjdGlvbl07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gQWRkaXRpdmUgbW9kZSBpcyBoYW5kbGVkIGluIGRyYXcgbG9vcAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gY2FsY3VsYXRlQWRkaXRpdmVCYWNrZ3JvdW5kKCkgewogICAgICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQ29sbGVjdCBhbGwgYWN0aXZlIG5vdGUgY29sb3JzCiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUNvbG9ycyA9IFtdOwogICAgICAgICAgICBPYmplY3QudmFsdWVzKGFjdGl2ZU5vdGVzKS5mb3JFYWNoKG5vdGVzID0+IHsKICAgICAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKG5vdGVzKS5mb3JFYWNoKChbbWlkaSwgdmVsXSkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pZGlOdW0gPSBwYXJzZUludChtaWRpKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBvY3QgPSBNYXRoLmZsb29yKG1pZGlOdW0gLyAxMikgLSAxOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBtaWRpTnVtICUgMTI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYnJpZ2h0ID0gTWF0aC5tYXgoMC4xNSwgb2N0IC8gMTApOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHNhdCA9IHZlbCAvIDEyNzsKICAgICAgICAgICAgICAgICAgICBjb25zdCBbciwgZywgYl0gPSBORVdUT05bbl07CiAgICAgICAgICAgICAgICAgICAgYWN0aXZlQ29sb3JzLnB1c2goWwogICAgICAgICAgICAgICAgICAgICAgICByICogYnJpZ2h0ICogc2F0ICsgMjU1ICogKDEgLSBzYXQpICogYnJpZ2h0LAogICAgICAgICAgICAgICAgICAgICAgICBnICogYnJpZ2h0ICogc2F0ICsgMjU1ICogKDEgLSBzYXQpICogYnJpZ2h0LAogICAgICAgICAgICAgICAgICAgICAgICBiICogYnJpZ2h0ICogc2F0ICsgMjU1ICogKDEgLSBzYXQpICogYnJpZ2h0CiAgICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBBZGQgcmVsZWFzaW5nIGNvbG9ycyB3aXRoIGZhZGUgYmFzZWQgb24gdGltZQogICAgICAgICAgICByZWxlYXNpbmdDb2xvcnMgPSByZWxlYXNpbmdDb2xvcnMuZmlsdGVyKHJjID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGFnZSA9IG5vdyAtIHJjLnRpbWVzdGFtcDsKICAgICAgICAgICAgICAgIGlmIChhZ2UgPiByYy5yZWxlYXNlVGltZSkgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb25zdCBmYWRlQW1vdW50ID0gMSAtIChhZ2UgLyByYy5yZWxlYXNlVGltZSk7CiAgICAgICAgICAgICAgICBhY3RpdmVDb2xvcnMucHVzaChbCiAgICAgICAgICAgICAgICAgICAgcmMuY29sb3JbMF0gKiBmYWRlQW1vdW50LAogICAgICAgICAgICAgICAgICAgIHJjLmNvbG9yWzFdICogZmFkZUFtb3VudCwKICAgICAgICAgICAgICAgICAgICByYy5jb2xvclsyXSAqIGZhZGVBbW91bnQKICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKGFjdGl2ZUNvbG9ycy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIHJldHVybiBbMjIsIDMzLCA2Ml07IC8vIERlZmF1bHQgZGFyayBjb2xvcgogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBBZGRpdGl2ZSBjb2xvciBtaXhpbmcgKGxpa2UgbGlnaHQpCiAgICAgICAgICAgIGxldCBzdW1SID0gMCwgc3VtRyA9IDAsIHN1bUIgPSAwOwogICAgICAgICAgICBhY3RpdmVDb2xvcnMuZm9yRWFjaCgoW3IsIGcsIGJdKSA9PiB7CiAgICAgICAgICAgICAgICBzdW1SICs9IHI7CiAgICAgICAgICAgICAgICBzdW1HICs9IGc7CiAgICAgICAgICAgICAgICBzdW1CICs9IGI7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy8gQXZlcmFnZSBhbmQgYXBwbHkgYmFzZSBkYXJrbmVzcwogICAgICAgICAgICBjb25zdCBhdmdSID0gc3VtUiAvIGFjdGl2ZUNvbG9ycy5sZW5ndGg7CiAgICAgICAgICAgIGNvbnN0IGF2Z0cgPSBzdW1HIC8gYWN0aXZlQ29sb3JzLmxlbmd0aDsKICAgICAgICAgICAgY29uc3QgYXZnQiA9IHN1bUIgLyBhY3RpdmVDb2xvcnMubGVuZ3RoOwoKICAgICAgICAgICAgLy8gTWl4IHdpdGggYmxhY2sgYmFzZWQgb24gYmFzZSBpbnRlbnNpdHkKICAgICAgICAgICAgY29uc3QgZGFya25lc3MgPSBzZXR0aW5ncy5iYXNlQ29sb3JJbnRlbnNpdHk7CiAgICAgICAgICAgIHJldHVybiBbCiAgICAgICAgICAgICAgICBhdmdSICogKDEgLSBkYXJrbmVzcyksCiAgICAgICAgICAgICAgICBhdmdHICogKDEgLSBkYXJrbmVzcyksCiAgICAgICAgICAgICAgICBhdmdCICogKDEgLSBkYXJrbmVzcykKICAgICAgICAgICAgXTsKICAgICAgICB9CgogICAgICAgIC8vIE1JREkKICAgICAgICBpZiAobmF2aWdhdG9yLnJlcXVlc3RNSURJQWNjZXNzKSB7CiAgICAgICAgICAgIG5hdmlnYXRvci5yZXF1ZXN0TUlESUFjY2VzcygpLnRoZW4oYWNjZXNzID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0cyA9IEFycmF5LmZyb20oYWNjZXNzLmlucHV0cy52YWx1ZXMoKSk7CiAgICAgICAgICAgICAgICBkZXZpY2VzID0gaW5wdXRzOwoKICAgICAgICAgICAgICAgIGlmIChpbnB1dHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGF0dXMnKS50ZXh0Q29udGVudCA9IGDinJMgJHtpbnB1dHMubGVuZ3RofSBUcmFjayhzKWA7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXR1cycpLmNsYXNzTGlzdC5hZGQoJ2Nvbm5lY3RlZCcpOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmFja0NvdW50JykudGV4dENvbnRlbnQgPSBgJHtpbnB1dHMubGVuZ3RofSB0cmFjayhzKSBjb25uZWN0ZWRgOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlucHV0cy5mb3JFYWNoKChpbnB1dCwgaWR4KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZU5vdGVzW2lkeF0gPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgcGFydGljbGVzW2lkeF0gPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQub25taWRpbWVzc2FnZSA9IChtKSA9PiBtaWRpKG0sIGlkeCk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gbWlkaShtc2csIGlkeCkgewogICAgICAgICAgICBjb25zdCBbY21kLCBub3RlLCB2ZWxdID0gbXNnLmRhdGE7CiAgICAgICAgICAgIGNvbnN0IG9uID0gY21kID49IDE0NCAmJiBjbWQgPD0gMTU5ICYmIHZlbCA+IDA7CiAgICAgICAgICAgIGNvbnN0IG9mZiA9IChjbWQgPj0gMTI4ICYmIGNtZCA8PSAxNDMpIHx8IChjbWQgPj0gMTQ0ICYmIGNtZCA8PSAxNTkgJiYgdmVsID09PSAwKTsKCiAgICAgICAgICAgIGlmIChvbikgewogICAgICAgICAgICAgICAgYWN0aXZlTm90ZXNbaWR4XVtub3RlXSA9IHZlbDsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29uc3Qgb2N0ID0gTWF0aC5mbG9vcihub3RlIC8gMTIpIC0gMTsKICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBub3RlICUgMTI7CiAgICAgICAgICAgICAgICBjb25zdCBicmlnaHQgPSBNYXRoLm1heCgwLjE1LCBvY3QgLyAxMCk7CiAgICAgICAgICAgICAgICBjb25zdCBzYXQgPSB2ZWwgLyAxMjc7CiAgICAgICAgICAgICAgICBjb25zdCBbciwgZywgYl0gPSBORVdUT05bbl07CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHBhcnRpY2xlc1tpZHhdLnB1c2goewogICAgICAgICAgICAgICAgICAgIHg6IG5vdGUgLyAxMjcsCiAgICAgICAgICAgICAgICAgICAgeTogMCwKICAgICAgICAgICAgICAgICAgICBzOiBzZXR0aW5ncy5wYXJ0aWNsZVNpemUgKyAodmVsIC8gMTI3KSAqIHNldHRpbmdzLnBhcnRpY2xlU2l6ZSwKICAgICAgICAgICAgICAgICAgICBjOiBgcmdiKCR7cipicmlnaHQqc2F0ICsgMjU1KigxLXNhdCkqYnJpZ2h0fSwke2cqYnJpZ2h0KnNhdCArIDI1NSooMS1zYXQpKmJyaWdodH0sJHtiKmJyaWdodCpzYXQgKyAyNTUqKDEtc2F0KSpicmlnaHR9KWAsCiAgICAgICAgICAgICAgICAgICAgcmdiOiBbcipicmlnaHQqc2F0ICsgMjU1KigxLXNhdCkqYnJpZ2h0LCBnKmJyaWdodCpzYXQgKyAyNTUqKDEtc2F0KSpicmlnaHQsIGIqYnJpZ2h0KnNhdCArIDI1NSooMS1zYXQpKmJyaWdodF0sCiAgICAgICAgICAgICAgICAgICAgdDogMCwKICAgICAgICAgICAgICAgICAgICBtOiBzZXR0aW5ncy5wYXJ0aWNsZUxpZmV0aW1lLAogICAgICAgICAgICAgICAgICAgIG5vdGU6IG5vdGUsCiAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKHBhcnRpY2xlc1tpZHhdLmxlbmd0aCA+IHNldHRpbmdzLm1heFBhcnRpY2xlcykgcGFydGljbGVzW2lkeF0uc2hpZnQoKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICB9IGVsc2UgaWYgKG9mZikgewogICAgICAgICAgICAgICAgLy8gV2hlbiBub3RlIGlzIHJlbGVhc2VkLCBhZGQgaXRzIGNvbG9yIHRvIHJlbGVhc2luZyBjb2xvcnMgZm9yIHNtb290aCBmYWRlb3V0CiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlTm90ZXNbaWR4XVtub3RlXSkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IG9jdCA9IE1hdGguZmxvb3Iobm90ZSAvIDEyKSAtIDE7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IG5vdGUgJSAxMjsKICAgICAgICAgICAgICAgICAgICBjb25zdCBicmlnaHQgPSBNYXRoLm1heCgwLjE1LCBvY3QgLyAxMCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2F0ID0gYWN0aXZlTm90ZXNbaWR4XVtub3RlXSAvIDEyNzsKICAgICAgICAgICAgICAgICAgICBjb25zdCBbciwgZywgYl0gPSBORVdUT05bbl07CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcmVsZWFzaW5nQ29sb3JzLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgciAqIGJyaWdodCAqIHNhdCArIDI1NSAqICgxIC0gc2F0KSAqIGJyaWdodCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgKiBicmlnaHQgKiBzYXQgKyAyNTUgKiAoMSAtIHNhdCkgKiBicmlnaHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiICogYnJpZ2h0ICogc2F0ICsgMjU1ICogKDEgLSBzYXQpICogYnJpZ2h0CiAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSwKICAgICAgICAgICAgICAgICAgICAgICAgcmVsZWFzZVRpbWU6IHNldHRpbmdzLnJlbGVhc2VUaW1lCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkZWxldGUgYWN0aXZlTm90ZXNbaWR4XVtub3RlXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGRldGVjdCBjaG9yZHMKICAgICAgICBmdW5jdGlvbiBncm91cENob3JkcyhwYXJ0aWNsZXMpIHsKICAgICAgICAgICAgY29uc3QgZ3JvdXBzID0gW107CiAgICAgICAgICAgIGNvbnN0IGdyb3VwZWQgPSBuZXcgU2V0KCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBwYXJ0aWNsZXMuZm9yRWFjaCgocCwgaSkgPT4gewogICAgICAgICAgICAgICAgaWYgKGdyb3VwZWQuaGFzKGkpKSByZXR1cm47CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNvbnN0IGNob3JkID0gW3BdOwogICAgICAgICAgICAgICAgZ3JvdXBlZC5hZGQoaSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHBhcnRpY2xlcy5mb3JFYWNoKChwMiwgaikgPT4gewogICAgICAgICAgICAgICAgICAgIGlmIChpICE9PSBqICYmICFncm91cGVkLmhhcyhqKSAmJiBNYXRoLmFicyhwLnRpbWVzdGFtcCAtIHAyLnRpbWVzdGFtcCkgPCBzZXR0aW5ncy5jaG9yZFdpbmRvdyAmJiBNYXRoLmFicyhwLnkgLSBwMi55KSA8IDAuMTUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2hvcmQucHVzaChwMik7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwZWQuYWRkKGopOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBncm91cHMucHVzaChjaG9yZCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIGdyb3VwczsKICAgICAgICB9CgogICAgICAgIC8vIE1peCBjb2xvcnMKICAgICAgICBmdW5jdGlvbiBtaXhDb2xvcnMoY29sb3JzKSB7CiAgICAgICAgICAgIGlmIChjb2xvcnMubGVuZ3RoID09PSAwKSByZXR1cm4gWzAsIDAsIDBdOwogICAgICAgICAgICBjb25zdCBzdW0gPSBjb2xvcnMucmVkdWNlKChhY2MsIGMpID0+IFthY2NbMF0gKyBjWzBdLCBhY2NbMV0gKyBjWzFdLCBhY2NbMl0gKyBjWzJdXSwgWzAsIDAsIDBdKTsKICAgICAgICAgICAgcmV0dXJuIFtzdW1bMF0gLyBjb2xvcnMubGVuZ3RoLCBzdW1bMV0gLyBjb2xvcnMubGVuZ3RoLCBzdW1bMl0gLyBjb2xvcnMubGVuZ3RoXTsKICAgICAgICB9CgogICAgICAgIC8vIEFuaW1hdGlvbgogICAgICAgIGZ1bmN0aW9uIGRyYXcodGltZSkgewogICAgICAgICAgICBjb25zdCBkdCA9IHRpbWUgLSBsYXN0RnJhbWU7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoZHQgPCAzMykgewogICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGRyYXcpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxhc3RGcmFtZSA9IHRpbWU7CgogICAgICAgICAgICAvLyBDbGVhciB3aXRoIHRyYW5zcGFyZW5jeSB0byBzaG93IGdyYWRpZW50IGJhY2tncm91bmQKICAgICAgICAgICAgdmN0eC5jbGVhclJlY3QoMCwgMCwgdmMud2lkdGgsIHZjLmhlaWdodCk7CgogICAgICAgICAgICAvLyBVcGRhdGUgYWRkaXRpdmUgYmFja2dyb3VuZCBpZiBlbmFibGVkCiAgICAgICAgICAgIGlmIChzZXR0aW5ncy5iZ1R5cGUgPT09ICdhZGRpdGl2ZScpIHsKICAgICAgICAgICAgICAgIHRhcmdldEJnQ29sb3IgPSBjYWxjdWxhdGVBZGRpdGl2ZUJhY2tncm91bmQoKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gRmFzdCBhdHRhY2sgZm9yIG5ldyBub3RlcwogICAgICAgICAgICAgICAgY29uc3QgYXR0YWNrU3BlZWRzID0geyBpbnN0YW50OiAxLCBmYXN0OiAwLjQsIG1lZGl1bTogMC4yLCBzbG93OiAwLjEgfTsKICAgICAgICAgICAgICAgIGNvbnN0IGF0dGFja1NwZWVkID0gYXR0YWNrU3BlZWRzW3NldHRpbmdzLmF0dGFja1NwZWVkXTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY3VycmVudEJnQ29sb3JbMF0gKz0gKHRhcmdldEJnQ29sb3JbMF0gLSBjdXJyZW50QmdDb2xvclswXSkgKiBhdHRhY2tTcGVlZDsKICAgICAgICAgICAgICAgIGN1cnJlbnRCZ0NvbG9yWzFdICs9ICh0YXJnZXRCZ0NvbG9yWzFdIC0gY3VycmVudEJnQ29sb3JbMV0pICogYXR0YWNrU3BlZWQ7CiAgICAgICAgICAgICAgICBjdXJyZW50QmdDb2xvclsyXSArPSAodGFyZ2V0QmdDb2xvclsyXSAtIGN1cnJlbnRCZ0NvbG9yWzJdKSAqIGF0dGFja1NwZWVkOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBBcHBseSBtYXN0ZXIgb3BhY2l0eSB0byBhZGRpdGl2ZSBiYWNrZ3JvdW5kCiAgICAgICAgICAgICAgICBjb25zdCBiZ0NvbG9yID0gYHJnYmEoJHtNYXRoLnJvdW5kKGN1cnJlbnRCZ0NvbG9yWzBdKX0sJHtNYXRoLnJvdW5kKGN1cnJlbnRCZ0NvbG9yWzFdKX0sJHtNYXRoLnJvdW5kKGN1cnJlbnRCZ0NvbG9yWzJdKX0sJHtzZXR0aW5ncy5iZ09wYWNpdHl9KWA7CiAgICAgICAgICAgICAgICB2Yy5zdHlsZS5iYWNrZ3JvdW5kID0gYmdDb2xvcjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdsYW5lcycpIHsKICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBPYmplY3Qua2V5cyhwYXJ0aWNsZXMpLmxlbmd0aCB8fCAxOwogICAgICAgICAgICAgICAgY29uc3QgaCA9IHZjLmhlaWdodCAvIG47CgogICAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMocGFydGljbGVzKS5mb3JFYWNoKChbaWR4LCBwc10sIGkpID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBseSA9IGkgKiBoOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHZjdHguc3Ryb2tlU3R5bGUgPSAncmdiYSgyNTUsMjU1LDI1NSwwLjEpJzsKICAgICAgICAgICAgICAgICAgICB2Y3R4LnN0cm9rZVJlY3QoMCwgbHksIHZjLndpZHRoLCBoKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHBhcnRpY2xlcwogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSBwcy5sZW5ndGggLSAxOyBqID49IDA7IGotLSkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwID0gcHNbal07CiAgICAgICAgICAgICAgICAgICAgICAgIHAudCArPSBkdDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHAudCA+PSBwLm0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBzLnNwbGljZShqLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHAueSA9IHAudCAvIHAubTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIEdyb3VwIGludG8gY2hvcmRzCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hvcmRHcm91cHMgPSBncm91cENob3Jkcyhwcyk7CgogICAgICAgICAgICAgICAgICAgIC8vIERyYXcgY2hvcmRzCiAgICAgICAgICAgICAgICAgICAgY2hvcmRHcm91cHMuZm9yRWFjaChjaG9yZCA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaG9yZC5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEcmF3IG1peGVkIGNvbG9yIGJhY2tncm91bmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1peGVkUkdCID0gbWl4Q29sb3JzKGNob3JkLm1hcChwID0+IHAucmdiKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtaXhlZENvbG9yID0gYHJnYigke01hdGgucm91bmQobWl4ZWRSR0JbMF0pfSwke01hdGgucm91bmQobWl4ZWRSR0JbMV0pfSwke01hdGgucm91bmQobWl4ZWRSR0JbMl0pfSlgOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzb3J0ZWRDaG9yZCA9IFsuLi5jaG9yZF0uc29ydCgoYSwgYikgPT4gYS54IC0gYi54KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhZGRpbmcgPSAxNTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRHJhdyBmaWxsZWQgYmFja2dyb3VuZCBzaGFwZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5maWxsU3R5bGUgPSBtaXhlZENvbG9yOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5nbG9iYWxBbHBoYSA9ICgxIC0gY2hvcmRbMF0ueSkgKiBzZXR0aW5ncy5jaG9yZE9wYWNpdHk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbGwgZW5sYXJnZWQgY2lyY2xlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydGVkQ2hvcmQuZm9yRWFjaChwID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZjdHguYXJjKHAueCAqIHZjLndpZHRoLCBseSArIHAueSAqIGgsIHAucyAvIDIgKyBwYWRkaW5nLCAwLCBNYXRoLlBJICogMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5maWxsKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ubmVjdCB3aXRoIHJlY3RhbmdsZXMgZm9yIHNtb290aCBjb250aW51b3VzIHNoYXBlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvcnRlZENob3JkLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHAxID0gc29ydGVkQ2hvcmRbaV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcDIgPSBzb3J0ZWRDaG9yZFtpICsgMV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeDEgPSBwMS54ICogdmMud2lkdGg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeTEgPSBseSArIHAxLnkgKiBoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHgyID0gcDIueCAqIHZjLndpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHkyID0gbHkgKyBwMi55ICogaDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gTWF0aC5tYXgocDEucywgcDIucykgLyAyICsgcGFkZGluZzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4LmZpbGxSZWN0KHgxLCB5MSAtIHIsIHgyIC0geDEsIHIgKiAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRHJhdyBzdWJ0bGUgb3V0bGluZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5zdHJva2VTdHlsZSA9IG1peGVkQ29sb3I7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4LmxpbmVXaWR0aCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4Lmdsb2JhbEFscGhhID0gKDEgLSBjaG9yZFswXS55KSAqIDAuNTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZjdHguZmlsdGVyID0gJ2JsdXIoMnB4KSc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRlZENob3JkLmZvckVhY2gocCA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4LmFyYyhwLnggKiB2Yy53aWR0aCwgbHkgKyBwLnkgKiBoLCBwLnMgLyAyICsgc2V0dGluZ3MuY2hvcmRQYWRkaW5nLCAwLCBNYXRoLlBJICogMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5zdHJva2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4LmZpbHRlciA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gRHJhdyBpbmRpdmlkdWFsIG5vdGVzIG9uIHRvcAogICAgICAgICAgICAgICAgICAgICAgICBjaG9yZC5mb3JFYWNoKHAgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYSA9IDEgLSBwLnk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4Lmdsb2JhbEFscGhhID0gYTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZjdHguZmlsbFN0eWxlID0gcC5jOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZjdHguYXJjKHAueCAqIHZjLndpZHRoLCBseSArIHAueSAqIGgsIHAucyAvIDIsIDAsIDYuMjgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5maWxsKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICB2Y3R4Lmdsb2JhbEFscGhhID0gMTsKCiAgICAgICAgICAgICAgICAgICAgdmN0eC5maWxsU3R5bGUgPSAncmdiYSgyNTUsMjU1LDI1NSwwLjQpJzsKICAgICAgICAgICAgICAgICAgICB2Y3R4LmZvbnQgPSAnMTFweCBBcmlhbCc7CiAgICAgICAgICAgICAgICAgICAgdmN0eC5maWxsVGV4dChgVCR7cGFyc2VJbnQoaWR4KSArIDF9YCwgNSwgbHkgKyAxNSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHBhcnRpY2xlcykuZm9yRWFjaCgoW2lkeCwgcHNdKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmx1ciA9IHBhcnNlSW50KGlkeCkgKiAyICsgMzsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgcGFydGljbGVzCiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IHBzLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHAgPSBwc1tqXTsKICAgICAgICAgICAgICAgICAgICAgICAgcC50ICs9IGR0OwogICAgICAgICAgICAgICAgICAgICAgICBpZiAocC50ID49IHAubSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHMuc3BsaWNlKGosIDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcC55ID0gcC50IC8gcC5tOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgLy8gR3JvdXAgaW50byBjaG9yZHMKICAgICAgICAgICAgICAgICAgICBjb25zdCBjaG9yZEdyb3VwcyA9IGdyb3VwQ2hvcmRzKHBzKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gRHJhdyBjaG9yZHMKICAgICAgICAgICAgICAgICAgICBjaG9yZEdyb3Vwcy5mb3JFYWNoKGNob3JkID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNob3JkLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERyYXcgbWl4ZWQgY29sb3IgYmFja2dyb3VuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWl4ZWRSR0IgPSBtaXhDb2xvcnMoY2hvcmQubWFwKHAgPT4gcC5yZ2IpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1peGVkQ29sb3IgPSBgcmdiKCR7TWF0aC5yb3VuZChtaXhlZFJHQlswXSl9LCR7TWF0aC5yb3VuZChtaXhlZFJHQlsxXSl9LCR7TWF0aC5yb3VuZChtaXhlZFJHQlsyXSl9KWA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gKDEgLSBjaG9yZFswXS55KSAqIE1hdGgubWF4KDAuNSwgMSAtIHBhcnNlSW50KGlkeCkgKiAwLjE1KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc29ydGVkQ2hvcmQgPSBbLi4uY2hvcmRdLnNvcnQoKGEsIGIpID0+IGEueCAtIGIueCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYWRkaW5nID0gMTU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERyYXcgZmlsbGVkIGJhY2tncm91bmQgc2hhcGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZjdHguZmlsbFN0eWxlID0gbWl4ZWRDb2xvcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZjdHguZ2xvYmFsQWxwaGEgPSBhICogc2V0dGluZ3MuY2hvcmRPcGFjaXR5OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaWxsIGVubGFyZ2VkIGNpcmNsZXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRlZENob3JkLmZvckVhY2gocCA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4LmFyYyhwLnggKiB2Yy53aWR0aCwgcC55ICogdmMuaGVpZ2h0LCBwLnMgLyAyICsgc2V0dGluZ3MuY2hvcmRQYWRkaW5nLCAwLCBNYXRoLlBJICogMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5maWxsKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ubmVjdCB3aXRoIHJlY3RhbmdsZXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc29ydGVkQ2hvcmQubGVuZ3RoIC0gMTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcDEgPSBzb3J0ZWRDaG9yZFtpXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwMiA9IHNvcnRlZENob3JkW2kgKyAxXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB4MSA9IHAxLnggKiB2Yy53aWR0aDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB5MSA9IHAxLnkgKiB2Yy5oZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeDIgPSBwMi54ICogdmMud2lkdGg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeTIgPSBwMi55ICogdmMuaGVpZ2h0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBNYXRoLm1heChwMS5zLCBwMi5zKSAvIDIgKyBzZXR0aW5ncy5jaG9yZFBhZGRpbmc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5maWxsUmVjdCh4MSwgeTEgLSByLCB4MiAtIHgxLCByICogMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN1YnRsZSBvdXRsaW5lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4LnN0cm9rZVN0eWxlID0gbWl4ZWRDb2xvcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZjdHgubGluZVdpZHRoID0gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZjdHguZ2xvYmFsQWxwaGEgPSBhICogMC41OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5maWx0ZXIgPSAnYmx1cigycHgpJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydGVkQ2hvcmQuZm9yRWFjaChwID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZjdHguYXJjKHAueCAqIHZjLndpZHRoLCBwLnkgKiB2Yy5oZWlnaHQsIHAucyAvIDIgKyBzZXR0aW5ncy5jaG9yZFBhZGRpbmcsIDAsIE1hdGguUEkgKiAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4LnN0cm9rZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZjdHguZmlsdGVyID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBEcmF3IGluZGl2aWR1YWwgbm90ZXMgb24gdG9wCiAgICAgICAgICAgICAgICAgICAgICAgIGNob3JkLmZvckVhY2gocCA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gKDEgLSBwLnkpICogTWF0aC5tYXgoMC41LCAxIC0gcGFyc2VJbnQoaWR4KSAqIDAuMTUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmN0eC5nbG9iYWxBbHBoYSA9IGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4LmZpbGxTdHlsZSA9IHAuYzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBibHVyOyBrKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Y3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZjdHguYXJjKHAueCAqIHZjLndpZHRoLCBwLnkgKiB2Yy5oZWlnaHQsIChwLnMgKyBrKSAvIDIsIDAsIDYuMjgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZjdHguZmlsbCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB2Y3R4Lmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBkcmF3Q29sb3JNYXAoKTsKICAgICAgICAgICAgZHJhd1BpYW5vKCk7CiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShkcmF3KTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGRyYXdDb2xvck1hcCgpIHsKICAgICAgICAgICAgY21jdHguY2xlYXJSZWN0KDAsIDAsIGNtYy53aWR0aCwgY21jLmhlaWdodCk7CiAgICAgICAgICAgIGNvbnN0IGt3ID0gY21jLndpZHRoIC8gNzU7CiAgICAgICAgICAgIGNvbnN0IGggPSBjbWMuaGVpZ2h0OwoKICAgICAgICAgICAgbGV0IHdpID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgb2N0ID0gMDsgb2N0IDw9IDEwOyBvY3QrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCAxMjsgbisrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9jdCA9PT0gMTAgJiYgbiA+IDApIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGlmIChbMSwgMywgNiwgOCwgMTBdLmluY2x1ZGVzKG4pKSBjb250aW51ZTsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWlkaSA9IChvY3QgKyAxKSAqIDEyICsgbjsKICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyhhY3RpdmVOb3RlcykuZm9yRWFjaChub3RlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3Rlc1ttaWRpXSkgYWN0aXZlID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgYnJpZ2h0ID0gTWF0aC5tYXgoMC4xNSwgb2N0IC8gMTApOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IFtyLCBnLCBiXSA9IE5FV1RPTltuXTsKICAgICAgICAgICAgICAgICAgICBjbWN0eC5maWxsU3R5bGUgPSBgcmdiKCR7cipicmlnaHR9LCR7ZypicmlnaHR9LCR7YipicmlnaHR9KWA7CiAgICAgICAgICAgICAgICAgICAgY21jdHguZmlsbFJlY3Qod2kgKiBrdywgMCwga3csIGgpOwoKICAgICAgICAgICAgICAgICAgICB3aSsrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBCbGFjayBrZXlzCiAgICAgICAgICAgIHdpID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgb2N0ID0gMDsgb2N0IDw9IDEwOyBvY3QrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCAxMjsgbisrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9jdCA9PT0gMTAgJiYgbiA+IDApIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGlmICghWzEsIDMsIDYsIDgsIDEwXS5pbmNsdWRlcyhuKSkgeyB3aSsrOyBjb250aW51ZTsgfQoKICAgICAgICAgICAgICAgICAgICBjb25zdCBtaWRpID0gKG9jdCArIDEpICogMTIgKyBuOwogICAgICAgICAgICAgICAgICAgIGxldCBhY3RpdmUgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBPYmplY3QudmFsdWVzKGFjdGl2ZU5vdGVzKS5mb3JFYWNoKG5vdGVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGVzW21pZGldKSBhY3RpdmUgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICBjb25zdCBicmlnaHQgPSBNYXRoLm1heCgwLjE1LCBvY3QgLyAxMCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgW3IsIGcsIGJdID0gTkVXVE9OW25dOwogICAgICAgICAgICAgICAgICAgIGNtY3R4LmZpbGxTdHlsZSA9IGByZ2IoJHtyKmJyaWdodH0sJHtnKmJyaWdodH0sJHtiKmJyaWdodH0pYDsKICAgICAgICAgICAgICAgICAgICBjbWN0eC5maWxsUmVjdCh3aSAqIGt3IC0ga3cgKiAwLjMsIDAsIGt3ICogMC42LCBoICogMC42NSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGRyYXdQaWFubygpIHsKICAgICAgICAgICAgcGN0eC5jbGVhclJlY3QoMCwgMCwgcGMud2lkdGgsIHBjLmhlaWdodCk7CiAgICAgICAgICAgIGNvbnN0IGt3ID0gcGMud2lkdGggLyA3NTsKICAgICAgICAgICAgY29uc3QgaCA9IHBjLmhlaWdodDsKCiAgICAgICAgICAgIC8vIFdoaXRlIGtleXMKICAgICAgICAgICAgbGV0IHdpID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgb2N0ID0gMDsgb2N0IDw9IDEwOyBvY3QrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCAxMjsgbisrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9jdCA9PT0gMTAgJiYgbiA+IDApIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGlmIChbMSwgMywgNiwgOCwgMTBdLmluY2x1ZGVzKG4pKSBjb250aW51ZTsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWlkaSA9IChvY3QgKyAxKSAqIDEyICsgbjsKICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZlID0gZmFsc2UsIG1heFZlbCA9IDA7CiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyhhY3RpdmVOb3RlcykuZm9yRWFjaChub3RlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3Rlc1ttaWRpXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFZlbCA9IE1hdGgubWF4KG1heFZlbCwgbm90ZXNbbWlkaV0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYnJpZ2h0ID0gTWF0aC5tYXgoMC4xNSwgb2N0IC8gMTApOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzYXQgPSBtYXhWZWwgLyAxMjc7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFtyLCBnLCBiXSA9IE5FV1RPTltuXTsKICAgICAgICAgICAgICAgICAgICAgICAgcGN0eC5maWxsU3R5bGUgPSBgcmdiKCR7cipicmlnaHQqc2F0ICsgMjU1KigxLXNhdCkqYnJpZ2h0fSwke2cqYnJpZ2h0KnNhdCArIDI1NSooMS1zYXQpKmJyaWdodH0sJHtiKmJyaWdodCpzYXQgKyAyNTUqKDEtc2F0KSpicmlnaHR9KWA7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGN0eC5maWxsU3R5bGUgPSAnI2ZmZmZmZic7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHBjdHguZmlsbFJlY3Qod2kgKiBrdywgMCwga3cgLSAxLCBoKTsKCiAgICAgICAgICAgICAgICAgICAgcGN0eC5zdHJva2VTdHlsZSA9ICdyZ2JhKDAsMCwwLDAuMyknOwogICAgICAgICAgICAgICAgICAgIHBjdHgubGluZVdpZHRoID0gMTsKICAgICAgICAgICAgICAgICAgICBwY3R4LnN0cm9rZVJlY3Qod2kgKiBrdywgMCwga3cgLSAxLCBoKTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKG4gPT09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGN0eC5maWxsU3R5bGUgPSAnIzk5OSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHBjdHguZm9udCA9ICc5cHggQXJpYWwnOwogICAgICAgICAgICAgICAgICAgICAgICBwY3R4LmZpbGxUZXh0KG9jdCwgd2kgKiBrdyArIDIsIGggLSA0KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHdpKys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIEJsYWNrIGtleXMKICAgICAgICAgICAgd2kgPSAwOwogICAgICAgICAgICBmb3IgKGxldCBvY3QgPSAwOyBvY3QgPD0gMTA7IG9jdCsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IDEyOyBuKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAob2N0ID09PSAxMCAmJiBuID4gMCkgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFbMSwgMywgNiwgOCwgMTBdLmluY2x1ZGVzKG4pKSB7IHdpKys7IGNvbnRpbnVlOyB9CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pZGkgPSAob2N0ICsgMSkgKiAxMiArIG47CiAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGl2ZSA9IGZhbHNlLCBtYXhWZWwgPSAwOwogICAgICAgICAgICAgICAgICAgIE9iamVjdC52YWx1ZXMoYWN0aXZlTm90ZXMpLmZvckVhY2gobm90ZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90ZXNbbWlkaV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhWZWwgPSBNYXRoLm1heChtYXhWZWwsIG5vdGVzW21pZGldKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJyaWdodCA9IE1hdGgubWF4KDAuMTUsIG9jdCAvIDEwKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2F0ID0gbWF4VmVsIC8gMTI3OwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBbciwgZywgYl0gPSBORVdUT05bbl07CiAgICAgICAgICAgICAgICAgICAgICAgIHBjdHguZmlsbFN0eWxlID0gYHJnYigke3IqYnJpZ2h0KnNhdCArIDI1NSooMS1zYXQpKmJyaWdodH0sJHtnKmJyaWdodCpzYXQgKyAyNTUqKDEtc2F0KSpicmlnaHR9LCR7YipicmlnaHQqc2F0ICsgMjU1KigxLXNhdCkqYnJpZ2h0fSlgOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBjdHguZmlsbFN0eWxlID0gJyMwMDAnOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBwY3R4LmZpbGxSZWN0KHdpICoga3cgLSBrdyAqIDAuMywgMCwga3cgKiAwLjYsIGggKiAwLjYpOwoKICAgICAgICAgICAgICAgICAgICBwY3R4LnN0cm9rZVN0eWxlID0gJ3JnYmEoMCwwLDAsMC41KSc7CiAgICAgICAgICAgICAgICAgICAgcGN0eC5saW5lV2lkdGggPSAxOwogICAgICAgICAgICAgICAgICAgIHBjdHguc3Ryb2tlUmVjdCh3aSAqIGt3IC0ga3cgKiAwLjMsIDAsIGt3ICogMC42LCBoICogMC42KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gQ29udHJvbHMKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kZUJ0bicpLm9uY2xpY2sgPSAoKSA9PiB7CiAgICAgICAgICAgIG1vZGUgPSBtb2RlID09PSAnbGFuZXMnID8gJ2xheWVycycgOiAnbGFuZXMnOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kZUJ0bicpLnRleHRDb250ZW50ID0gbW9kZSA9PT0gJ2xhbmVzJyA/ICfwn46a77iPIExhbmVzJyA6ICfwn46tIExheWVycyc7CiAgICAgICAgfTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2d1aWRlQnRuJykub25jbGljayA9ICgpID0+IHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2d1aWRlJykuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5nc0J0bicpLm9uY2xpY2sgPSAoKSA9PiB7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5ncycpLmNsYXNzTGlzdC50b2dnbGUoJ3Nob3cnKTsKICAgICAgICB9OwoKICAgICAgICAvLyBTZXR0aW5ncyBjb250cm9scwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXJ0aWNsZVNpemUnKS5vbmlucHV0ID0gKGUpID0+IHsKICAgICAgICAgICAgc2V0dGluZ3MucGFydGljbGVTaXplID0gcGFyc2VJbnQoZS50YXJnZXQudmFsdWUpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2l6ZVZhbHVlJykudGV4dENvbnRlbnQgPSBzZXR0aW5ncy5wYXJ0aWNsZVNpemU7CiAgICAgICAgfTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhcnRpY2xlTGlmZXRpbWUnKS5vbmlucHV0ID0gKGUpID0+IHsKICAgICAgICAgICAgc2V0dGluZ3MucGFydGljbGVMaWZldGltZSA9IHBhcnNlSW50KGUudGFyZ2V0LnZhbHVlKTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpZmV0aW1lVmFsdWUnKS50ZXh0Q29udGVudCA9IHNldHRpbmdzLnBhcnRpY2xlTGlmZXRpbWU7CiAgICAgICAgfTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21heFBhcnRpY2xlcycpLm9uaW5wdXQgPSAoZSkgPT4gewogICAgICAgICAgICBzZXR0aW5ncy5tYXhQYXJ0aWNsZXMgPSBwYXJzZUludChlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXhQYXJ0aWNsZXNWYWx1ZScpLnRleHRDb250ZW50ID0gc2V0dGluZ3MubWF4UGFydGljbGVzOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaG9yZFdpbmRvdycpLm9uaW5wdXQgPSAoZSkgPT4gewogICAgICAgICAgICBzZXR0aW5ncy5jaG9yZFdpbmRvdyA9IHBhcnNlSW50KGUudGFyZ2V0LnZhbHVlKTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nob3JkV2luZG93VmFsdWUnKS50ZXh0Q29udGVudCA9IHNldHRpbmdzLmNob3JkV2luZG93OwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaG9yZFBhZGRpbmcnKS5vbmlucHV0ID0gKGUpID0+IHsKICAgICAgICAgICAgc2V0dGluZ3MuY2hvcmRQYWRkaW5nID0gcGFyc2VJbnQoZS50YXJnZXQudmFsdWUpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hvcmRQYWRkaW5nVmFsdWUnKS50ZXh0Q29udGVudCA9IHNldHRpbmdzLmNob3JkUGFkZGluZzsKICAgICAgICB9OwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hvcmRPcGFjaXR5Jykub25pbnB1dCA9IChlKSA9PiB7CiAgICAgICAgICAgIHNldHRpbmdzLmNob3JkT3BhY2l0eSA9IHBhcnNlSW50KGUudGFyZ2V0LnZhbHVlKSAvIDEwMDsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nob3JkT3BhY2l0eVZhbHVlJykudGV4dENvbnRlbnQgPSBlLnRhcmdldC52YWx1ZSArICclJzsKICAgICAgICB9OwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmdUeXBlJykub25jaGFuZ2UgPSAoZSkgPT4gewogICAgICAgICAgICBzZXR0aW5ncy5iZ1R5cGUgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dyYWRpZW50U2V0dGluZ3MnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc29saWRTZXR0aW5ncycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGRpdGl2ZVNldHRpbmdzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChzZXR0aW5ncy5iZ1R5cGUgPT09ICdncmFkaWVudCcpIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdncmFkaWVudFNldHRpbmdzJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2V0dGluZ3MuYmdUeXBlID09PSAnc29saWQnKSB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc29saWRTZXR0aW5ncycpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICB9IGVsc2UgaWYgKHNldHRpbmdzLmJnVHlwZSA9PT0gJ2FkZGl0aXZlJykgewogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZGl0aXZlU2V0dGluZ3MnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cGRhdGVCYWNrZ3JvdW5kKCk7CiAgICAgICAgfTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JnT3BhY2l0eScpLm9uaW5wdXQgPSAoZSkgPT4gewogICAgICAgICAgICBzZXR0aW5ncy5iZ09wYWNpdHkgPSBwYXJzZUludChlLnRhcmdldC52YWx1ZSkgLyAxMDA7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiZ09wYWNpdHlWYWx1ZScpLnRleHRDb250ZW50ID0gZS50YXJnZXQudmFsdWUgKyAnJSc7CiAgICAgICAgICAgIHVwZGF0ZUJhY2tncm91bmQoKTsKICAgICAgICB9OwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ3JhZGllbnRUeXBlJykub25jaGFuZ2UgPSAoZSkgPT4gewogICAgICAgICAgICBzZXR0aW5ncy5ncmFkaWVudFR5cGUgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgICAgICAgaWYgKHNldHRpbmdzLmdyYWRpZW50VHlwZSA9PT0gJ2N1c3RvbScpIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b21HcmFkaWVudFNldHRpbmdzJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWl4ZXJHcmFkaWVudFNldHRpbmdzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b21HcmFkaWVudFNldHRpbmdzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXhlckdyYWRpZW50U2V0dGluZ3MnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cGRhdGVCYWNrZ3JvdW5kKCk7CiAgICAgICAgfTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JnR3JhZGllbnQnKS5vbmNoYW5nZSA9IChlKSA9PiB7CiAgICAgICAgICAgIHNldHRpbmdzLmJnR3JhZGllbnQgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgICAgICAgdXBkYXRlQmFja2dyb3VuZCgpOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdncmFkaWVudENvbG9yMScpLm9uaW5wdXQgPSAoZSkgPT4gewogICAgICAgICAgICBzZXR0aW5ncy5ncmFkaWVudENvbG9yMSA9IGUudGFyZ2V0LnZhbHVlOwogICAgICAgICAgICB1cGRhdGVCYWNrZ3JvdW5kKCk7CiAgICAgICAgfTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dyYWRpZW50Q29sb3IyJykub25pbnB1dCA9IChlKSA9PiB7CiAgICAgICAgICAgIHNldHRpbmdzLmdyYWRpZW50Q29sb3IyID0gZS50YXJnZXQudmFsdWU7CiAgICAgICAgICAgIHVwZGF0ZUJhY2tncm91bmQoKTsKICAgICAgICB9OwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWl4ZXJEaXJlY3Rpb24nKS5vbmNoYW5nZSA9IChlKSA9PiB7CiAgICAgICAgICAgIHNldHRpbmdzLm1peGVyRGlyZWN0aW9uID0gZS50YXJnZXQudmFsdWU7CiAgICAgICAgICAgIHVwZGF0ZUJhY2tncm91bmQoKTsKICAgICAgICB9OwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWl4ZXJDb2xvcjEnKS5vbmlucHV0ID0gKGUpID0+IHsKICAgICAgICAgICAgc2V0dGluZ3MubWl4ZXJDb2xvcjEgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgICAgICAgdXBkYXRlQmFja2dyb3VuZCgpOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXhlckNvbG9yMicpLm9uaW5wdXQgPSAoZSkgPT4gewogICAgICAgICAgICBzZXR0aW5ncy5taXhlckNvbG9yMiA9IGUudGFyZ2V0LnZhbHVlOwogICAgICAgICAgICB1cGRhdGVCYWNrZ3JvdW5kKCk7CiAgICAgICAgfTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21peFJhdGlvJykub25pbnB1dCA9IChlKSA9PiB7CiAgICAgICAgICAgIHNldHRpbmdzLm1peFJhdGlvID0gcGFyc2VJbnQoZS50YXJnZXQudmFsdWUpIC8gMTAwOwogICAgICAgICAgICBjb25zdCByYXRpbzEgPSBwYXJzZUludChlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIGNvbnN0IHJhdGlvMiA9IDEwMCAtIHJhdGlvMTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21peFJhdGlvVmFsdWUnKS50ZXh0Q29udGVudCA9IGAke3JhdGlvMX06JHtyYXRpbzJ9YDsKICAgICAgICAgICAgdXBkYXRlQmFja2dyb3VuZCgpOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb2xpZENvbG9yJykub25pbnB1dCA9IChlKSA9PiB7CiAgICAgICAgICAgIHNldHRpbmdzLnNvbGlkQ29sb3IgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgICAgICAgdXBkYXRlQmFja2dyb3VuZCgpOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYXNlQ29sb3JJbnRlbnNpdHknKS5vbmlucHV0ID0gKGUpID0+IHsKICAgICAgICAgICAgc2V0dGluZ3MuYmFzZUNvbG9ySW50ZW5zaXR5ID0gcGFyc2VJbnQoZS50YXJnZXQudmFsdWUpIC8gMTAwOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmFzZUNvbG9yVmFsdWUnKS50ZXh0Q29udGVudCA9IGUudGFyZ2V0LnZhbHVlICsgJyUnOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdHRhY2tTcGVlZCcpLm9uY2hhbmdlID0gKGUpID0+IHsKICAgICAgICAgICAgc2V0dGluZ3MuYXR0YWNrU3BlZWQgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F0dGFja1NwZWVkVmFsdWUnKS50ZXh0Q29udGVudCA9IAogICAgICAgICAgICAgICAgZS50YXJnZXQudmFsdWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBlLnRhcmdldC52YWx1ZS5zbGljZSgxKTsKICAgICAgICB9OwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVsZWFzZVRpbWUnKS5vbmlucHV0ID0gKGUpID0+IHsKICAgICAgICAgICAgc2V0dGluZ3MucmVsZWFzZVRpbWUgPSBwYXJzZUludChlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWxlYXNlVGltZVZhbHVlJykudGV4dENvbnRlbnQgPSBzZXR0aW5ncy5yZWxlYXNlVGltZTsKICAgICAgICB9OwoKICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZHJhdyk7CiAgICA8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cg==";
        const VISUALIZER_2_B64 = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+TmV3dG9uIE1JREkgLSBPc2NpbGxvc2NvcGU8L3RpdGxlPgogICAgPHN0eWxlPgogICAgICAgIEBpbXBvcnQgdXJsKCdodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2NzczI/ZmFtaWx5PVJvYm90bytNb25vOndnaHRAMzAwOzQwMDs2MDAmZGlzcGxheT1zd2FwJyk7CiAgICAgICAgCiAgICAgICAgKiB7IG1hcmdpbjogMDsgcGFkZGluZzogMDsgYm94LXNpemluZzogYm9yZGVyLWJveDsgfQogICAgICAgIGJvZHkgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMGEwYTBhOwogICAgICAgICAgICBmb250LWZhbWlseTogJ1JvYm90byBNb25vJywgbW9ub3NwYWNlOwogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgICAgICBjb2xvcjogIzAwZmYwMDsKICAgICAgICB9CiAgICAgICAgI2NvbnRhaW5lciB7CiAgICAgICAgICAgIHdpZHRoOiAxMDB2dzsKICAgICAgICAgICAgaGVpZ2h0OiAxMDB2aDsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICB9CiAgICAgICAgI2hlYWRlciB7CiAgICAgICAgICAgIHBhZGRpbmc6IDEycHggMjBweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLDIwLDAsMC45KTsKICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkICMwMGZmMDA7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgZmxleC13cmFwOiB3cmFwOwogICAgICAgICAgICBnYXA6IDEwcHg7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMCAyMHB4IHJnYmEoMCwyNTUsMCwwLjMpOwogICAgICAgIH0KICAgICAgICAjdGl0bGUgeyAKICAgICAgICAgICAgZm9udC1zaXplOiAyMHB4OyAKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsgCiAgICAgICAgICAgIGxldHRlci1zcGFjaW5nOiAzcHg7CiAgICAgICAgICAgIGNvbG9yOiAjMDBmZjAwOwogICAgICAgICAgICB0ZXh0LXNoYWRvdzogMCAwIDEwcHggIzAwZmYwMDsKICAgICAgICB9CiAgICAgICAgI2NvbnRyb2xzIHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgZ2FwOiAxMHB4OwogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgIH0KICAgICAgICAuYnRuIHsKICAgICAgICAgICAgcGFkZGluZzogOHB4IDE2cHg7CiAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkICMwMGZmMDA7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDA7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgZm9udC1zaXplOiAxMXB4OwogICAgICAgICAgICBmb250LXdlaWdodDogNjAwOwogICAgICAgICAgICBmb250LWZhbWlseTogJ1JvYm90byBNb25vJywgbW9ub3NwYWNlOwogICAgICAgICAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwogICAgICAgICAgICBsZXR0ZXItc3BhY2luZzogMXB4OwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4yczsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjUpOwogICAgICAgICAgICBjb2xvcjogIzAwZmYwMDsKICAgICAgICB9CiAgICAgICAgLmJ0bjpob3ZlciB7IAogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMDBmZjAwOwogICAgICAgICAgICBjb2xvcjogIzAwMDsKICAgICAgICAgICAgYm94LXNoYWRvdzogMCAwIDE1cHggIzAwZmYwMDsKICAgICAgICB9CiAgICAgICAgI3N0YXR1cyB7IAogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwwLDAsMC4zKTsgCiAgICAgICAgICAgIGNvbG9yOiAjZmYwMDAwOwogICAgICAgICAgICBib3JkZXItY29sb3I6ICNmZjAwMDA7CiAgICAgICAgfQogICAgICAgICNzdGF0dXMuY29ubmVjdGVkIHsgCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwyNTUsMCwwLjMpOyAKICAgICAgICAgICAgY29sb3I6ICMwMGZmMDA7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogIzAwZmYwMDsKICAgICAgICAgICAgYm94LXNoYWRvdzogMCAwIDEwcHggIzAwZmYwMDsKICAgICAgICB9CiAgICAgICAgI3Zpc3VhbENhbnZhcyB7CiAgICAgICAgICAgIGZsZXg6IDE7CiAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOwogICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzAwMDsKICAgICAgICB9CiAgICAgICAgI3BpYW5vQ29udGFpbmVyIHsKICAgICAgICAgICAgaGVpZ2h0OiAxODBweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLDIwLDAsMC41KTsKICAgICAgICAgICAgYm9yZGVyLXRvcDogMnB4IHNvbGlkICMwMGZmMDA7CiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgICAgICBwYWRkaW5nOiA1cHg7CiAgICAgICAgfQogICAgICAgICNjb2xvck1hcENhbnZhcywgI3BpYW5vQ2FudmFzIHsKICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7CiAgICAgICAgfQogICAgICAgICNpbmZvIHsKICAgICAgICAgICAgcGFkZGluZzogMTBweDsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgICAgICBmb250LXNpemU6IDEwcHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwyMCwwLDAuOSk7CiAgICAgICAgICAgIGJvcmRlci10b3A6IDJweCBzb2xpZCAjMDBmZjAwOwogICAgICAgICAgICBsZXR0ZXItc3BhY2luZzogMnB4OwogICAgICAgICAgICBjb2xvcjogIzAwZmYwMDsKICAgICAgICAgICAgdGV4dC1zaGFkb3c6IDAgMCA1cHggIzAwZmYwMDsKICAgICAgICB9CiAgICAgICAgI2d1aWRlLCAjc2V0dGluZ3MgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoNSwgMTAsIDUsIDAuOTgpOwogICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCAjMDBmZjAwOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAwOwogICAgICAgICAgICBwYWRkaW5nOiAyNXB4OwogICAgICAgICAgICB6LWluZGV4OiAxMDAwOwogICAgICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgMzBweCByZ2JhKDAsMjU1LDAsMC41KTsKICAgICAgICB9CiAgICAgICAgI2d1aWRlIHsKICAgICAgICAgICAgdG9wOiA1MCU7CiAgICAgICAgICAgIGxlZnQ6IDUwJTsKICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7CiAgICAgICAgICAgIG1heC13aWR0aDogNjAwcHg7CiAgICAgICAgICAgIG1heC1oZWlnaHQ6IDgwdmg7CiAgICAgICAgICAgIG92ZXJmbG93LXk6IGF1dG87CiAgICAgICAgfQogICAgICAgICNndWlkZS5zaG93LCAjc2V0dGluZ3Muc2hvdyB7IGRpc3BsYXk6IGJsb2NrOyB9CiAgICAgICAgI2d1aWRlIGgzLCAjc2V0dGluZ3MgaDMgeyAKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsgCiAgICAgICAgICAgIGNvbG9yOiAjMDBmZjAwOyAKICAgICAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKICAgICAgICAgICAgbGV0dGVyLXNwYWNpbmc6IDJweDsKICAgICAgICAgICAgdGV4dC1zaGFkb3c6IDAgMCAxMHB4ICMwMGZmMDA7CiAgICAgICAgfQogICAgICAgICNndWlkZSBwIHsgCiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7IAogICAgICAgICAgICBmb250LXNpemU6IDEycHg7IAogICAgICAgICAgICBsaW5lLWhlaWdodDogMS42OwogICAgICAgICAgICBjb2xvcjogIzAwZmYwMDsKICAgICAgICB9CiAgICAgICAgI2d1aWRlIC5jbG9zZSwgI3NldHRpbmdzIGJ1dHRvbiB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwyNTUsMCwwLjIpOwogICAgICAgICAgICBjb2xvcjogIzAwZmYwMDsKICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgIzAwZmYwMDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMDsKICAgICAgICAgICAgcGFkZGluZzogNnB4IDE0cHg7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgZm9udC1mYW1pbHk6ICdSb2JvdG8gTW9ubycsIG1vbm9zcGFjZTsKICAgICAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKICAgICAgICAgICAgbGV0dGVyLXNwYWNpbmc6IDFweDsKICAgICAgICB9CiAgICAgICAgI2d1aWRlIC5jbG9zZTpob3ZlciwgI3NldHRpbmdzIGJ1dHRvbjpob3ZlciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMwMGZmMDA7CiAgICAgICAgICAgIGNvbG9yOiAjMDAwOwogICAgICAgIH0KICAgICAgICAjZ3VpZGUgLmNsb3NlIHsgZmxvYXQ6IHJpZ2h0OyB9CiAgICAgICAgI3NldHRpbmdzIHsKICAgICAgICAgICAgdG9wOiA4MHB4OwogICAgICAgICAgICByaWdodDogMjBweDsKICAgICAgICAgICAgd2lkdGg6IDMyMHB4OwogICAgICAgICAgICBtYXgtaGVpZ2h0OiA4MHZoOwogICAgICAgICAgICBvdmVyZmxvdy15OiBhdXRvOwogICAgICAgIH0KICAgICAgICAuc2V0dGluZy1ncm91cCB7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7CiAgICAgICAgICAgIHBhZGRpbmctYm90dG9tOiAyMHB4OwogICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgcmdiYSgwLDI1NSwwLDAuMyk7CiAgICAgICAgfQogICAgICAgIC5zZXR0aW5nLWdyb3VwOmxhc3QtY2hpbGQgeyBib3JkZXItYm90dG9tOiBub25lOyB9CiAgICAgICAgLnNldHRpbmctbGFiZWwgewogICAgICAgICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgICAgICAgZm9udC1zaXplOiAxMHB4OwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA4cHg7CiAgICAgICAgICAgIGNvbG9yOiAjMDBmZjAwOwogICAgICAgICAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwogICAgICAgICAgICBsZXR0ZXItc3BhY2luZzogMXB4OwogICAgICAgIH0KICAgICAgICAuc2V0dGluZy1pbnB1dCB7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICBwYWRkaW5nOiA4cHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwyNTUsMCwwLjA1KTsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgwLDI1NSwwLDAuMyk7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDA7CiAgICAgICAgICAgIGNvbG9yOiAjMDBmZjAwOwogICAgICAgICAgICBmb250LXNpemU6IDExcHg7CiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAnUm9ib3RvIE1vbm8nLCBtb25vc3BhY2U7CiAgICAgICAgfQogICAgICAgIGlucHV0W3R5cGU9InJhbmdlIl0gewogICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgbWFyZ2luOiA1cHggMDsKICAgICAgICB9CiAgICAgICAgLnNldHRpbmctdmFsdWUgewogICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICAgICAgICAgIGZsb2F0OiByaWdodDsKICAgICAgICAgICAgZm9udC1zaXplOiAxMXB4OwogICAgICAgICAgICBjb2xvcjogIzAwZmYwMDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgICAgfQogICAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KICAgIDxkaXYgaWQ9ImNvbnRhaW5lciI+CiAgICAgICAgPGRpdiBpZD0iaGVhZGVyIj4KICAgICAgICAgICAgPGRpdiBpZD0idGl0bGUiPk9TQ0lMTE9TQ09QRTwvZGl2PgogICAgICAgICAgICA8ZGl2IGlkPSJjb250cm9scyI+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJzdGF0dXMiIGNsYXNzPSJidG4iPuKXjyBPRkZMSU5FPC9kaXY+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJndWlkZUJ0biIgY2xhc3M9ImJ0biI+R3VpZGU8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9InNldHRpbmdzQnRuIiBjbGFzcz0iYnRuIj5TZXR0aW5nczwvYnV0dG9uPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8Y2FudmFzIGlkPSJ2aXN1YWxDYW52YXMiPjwvY2FudmFzPgogICAgICAgIDxkaXYgaWQ9InBpYW5vQ29udGFpbmVyIj4KICAgICAgICAgICAgPGNhbnZhcyBpZD0iY29sb3JNYXBDYW52YXMiPjwvY2FudmFzPgogICAgICAgICAgICA8Y2FudmFzIGlkPSJwaWFub0NhbnZhcyI+PC9jYW52YXM+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBpZD0iaW5mbyI+CiAgICAgICAgICAgIDxzcGFuIGlkPSJ0cmFja0NvdW50Ij5OTyBTSUdOQUw8L3NwYW4+IOKAoiAKICAgICAgICAgICAgV0FWRUZPUk0gQU5BTFlTSVMg4oCiIAogICAgICAgICAgICBGUkVRVUVOQ1kgU1BFQ1RSVU0KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgaWQ9Imd1aWRlIj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJjbG9zZSIgb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2d1aWRlJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpIj7inJUgQ0xPU0U8L2J1dHRvbj4KICAgICAgICA8aDM+T1NDSUxMT1NDT1BFIE1PREU8L2gzPgogICAgICAgIDxwPjxzdHJvbmc+Q09OQ0VQVDo8L3N0cm9uZz4gVGhpcyB2aXN1YWxpemVyIHRyYW5zZm9ybXMgTUlESSBub3RlIGRhdGEgaW50byBvc2NpbGxvc2NvcGUtc3R5bGUgd2F2ZWZvcm1zLiBFYWNoIG5vdGUgZ2VuZXJhdGVzIGEgc2luZSB3YXZlIGF0IGl0cyBjb3JyZXNwb25kaW5nIGZyZXF1ZW5jeSwgY3JlYXRpbmcgYSByZWFsLXRpbWUgYXVkaW8gdmlzdWFsaXphdGlvbi48L3A+CiAgICAgICAgPHA+PHN0cm9uZz5XQVZFRk9STSBESVNQTEFZOjwvc3Ryb25nPiBFYWNoIHRyYWNrIGdldHMgaXRzIG93biBob3Jpem9udGFsIGxhbmUgd2l0aCBhIGNvbnRpbnVvdXNseSBzY3JvbGxpbmcgd2F2ZWZvcm0uIEFjdGl2ZSBub3RlcyBnZW5lcmF0ZSBzaW5lIHdhdmVzIHRoYXQgc3VtIHRvZ2V0aGVyLCBjcmVhdGluZyBjb21wbGV4IGludGVyZmVyZW5jZSBwYXR0ZXJucy48L3A+CiAgICAgICAgPHA+PHN0cm9uZz5DT0xPUiBNQVBQSU5HOjwvc3Ryb25nPiBXYXZlZm9ybXMgYXJlIGNvbG9yZWQgdXNpbmcgTmV3dG9uJ3MgY29sb3Igd2hlZWwgLSBlYWNoIG5vdGUgZnJlcXVlbmN5IGhhcyBpdHMgY29ycmVzcG9uZGluZyBjb2xvci4gV2hlbiBtdWx0aXBsZSBub3RlcyBwbGF5IHRvZ2V0aGVyLCB0aGVpciBjb2xvcnMgbWl4IGFkZGl0aXZlbHkuPC9wPgogICAgICAgIDxwPjxzdHJvbmc+VEVDSE5JQ0FMOjwvc3Ryb25nPiBUaGUgYW1wbGl0dWRlIG9mIGVhY2ggc2luZSB3YXZlIGlzIGRldGVybWluZWQgYnkgTUlESSB2ZWxvY2l0eS4gRnJlcXVlbmN5IGlzIGNhbGN1bGF0ZWQgZnJvbSBNSURJIG5vdGUgbnVtYmVyIChBNCA9IDQ0MEh6KS4gV2F2ZXMgc2Nyb2xsIGZyb20gcmlnaHQgdG8gbGVmdCBpbiByZWFsLXRpbWUuPC9wPgogICAgICAgIDxociBzdHlsZT0ibWFyZ2luOiAxNXB4IDA7IGJvcmRlci1jb2xvcjogIzAwZmYwMDsiPgogICAgICAgIDxwPjxzdHJvbmc+TUlESSBTRVRVUDo8L3N0cm9uZz48L3A+CiAgICAgICAgPHA+MS4gQ29uZmlndXJlIElBQyBidXNlcyBpbiBBdWRpbyBNSURJIFNldHVwPC9wPgogICAgICAgIDxwPjIuIFJvdXRlIGVhY2ggdHJhY2sgdG8gYSBkaWZmZXJlbnQgYnVzPC9wPgogICAgICAgIDxwPjMuIFdhdGNoIHlvdXIgbXVzaWMgYmVjb21lIHdhdmVmb3JtczwvcD4KICAgIDwvZGl2PgoKICAgIDxkaXYgaWQ9InNldHRpbmdzIj4KICAgICAgICA8aDM+U0VUVElOR1M8L2gzPgogICAgICAgIAogICAgICAgIDxkaXYgY2xhc3M9InNldHRpbmctZ3JvdXAiPgogICAgICAgICAgICA8bGFiZWwgY2xhc3M9InNldHRpbmctbGFiZWwiPgogICAgICAgICAgICAgICAgV2F2ZWZvcm0gU3BlZWQKICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzZXR0aW5nLXZhbHVlIiBpZD0ic3BlZWRWYWx1ZSI+ODwvc3Bhbj4KICAgICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBpZD0id2F2ZVNwZWVkIiBtaW49IjEiIG1heD0iNTAiIHZhbHVlPSI4IiBjbGFzcz0ic2V0dGluZy1pbnB1dCI+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9InNldHRpbmctZ3JvdXAiPgogICAgICAgICAgICA8bGFiZWwgY2xhc3M9InNldHRpbmctbGFiZWwiPgogICAgICAgICAgICAgICAgQW1wbGl0dWRlIFNjYWxlCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2V0dGluZy12YWx1ZSIgaWQ9ImFtcGxpdHVkZVZhbHVlIj4wLjg8L3NwYW4+CiAgICAgICAgICAgIDwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgaWQ9ImFtcGxpdHVkZSIgbWluPSIwLjIiIG1heD0iMS41IiBzdGVwPSIwLjEiIHZhbHVlPSIwLjgiIGNsYXNzPSJzZXR0aW5nLWlucHV0Ij4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBjbGFzcz0ic2V0dGluZy1ncm91cCI+CiAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic2V0dGluZy1sYWJlbCI+CiAgICAgICAgICAgICAgICBMaW5lIFRoaWNrbmVzcwogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNldHRpbmctdmFsdWUiIGlkPSJ0aGlja25lc3NWYWx1ZSI+Mjwvc3Bhbj4KICAgICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBpZD0ibGluZVRoaWNrbmVzcyIgbWluPSIxIiBtYXg9IjUiIHZhbHVlPSIyIiBjbGFzcz0ic2V0dGluZy1pbnB1dCI+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9InNldHRpbmctZ3JvdXAiPgogICAgICAgICAgICA8bGFiZWwgY2xhc3M9InNldHRpbmctbGFiZWwiPgogICAgICAgICAgICAgICAgR2xvdyBJbnRlbnNpdHkKICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzZXR0aW5nLXZhbHVlIiBpZD0iZ2xvd1ZhbHVlIj4xNTwvc3Bhbj4KICAgICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBpZD0iZ2xvd0ludGVuc2l0eSIgbWluPSIwIiBtYXg9IjMwIiB2YWx1ZT0iMTUiIGNsYXNzPSJzZXR0aW5nLWlucHV0Ij4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBjbGFzcz0ic2V0dGluZy1ncm91cCI+CiAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic2V0dGluZy1sYWJlbCI+CiAgICAgICAgICAgICAgICBXYXZlIERlY2F5CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2V0dGluZy12YWx1ZSIgaWQ9ImRlY2F5VmFsdWUiPjUwMG1zPC9zcGFuPgogICAgICAgICAgICA8L2xhYmVsPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGlkPSJ3YXZlRGVjYXkiIG1pbj0iMTAwIiBtYXg9IjIwMDAiIHN0ZXA9IjEwMCIgdmFsdWU9IjUwMCIgY2xhc3M9InNldHRpbmctaW5wdXQiPgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJzZXR0aW5nLWdyb3VwIj4KICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJzZXR0aW5nLWxhYmVsIj4KICAgICAgICAgICAgICAgIEdyaWQgRGlzcGxheQogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNldHRpbmctdmFsdWUiIGlkPSJncmlkVmFsdWUiPk9uPC9zcGFuPgogICAgICAgICAgICA8L2xhYmVsPgogICAgICAgICAgICA8c2VsZWN0IGlkPSJncmlkRGlzcGxheSIgY2xhc3M9InNldHRpbmctaW5wdXQiPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ib24iIHNlbGVjdGVkPk9uPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJvZmYiPk9mZjwvb3B0aW9uPgogICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBjbGFzcz0ic2V0dGluZy1ncm91cCI+CiAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic2V0dGluZy1sYWJlbCI+CiAgICAgICAgICAgICAgICBDb2xvciBNb2RlCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2V0dGluZy12YWx1ZSIgaWQ9ImNvbG9yVmFsdWUiPk5ld3Rvbjwvc3Bhbj4KICAgICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgICAgPHNlbGVjdCBpZD0iY29sb3JNb2RlIiBjbGFzcz0ic2V0dGluZy1pbnB1dCI+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJuZXd0b24iIHNlbGVjdGVkPk5ld3RvbiBTcGVjdHJ1bTwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iZ3JlZW4iPkNsYXNzaWMgR3JlZW48L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Im1peGVkIj5NaXhlZCBDb2xvcnM8L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxidXR0b24gb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpIiBzdHlsZT0id2lkdGg6IDEwMCU7IHBhZGRpbmc6IDEwcHg7IG1hcmdpbi10b3A6IDEwcHg7Ij4KICAgICAgICAgICAg4pyTIEFQUExZCiAgICAgICAgPC9idXR0b24+CiAgICA8L2Rpdj4KCiAgICA8c2NyaXB0PgogICAgICAgIC8vIE5ld3RvbidzIGNvbG9yIHdoZWVsCiAgICAgICAgY29uc3QgTkVXVE9OID0gWwogICAgICAgICAgICBbMTQ4LCAwLCAyMTFdLCAgICAvLyBDIC0gVmlvbGV0CiAgICAgICAgICAgIFsyMDQsIDAsIDEwMl0sICAgIC8vIEMjIC0gUmVkLXZpb2xldAogICAgICAgICAgICBbMjU1LCAwLCAwXSwgICAgICAvLyBEIC0gUmVkCiAgICAgICAgICAgIFsyNTUsIDY5LCAwXSwgICAgIC8vIEQjIC0gUmVkLW9yYW5nZQogICAgICAgICAgICBbMjU1LCAxNDAsIDBdLCAgICAvLyBFIC0gT3JhbmdlCiAgICAgICAgICAgIFsyNTUsIDI1NSwgMF0sICAgIC8vIEYgLSBZZWxsb3cKICAgICAgICAgICAgWzEyNywgMjU1LCAwXSwgICAgLy8gRiMgLSBZZWxsb3ctZ3JlZW4KICAgICAgICAgICAgWzAsIDI1NSwgMF0sICAgICAgLy8gRyAtIEdyZWVuCiAgICAgICAgICAgIFswLCAxMjgsIDI1NV0sICAgIC8vIEcjIC0gQ3lhbgogICAgICAgICAgICBbMCwgMCwgMjU1XSwgICAgICAvLyBBIC0gQmx1ZQogICAgICAgICAgICBbNzUsIDAsIDEzMF0sICAgICAvLyBBIyAtIEluZGlnbwogICAgICAgICAgICBbMTM5LCAwLCAyNTVdICAgICAvLyBCIC0gVmlvbGV0CiAgICAgICAgXTsKCiAgICAgICAgLy8gU3RhdGUKICAgICAgICBsZXQgZGV2aWNlcyA9IFtdOwogICAgICAgIGxldCBhY3RpdmVOb3RlcyA9IHt9OwogICAgICAgIGxldCB3YXZlZm9ybURhdGEgPSB7fTsKICAgICAgICBsZXQgbGFzdEZyYW1lID0gMDsKICAgICAgICBsZXQgc2Nyb2xsT2Zmc2V0ID0gMDsgLy8gSG9yaXpvbnRhbCBzY3JvbGwgcG9zaXRpb24KICAgICAgICAKICAgICAgICAvLyBTZXR0aW5ncwogICAgICAgIGxldCBzZXR0aW5ncyA9IHsKICAgICAgICAgICAgd2F2ZVNwZWVkOiA4LAogICAgICAgICAgICBhbXBsaXR1ZGU6IDAuOCwKICAgICAgICAgICAgbGluZVRoaWNrbmVzczogMiwKICAgICAgICAgICAgZ2xvd0ludGVuc2l0eTogMTUsCiAgICAgICAgICAgIHdhdmVEZWNheTogNTAwLAogICAgICAgICAgICBncmlkRGlzcGxheTogJ29uJywKICAgICAgICAgICAgY29sb3JNb2RlOiAnbmV3dG9uJwogICAgICAgIH07CgogICAgICAgIC8vIENhbnZhcwogICAgICAgIGNvbnN0IHZjID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Zpc3VhbENhbnZhcycpOwogICAgICAgIGNvbnN0IHZjdHggPSB2Yy5nZXRDb250ZXh0KCcyZCcsIHsgYWxwaGE6IGZhbHNlIH0pOwogICAgICAgIGNvbnN0IGNtYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb2xvck1hcENhbnZhcycpOwogICAgICAgIGNvbnN0IGNtY3R4ID0gY21jLmdldENvbnRleHQoJzJkJyk7CiAgICAgICAgY29uc3QgcGMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGlhbm9DYW52YXMnKTsKICAgICAgICBjb25zdCBwY3R4ID0gcGMuZ2V0Q29udGV4dCgnMmQnKTsKCiAgICAgICAgZnVuY3Rpb24gcmVzaXplKCkgewogICAgICAgICAgICB2Yy53aWR0aCA9IHZjLm9mZnNldFdpZHRoOwogICAgICAgICAgICB2Yy5oZWlnaHQgPSB2Yy5vZmZzZXRIZWlnaHQ7CiAgICAgICAgICAgIGNtYy53aWR0aCA9IDEwMDA7CiAgICAgICAgICAgIGNtYy5oZWlnaHQgPSA0NTsKICAgICAgICAgICAgcGMud2lkdGggPSAxMDAwOwogICAgICAgICAgICBwYy5oZWlnaHQgPSAxMjA7CiAgICAgICAgfQogICAgICAgIHJlc2l6ZSgpOwogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemUpOwoKICAgICAgICAvLyBDb252ZXJ0IE1JREkgbm90ZSB0byBmcmVxdWVuY3kgKEE0ID0gNDQwSHopCiAgICAgICAgZnVuY3Rpb24gbWlkaVRvRnJlcShtaWRpKSB7CiAgICAgICAgICAgIHJldHVybiA0NDAgKiBNYXRoLnBvdygyLCAobWlkaSAtIDY5KSAvIDEyKTsKICAgICAgICB9CgogICAgICAgIC8vIE1JREkKICAgICAgICBpZiAobmF2aWdhdG9yLnJlcXVlc3RNSURJQWNjZXNzKSB7CiAgICAgICAgICAgIG5hdmlnYXRvci5yZXF1ZXN0TUlESUFjY2VzcygpLnRoZW4oYWNjZXNzID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0cyA9IEFycmF5LmZyb20oYWNjZXNzLmlucHV0cy52YWx1ZXMoKSk7CiAgICAgICAgICAgICAgICBkZXZpY2VzID0gaW5wdXRzOwoKICAgICAgICAgICAgICAgIGlmIChpbnB1dHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGF0dXMnKS50ZXh0Q29udGVudCA9IGDinJMgT05MSU5FYDsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdHVzJykuY2xhc3NMaXN0LmFkZCgnY29ubmVjdGVkJyk7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyYWNrQ291bnQnKS50ZXh0Q29udGVudCA9IGAke2lucHV0cy5sZW5ndGh9IFRSQUNLKFMpIEFDVElWRWA7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaW5wdXRzLmZvckVhY2goKGlucHV0LCBpZHgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlTm90ZXNbaWR4XSA9IHt9OwogICAgICAgICAgICAgICAgICAgICAgICB3YXZlZm9ybURhdGFbaWR4XSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBoYXNlOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90ZXM6IFtdCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0Lm9ubWlkaW1lc3NhZ2UgPSAobSkgPT4gbWlkaShtLCBpZHgpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIG1pZGkobXNnLCBpZHgpIHsKICAgICAgICAgICAgY29uc3QgW2NtZCwgbm90ZSwgdmVsXSA9IG1zZy5kYXRhOwogICAgICAgICAgICBjb25zdCBvbiA9IGNtZCA+PSAxNDQgJiYgY21kIDw9IDE1OSAmJiB2ZWwgPiAwOwogICAgICAgICAgICBjb25zdCBvZmYgPSAoY21kID49IDEyOCAmJiBjbWQgPD0gMTQzKSB8fCAoY21kID49IDE0NCAmJiBjbWQgPD0gMTU5ICYmIHZlbCA9PT0gMCk7CgogICAgICAgICAgICBpZiAob24pIHsKICAgICAgICAgICAgICAgIGFjdGl2ZU5vdGVzW2lkeF1bbm90ZV0gPSB2ZWw7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNvbnN0IGZyZXEgPSBtaWRpVG9GcmVxKG5vdGUpOwogICAgICAgICAgICAgICAgY29uc3QgbiA9IG5vdGUgJSAxMjsKICAgICAgICAgICAgICAgIGNvbnN0IFtyLCBnLCBiXSA9IE5FV1RPTltuXTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gQWRkIG9yIHVwZGF0ZSBub3RlIGluIHdhdmVmb3JtIGRhdGEKICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nTm90ZSA9IHdhdmVmb3JtRGF0YVtpZHhdLm5vdGVzLmZpbmQobiA9PiBuLm1pZGkgPT09IG5vdGUpOwogICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nTm90ZSkgewogICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nTm90ZS52ZWxvY2l0eSA9IHZlbDsKICAgICAgICAgICAgICAgICAgICBleGlzdGluZ05vdGUudGltZXN0YW1wID0gRGF0ZS5ub3coKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgd2F2ZWZvcm1EYXRhW2lkeF0ubm90ZXMucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgIG1pZGk6IG5vdGUsCiAgICAgICAgICAgICAgICAgICAgICAgIGZyZXE6IGZyZXEsCiAgICAgICAgICAgICAgICAgICAgICAgIHZlbG9jaXR5OiB2ZWwsCiAgICAgICAgICAgICAgICAgICAgICAgIHI6IHIsCiAgICAgICAgICAgICAgICAgICAgICAgIGc6IGcsCiAgICAgICAgICAgICAgICAgICAgICAgIGI6IGIsCiAgICAgICAgICAgICAgICAgICAgICAgIHBoYXNlOiAwLAogICAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICB9IGVsc2UgaWYgKG9mZikgewogICAgICAgICAgICAgICAgZGVsZXRlIGFjdGl2ZU5vdGVzW2lkeF1bbm90ZV07CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIE1hcmsgbm90ZSBmb3IgZGVjYXkKICAgICAgICAgICAgICAgIGNvbnN0IG5vdGVEYXRhID0gd2F2ZWZvcm1EYXRhW2lkeF0ubm90ZXMuZmluZChuID0+IG4ubWlkaSA9PT0gbm90ZSk7CiAgICAgICAgICAgICAgICBpZiAobm90ZURhdGEpIHsKICAgICAgICAgICAgICAgICAgICBub3RlRGF0YS5yZWxlYXNlVGltZSA9IERhdGUubm93KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGRyYXdHcmlkKHksIGgpIHsKICAgICAgICAgICAgaWYgKHNldHRpbmdzLmdyaWREaXNwbGF5ID09PSAnb2ZmJykgcmV0dXJuOwogICAgICAgICAgICAKICAgICAgICAgICAgdmN0eC5zdHJva2VTdHlsZSA9ICdyZ2JhKDAsIDI1NSwgMCwgMC4xKSc7CiAgICAgICAgICAgIHZjdHgubGluZVdpZHRoID0gMTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIEhvcml6b250YWwgY2VudGVyIGxpbmUKICAgICAgICAgICAgdmN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgdmN0eC5tb3ZlVG8oMCwgeSArIGggLyAyKTsKICAgICAgICAgICAgdmN0eC5saW5lVG8odmMud2lkdGgsIHkgKyBoIC8gMik7CiAgICAgICAgICAgIHZjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBWZXJ0aWNhbCB0aW1lIG1hcmtlcnMKICAgICAgICAgICAgY29uc3Qgc3BhY2luZyA9IDUwOwogICAgICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHZjLndpZHRoOyB4ICs9IHNwYWNpbmcpIHsKICAgICAgICAgICAgICAgIHZjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgICAgICAgICB2Y3R4Lm1vdmVUbyh4LCB5KTsKICAgICAgICAgICAgICAgIHZjdHgubGluZVRvKHgsIHkgKyBoKTsKICAgICAgICAgICAgICAgIHZjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFF1YXJ0ZXIgYW5kIHRocmVlLXF1YXJ0ZXIgbGluZXMKICAgICAgICAgICAgdmN0eC5zdHJva2VTdHlsZSA9ICdyZ2JhKDAsIDI1NSwgMCwgMC4wNSknOwogICAgICAgICAgICB2Y3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICB2Y3R4Lm1vdmVUbygwLCB5ICsgaCAvIDQpOwogICAgICAgICAgICB2Y3R4LmxpbmVUbyh2Yy53aWR0aCwgeSArIGggLyA0KTsKICAgICAgICAgICAgdmN0eC5tb3ZlVG8oMCwgeSArIDMgKiBoIC8gNCk7CiAgICAgICAgICAgIHZjdHgubGluZVRvKHZjLndpZHRoLCB5ICsgMyAqIGggLyA0KTsKICAgICAgICAgICAgdmN0eC5zdHJva2UoKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGRyYXdXYXZlZm9ybSh0cmFja0lkeCwgeSwgaCwgZHQpIHsKICAgICAgICAgICAgY29uc3QgZGF0YSA9IHdhdmVmb3JtRGF0YVt0cmFja0lkeF07CiAgICAgICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBDbGVhbiB1cCBvbGQgbm90ZXMKICAgICAgICAgICAgZGF0YS5ub3RlcyA9IGRhdGEubm90ZXMuZmlsdGVyKG5vdGUgPT4gewogICAgICAgICAgICAgICAgaWYgKCFub3RlLnJlbGVhc2VUaW1lKSByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIHJldHVybiAobm93IC0gbm90ZS5yZWxlYXNlVGltZSkgPCBzZXR0aW5ncy53YXZlRGVjYXk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGRhdGEubm90ZXMubGVuZ3RoID09PSAwKSByZXR1cm47CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBDYWxjdWxhdGUgd2F2ZWZvcm0gcG9pbnRzIHdpdGggaG9yaXpvbnRhbCBzY3JvbGxpbmcKICAgICAgICAgICAgY29uc3QgcG9pbnRzID0gW107CiAgICAgICAgICAgIGNvbnN0IG51bVBvaW50cyA9IHZjLndpZHRoOwogICAgICAgICAgICBjb25zdCBjZW50ZXJZID0geSArIGggLyAyOwogICAgICAgICAgICAKICAgICAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBudW1Qb2ludHM7IHgrKykgewogICAgICAgICAgICAgICAgbGV0IHN1bSA9IDA7CiAgICAgICAgICAgICAgICBsZXQgY29sb3JTdW0gPSBbMCwgMCwgMF07CiAgICAgICAgICAgICAgICBsZXQgdG90YWxXZWlnaHQgPSAwOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBkYXRhLm5vdGVzLmZvckVhY2gobm90ZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGRlY2F5IGlmIG5vdGUgaXMgcmVsZWFzZWQKICAgICAgICAgICAgICAgICAgICBsZXQgYW1wbGl0dWRlID0gbm90ZS52ZWxvY2l0eSAvIDEyNyAqIHNldHRpbmdzLmFtcGxpdHVkZTsKICAgICAgICAgICAgICAgICAgICBpZiAobm90ZS5yZWxlYXNlVGltZSkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0aW1lU2luY2VSZWxlYXNlID0gbm93IC0gbm90ZS5yZWxlYXNlVGltZTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVjYXlGYWN0b3IgPSAxIC0gKHRpbWVTaW5jZVJlbGVhc2UgLyBzZXR0aW5ncy53YXZlRGVjYXkpOwogICAgICAgICAgICAgICAgICAgICAgICBhbXBsaXR1ZGUgKj0gTWF0aC5tYXgoMCwgZGVjYXlGYWN0b3IpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgcGhhc2Ugd2l0aCBob3Jpem9udGFsIHNjcm9sbGluZyBvZmZzZXQKICAgICAgICAgICAgICAgICAgICBjb25zdCBzY3JvbGxQaGFzZSA9IHNjcm9sbE9mZnNldCAqIDAuMDE7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgeFBoYXNlID0gKHggLyB2Yy53aWR0aCkgKiBNYXRoLlBJICogODsgLy8gOCB3YXZlbGVuZ3RocyBhY3Jvc3Mgc2NyZWVuCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhhc2UgPSBub3RlLnBoYXNlICsgeFBoYXNlICsgc2Nyb2xsUGhhc2U7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2F2ZSA9IE1hdGguc2luKHBoYXNlKSAqIGFtcGxpdHVkZTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBzdW0gKz0gd2F2ZTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBNaXggY29sb3JzIGJhc2VkIG9uIGFtcGxpdHVkZQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHdlaWdodCA9IE1hdGguYWJzKHdhdmUpOwogICAgICAgICAgICAgICAgICAgIGNvbG9yU3VtWzBdICs9IG5vdGUuciAqIHdlaWdodDsKICAgICAgICAgICAgICAgICAgICBjb2xvclN1bVsxXSArPSBub3RlLmcgKiB3ZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgY29sb3JTdW1bMl0gKz0gbm90ZS5iICogd2VpZ2h0OwogICAgICAgICAgICAgICAgICAgIHRvdGFsV2VpZ2h0ICs9IHdlaWdodDsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBOb3JtYWxpemUgY29sb3IKICAgICAgICAgICAgICAgIGlmICh0b3RhbFdlaWdodCA+IDApIHsKICAgICAgICAgICAgICAgICAgICBjb2xvclN1bVswXSAvPSB0b3RhbFdlaWdodDsKICAgICAgICAgICAgICAgICAgICBjb2xvclN1bVsxXSAvPSB0b3RhbFdlaWdodDsKICAgICAgICAgICAgICAgICAgICBjb2xvclN1bVsyXSAvPSB0b3RhbFdlaWdodDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goewogICAgICAgICAgICAgICAgICAgIHg6IHgsCiAgICAgICAgICAgICAgICAgICAgeTogY2VudGVyWSArIHN1bSAqIChoIC8gMikgKiAwLjksCiAgICAgICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yU3VtCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLy8gRHJhdyB3YXZlZm9ybQogICAgICAgICAgICBpZiAocG9pbnRzLmxlbmd0aCA8IDIpIHJldHVybjsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIEFwcGx5IGdsb3cgaWYgZW5hYmxlZAogICAgICAgICAgICBpZiAoc2V0dGluZ3MuZ2xvd0ludGVuc2l0eSA+IDApIHsKICAgICAgICAgICAgICAgIHZjdHguc2hhZG93Qmx1ciA9IHNldHRpbmdzLmdsb3dJbnRlbnNpdHk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHZjdHgubGluZVdpZHRoID0gc2V0dGluZ3MubGluZVRoaWNrbmVzczsKICAgICAgICAgICAgdmN0eC5saW5lQ2FwID0gJ3JvdW5kJzsKICAgICAgICAgICAgdmN0eC5saW5lSm9pbiA9ICdyb3VuZCc7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBEcmF3IGxpbmUgc2VnbWVudHMgd2l0aCBjb2xvciBpbnRlcnBvbGF0aW9uCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcG9pbnRzLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcDEgPSBwb2ludHNbaV07CiAgICAgICAgICAgICAgICBjb25zdCBwMiA9IHBvaW50c1tpICsgMV07CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIFVzZSBjb2xvciBmcm9tIGN1cnJlbnQgcG9pbnQKICAgICAgICAgICAgICAgIGxldCBjb2xvcjsKICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5jb2xvck1vZGUgPT09ICdncmVlbicpIHsKICAgICAgICAgICAgICAgICAgICBjb2xvciA9ICdyZ2IoMCwgMjU1LCAwKSc7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNldHRpbmdzLmNvbG9yTW9kZSA9PT0gJ25ld3RvbicpIHsKICAgICAgICAgICAgICAgICAgICBjb2xvciA9IGByZ2IoJHtNYXRoLnJvdW5kKHAxLmNvbG9yWzBdKX0sICR7TWF0aC5yb3VuZChwMS5jb2xvclsxXSl9LCAke01hdGgucm91bmQocDEuY29sb3JbMl0pfSlgOwogICAgICAgICAgICAgICAgfSBlbHNlIHsgLy8gbWl4ZWQKICAgICAgICAgICAgICAgICAgICBjb25zdCBhdmcgPSAocDEuY29sb3JbMF0gKyBwMS5jb2xvclsxXSArIHAxLmNvbG9yWzJdKSAvIDM7CiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBgcmdiKCR7TWF0aC5yb3VuZChwMS5jb2xvclswXSAqIDAuNyArIGF2ZyAqIDAuMyl9LCAke01hdGgucm91bmQocDEuY29sb3JbMV0gKiAwLjcgKyBhdmcgKiAwLjMpfSwgJHtNYXRoLnJvdW5kKHAxLmNvbG9yWzJdICogMC43ICsgYXZnICogMC4zKX0pYDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmN0eC5zdHJva2VTdHlsZSA9IGNvbG9yOwogICAgICAgICAgICAgICAgdmN0eC5zaGFkb3dDb2xvciA9IGNvbG9yOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2Y3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgdmN0eC5tb3ZlVG8ocDEueCwgcDEueSk7CiAgICAgICAgICAgICAgICB2Y3R4LmxpbmVUbyhwMi54LCBwMi55KTsKICAgICAgICAgICAgICAgIHZjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHZjdHguc2hhZG93Qmx1ciA9IDA7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBVcGRhdGUgcGhhc2UgYmFzZWQgb24gZnJlcXVlbmN5CiAgICAgICAgICAgIGRhdGEubm90ZXMuZm9yRWFjaChub3RlID0+IHsKICAgICAgICAgICAgICAgIC8vIFBoYXNlIGFkdmFuY2VzIGJhc2VkIG9uIG5vdGUgZnJlcXVlbmN5IGZvciBwcm9wZXIgb3NjaWxsYXRpb24KICAgICAgICAgICAgICAgIG5vdGUucGhhc2UgKz0gZHQgKiAwLjAwMSAqIG5vdGUuZnJlcSAqIDAuMDI7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZHJhdyh0aW1lKSB7CiAgICAgICAgICAgIGNvbnN0IGR0ID0gdGltZSAtIGxhc3RGcmFtZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChkdCA8IDE2KSB7IC8vIH42MGZwcwogICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGRyYXcpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxhc3RGcmFtZSA9IHRpbWU7CgogICAgICAgICAgICAvLyBVcGRhdGUgc2Nyb2xsIG9mZnNldCBmb3IgaG9yaXpvbnRhbCBtb3ZlbWVudAogICAgICAgICAgICBzY3JvbGxPZmZzZXQgKz0gZHQgKiBzZXR0aW5ncy53YXZlU3BlZWQgKiAwLjE7CgogICAgICAgICAgICAvLyBDbGVhciBiYWNrZ3JvdW5kCiAgICAgICAgICAgIHZjdHguZmlsbFN0eWxlID0gJyMwMDAwMDAnOwogICAgICAgICAgICB2Y3R4LmZpbGxSZWN0KDAsIDAsIHZjLndpZHRoLCB2Yy5oZWlnaHQpOwoKICAgICAgICAgICAgY29uc3QgbiA9IE9iamVjdC5rZXlzKHdhdmVmb3JtRGF0YSkubGVuZ3RoIHx8IDE7CiAgICAgICAgICAgIGNvbnN0IGggPSB2Yy5oZWlnaHQgLyBuOwoKICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMod2F2ZWZvcm1EYXRhKS5mb3JFYWNoKChbaWR4LCBkYXRhXSwgaSkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgbHkgPSBpICogaDsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gRHJhdyBncmlkCiAgICAgICAgICAgICAgICBkcmF3R3JpZChseSwgaCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIERyYXcgbGFuZSBzZXBhcmF0b3IKICAgICAgICAgICAgICAgIHZjdHguc3Ryb2tlU3R5bGUgPSAncmdiYSgwLCAyNTUsIDAsIDAuMyknOwogICAgICAgICAgICAgICAgdmN0eC5saW5lV2lkdGggPSAyOwogICAgICAgICAgICAgICAgdmN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgIHZjdHgubW92ZVRvKDAsIGx5KTsKICAgICAgICAgICAgICAgIHZjdHgubGluZVRvKHZjLndpZHRoLCBseSk7CiAgICAgICAgICAgICAgICB2Y3R4LnN0cm9rZSgpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBEcmF3IHdhdmVmb3JtCiAgICAgICAgICAgICAgICBkcmF3V2F2ZWZvcm0oaWR4LCBseSwgaCwgZHQpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBUcmFjayBsYWJlbAogICAgICAgICAgICAgICAgdmN0eC5maWxsU3R5bGUgPSAncmdiYSgwLCAyNTUsIDAsIDAuNiknOwogICAgICAgICAgICAgICAgdmN0eC5mb250ID0gJzEycHggUm9ib3RvIE1vbm8nOwogICAgICAgICAgICAgICAgdmN0eC5zaGFkb3dDb2xvciA9ICcjMDBmZjAwJzsKICAgICAgICAgICAgICAgIHZjdHguc2hhZG93Qmx1ciA9IDU7CiAgICAgICAgICAgICAgICB2Y3R4LmZpbGxUZXh0KGBUUkFDSyAke3BhcnNlSW50KGlkeCkgKyAxfWAsIDEwLCBseSArIDIwKTsKICAgICAgICAgICAgICAgIHZjdHguc2hhZG93Qmx1ciA9IDA7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIERpc3BsYXkgYWN0aXZlIG5vdGVzIGluZm8KICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUNvdW50ID0gT2JqZWN0LmtleXMoYWN0aXZlTm90ZXNbaWR4XSB8fCB7fSkubGVuZ3RoOwogICAgICAgICAgICAgICAgaWYgKGFjdGl2ZUNvdW50ID4gMCkgewogICAgICAgICAgICAgICAgICAgIHZjdHguZmlsbFN0eWxlID0gJ3JnYmEoMCwgMjU1LCAwLCAwLjQpJzsKICAgICAgICAgICAgICAgICAgICB2Y3R4LmZvbnQgPSAnMTBweCBSb2JvdG8gTW9ubyc7CiAgICAgICAgICAgICAgICAgICAgdmN0eC5maWxsVGV4dChgJHthY3RpdmVDb3VudH0gTk9URSR7YWN0aXZlQ291bnQgIT09IDEgPyAnUycgOiAnJ31gLCAxMCwgbHkgKyAzNSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgZHJhd0NvbG9yTWFwKCk7CiAgICAgICAgICAgIGRyYXdQaWFubygpOwogICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZHJhdyk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBkcmF3Q29sb3JNYXAoKSB7CiAgICAgICAgICAgIGNtY3R4LmZpbGxTdHlsZSA9ICcjMDAwJzsKICAgICAgICAgICAgY21jdHguZmlsbFJlY3QoMCwgMCwgY21jLndpZHRoLCBjbWMuaGVpZ2h0KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IGt3ID0gY21jLndpZHRoIC8gNzU7CiAgICAgICAgICAgIGNvbnN0IGggPSBjbWMuaGVpZ2h0OwoKICAgICAgICAgICAgbGV0IHdpID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgb2N0ID0gMDsgb2N0IDw9IDEwOyBvY3QrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCAxMjsgbisrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9jdCA9PT0gMTAgJiYgbiA+IDApIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGlmIChbMSwgMywgNiwgOCwgMTBdLmluY2x1ZGVzKG4pKSBjb250aW51ZTsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgW3IsIGcsIGJdID0gTkVXVE9OW25dOwogICAgICAgICAgICAgICAgICAgIGNtY3R4LmZpbGxTdHlsZSA9IGByZ2IoJHtyfSwke2d9LCR7Yn0pYDsKICAgICAgICAgICAgICAgICAgICBjbWN0eC5maWxsUmVjdCh3aSAqIGt3LCAwLCBrdywgaCk7CiAgICAgICAgICAgICAgICAgICAgd2krKzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgd2kgPSAwOwogICAgICAgICAgICBmb3IgKGxldCBvY3QgPSAwOyBvY3QgPD0gMTA7IG9jdCsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IDEyOyBuKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAob2N0ID09PSAxMCAmJiBuID4gMCkgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFbMSwgMywgNiwgOCwgMTBdLmluY2x1ZGVzKG4pKSB7IHdpKys7IGNvbnRpbnVlOyB9CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IFtyLCBnLCBiXSA9IE5FV1RPTltuXTsKICAgICAgICAgICAgICAgICAgICBjbWN0eC5maWxsU3R5bGUgPSBgcmdiKCR7cn0sJHtnfSwke2J9KWA7CiAgICAgICAgICAgICAgICAgICAgY21jdHguZmlsbFJlY3Qod2kgKiBrdyAtIGt3ICogMC4zLCAwLCBrdyAqIDAuNiwgaCAqIDAuNjUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBkcmF3UGlhbm8oKSB7CiAgICAgICAgICAgIHBjdHguZmlsbFN0eWxlID0gJyMwMDAnOwogICAgICAgICAgICBwY3R4LmZpbGxSZWN0KDAsIDAsIHBjLndpZHRoLCBwYy5oZWlnaHQpOwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3Qga3cgPSBwYy53aWR0aCAvIDc1OwogICAgICAgICAgICBjb25zdCBoID0gcGMuaGVpZ2h0OwoKICAgICAgICAgICAgbGV0IHdpID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgb2N0ID0gMDsgb2N0IDw9IDEwOyBvY3QrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCAxMjsgbisrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9jdCA9PT0gMTAgJiYgbiA+IDApIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGlmIChbMSwgMywgNiwgOCwgMTBdLmluY2x1ZGVzKG4pKSBjb250aW51ZTsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWlkaSA9IChvY3QgKyAxKSAqIDEyICsgbjsKICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZlID0gZmFsc2UsIG1heFZlbCA9IDA7CiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyhhY3RpdmVOb3RlcykuZm9yRWFjaChub3RlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3Rlc1ttaWRpXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFZlbCA9IE1hdGgubWF4KG1heFZlbCwgbm90ZXNbbWlkaV0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgW3IsIGcsIGJdID0gTkVXVE9OW25dOwogICAgICAgICAgICAgICAgICAgICAgICBwY3R4LmZpbGxTdHlsZSA9IGByZ2IoJHtyfSwke2d9LCR7Yn0pYDsKICAgICAgICAgICAgICAgICAgICAgICAgcGN0eC5zaGFkb3dDb2xvciA9IGByZ2IoJHtyfSwke2d9LCR7Yn0pYDsKICAgICAgICAgICAgICAgICAgICAgICAgcGN0eC5zaGFkb3dCbHVyID0gMTU7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGN0eC5maWxsU3R5bGUgPSAnIzBhMGEwYSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHBjdHguc2hhZG93Qmx1ciA9IDA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHBjdHguZmlsbFJlY3Qod2kgKiBrdywgMCwga3cgLSAxLCBoKTsKICAgICAgICAgICAgICAgICAgICBwY3R4LnNoYWRvd0JsdXIgPSAwOwoKICAgICAgICAgICAgICAgICAgICBwY3R4LnN0cm9rZVN0eWxlID0gJ3JnYmEoMCwgMjU1LCAwLCAwLjMpJzsKICAgICAgICAgICAgICAgICAgICBwY3R4LmxpbmVXaWR0aCA9IDE7CiAgICAgICAgICAgICAgICAgICAgcGN0eC5zdHJva2VSZWN0KHdpICoga3csIDAsIGt3IC0gMSwgaCk7CgogICAgICAgICAgICAgICAgICAgIHdpKys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHdpID0gMDsKICAgICAgICAgICAgZm9yIChsZXQgb2N0ID0gMDsgb2N0IDw9IDEwOyBvY3QrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCAxMjsgbisrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9jdCA9PT0gMTAgJiYgbiA+IDApIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGlmICghWzEsIDMsIDYsIDgsIDEwXS5pbmNsdWRlcyhuKSkgeyB3aSsrOyBjb250aW51ZTsgfQoKICAgICAgICAgICAgICAgICAgICBjb25zdCBtaWRpID0gKG9jdCArIDEpICogMTIgKyBuOwogICAgICAgICAgICAgICAgICAgIGxldCBhY3RpdmUgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBPYmplY3QudmFsdWVzKGFjdGl2ZU5vdGVzKS5mb3JFYWNoKG5vdGVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGVzW21pZGldKSBhY3RpdmUgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFtyLCBnLCBiXSA9IE5FV1RPTltuXTsKICAgICAgICAgICAgICAgICAgICAgICAgcGN0eC5maWxsU3R5bGUgPSBgcmdiKCR7cn0sJHtnfSwke2J9KWA7CiAgICAgICAgICAgICAgICAgICAgICAgIHBjdHguc2hhZG93Q29sb3IgPSBgcmdiKCR7cn0sJHtnfSwke2J9KWA7CiAgICAgICAgICAgICAgICAgICAgICAgIHBjdHguc2hhZG93Qmx1ciA9IDEyOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBjdHguZmlsbFN0eWxlID0gJyMwMDAnOwogICAgICAgICAgICAgICAgICAgICAgICBwY3R4LnNoYWRvd0JsdXIgPSAwOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBwY3R4LmZpbGxSZWN0KHdpICoga3cgLSBrdyAqIDAuMywgMCwga3cgKiAwLjYsIGggKiAwLjYpOwogICAgICAgICAgICAgICAgICAgIHBjdHguc2hhZG93Qmx1ciA9IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIENvbnRyb2xzCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2d1aWRlQnRuJykub25jbGljayA9ICgpID0+IHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2d1aWRlJykuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5nc0J0bicpLm9uY2xpY2sgPSAoKSA9PiB7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5ncycpLmNsYXNzTGlzdC50b2dnbGUoJ3Nob3cnKTsKICAgICAgICB9OwoKICAgICAgICAvLyBTZXR0aW5ncwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YXZlU3BlZWQnKS5vbmlucHV0ID0gKGUpID0+IHsKICAgICAgICAgICAgc2V0dGluZ3Mud2F2ZVNwZWVkID0gcGFyc2VJbnQoZS50YXJnZXQudmFsdWUpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3BlZWRWYWx1ZScpLnRleHRDb250ZW50ID0gc2V0dGluZ3Mud2F2ZVNwZWVkOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbXBsaXR1ZGUnKS5vbmlucHV0ID0gKGUpID0+IHsKICAgICAgICAgICAgc2V0dGluZ3MuYW1wbGl0dWRlID0gcGFyc2VGbG9hdChlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbXBsaXR1ZGVWYWx1ZScpLnRleHRDb250ZW50ID0gc2V0dGluZ3MuYW1wbGl0dWRlOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5lVGhpY2tuZXNzJykub25pbnB1dCA9IChlKSA9PiB7CiAgICAgICAgICAgIHNldHRpbmdzLmxpbmVUaGlja25lc3MgPSBwYXJzZUludChlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGlja25lc3NWYWx1ZScpLnRleHRDb250ZW50ID0gc2V0dGluZ3MubGluZVRoaWNrbmVzczsKICAgICAgICB9OwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2xvd0ludGVuc2l0eScpLm9uaW5wdXQgPSAoZSkgPT4gewogICAgICAgICAgICBzZXR0aW5ncy5nbG93SW50ZW5zaXR5ID0gcGFyc2VJbnQoZS50YXJnZXQudmFsdWUpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2xvd1ZhbHVlJykudGV4dENvbnRlbnQgPSBzZXR0aW5ncy5nbG93SW50ZW5zaXR5OwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YXZlRGVjYXknKS5vbmlucHV0ID0gKGUpID0+IHsKICAgICAgICAgICAgc2V0dGluZ3Mud2F2ZURlY2F5ID0gcGFyc2VJbnQoZS50YXJnZXQudmFsdWUpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVjYXlWYWx1ZScpLnRleHRDb250ZW50ID0gc2V0dGluZ3Mud2F2ZURlY2F5ICsgJ21zJzsKICAgICAgICB9OwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ3JpZERpc3BsYXknKS5vbmNoYW5nZSA9IChlKSA9PiB7CiAgICAgICAgICAgIHNldHRpbmdzLmdyaWREaXNwbGF5ID0gZS50YXJnZXQudmFsdWU7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdncmlkVmFsdWUnKS50ZXh0Q29udGVudCA9IGUudGFyZ2V0LnZhbHVlID09PSAnb24nID8gJ09uJyA6ICdPZmYnOwogICAgICAgIH07CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb2xvck1vZGUnKS5vbmNoYW5nZSA9IChlKSA9PiB7CiAgICAgICAgICAgIHNldHRpbmdzLmNvbG9yTW9kZSA9IGUudGFyZ2V0LnZhbHVlOwogICAgICAgICAgICBjb25zdCBsYWJlbHMgPSB7CiAgICAgICAgICAgICAgICAnbmV3dG9uJzogJ05ld3RvbicsCiAgICAgICAgICAgICAgICAnZ3JlZW4nOiAnQ2xhc3NpYyBHcmVlbicsCiAgICAgICAgICAgICAgICAnbWl4ZWQnOiAnTWl4ZWQgQ29sb3JzJwogICAgICAgICAgICB9OwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29sb3JWYWx1ZScpLnRleHRDb250ZW50ID0gbGFiZWxzW2UudGFyZ2V0LnZhbHVlXTsKICAgICAgICB9OwoKICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZHJhdyk7CiAgICA8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cg==";
        const VISUALIZER_3_B64 = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+TmV3dG9uJ3MgQ2hyb21hdGljIEdyaWQgLSBNSURJIFZpc3VhbGl6ZXI8L3RpdGxlPgogICAgPHN0eWxlPgogICAgICAgICogewogICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICAgIHBhZGRpbmc6IDA7CiAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAgICAgfQoKICAgICAgICBib2R5IHsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzAwMDsKICAgICAgICAgICAgY29sb3I6ICNmZmY7CiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAnTW9uYWNvJywgJ0NvdXJpZXIgTmV3JywgbW9ub3NwYWNlOwogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgIH0KCiAgICAgICAgI2dyaWQtY2FudmFzIHsKICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7CiAgICAgICAgICAgIHdpZHRoOiAxMDB2dzsKICAgICAgICAgICAgaGVpZ2h0OiAxMDB2aDsKICAgICAgICB9CgogICAgICAgICNpbmZvIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICB0b3A6IDIwcHg7CiAgICAgICAgICAgIGxlZnQ6IDIwcHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC44KTsKICAgICAgICAgICAgcGFkZGluZzogMTVweCAyMHB4OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuNjsKICAgICAgICAgICAgei1pbmRleDogMTAwOwogICAgICAgIH0KCiAgICAgICAgI2luZm8gaDMgewogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA4cHg7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICAgICAgY29sb3I6ICMwZjA7CiAgICAgICAgfQoKICAgICAgICAjZGV2aWNlLWxpc3QgewogICAgICAgICAgICBtYXJnaW4tdG9wOiA4cHg7CiAgICAgICAgICAgIHBhZGRpbmctdG9wOiA4cHg7CiAgICAgICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjMzMzOwogICAgICAgIH0KCiAgICAgICAgLmRldmljZSB7CiAgICAgICAgICAgIGNvbG9yOiAjMGYwOwogICAgICAgICAgICBtYXJnaW46IDNweCAwOwogICAgICAgIH0KCiAgICAgICAgI3RvZ2dsZS1pbmZvIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICB0b3A6IDIwcHg7CiAgICAgICAgICAgIHJpZ2h0OiAyMHB4OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuOCk7CiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICMzMzM7CiAgICAgICAgICAgIGNvbG9yOiAjZmZmOwogICAgICAgICAgICBwYWRkaW5nOiAxMHB4IDE1cHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgICAgICBmb250LWZhbWlseTogaW5oZXJpdDsKICAgICAgICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICAgICAgICB6LWluZGV4OiAxMDA7CiAgICAgICAgfQoKICAgICAgICAjdG9nZ2xlLWluZm86aG92ZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDUwLCA1MCwgNTAsIDAuOSk7CiAgICAgICAgfQoKICAgICAgICAuaGlkZGVuIHsKICAgICAgICAgICAgZGlzcGxheTogbm9uZTsKICAgICAgICB9CiAgICA8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5PgogICAgPGNhbnZhcyBpZD0iZ3JpZC1jYW52YXMiPjwvY2FudmFzPgogICAgCiAgICA8YnV0dG9uIGlkPSJ0b2dnbGUtaW5mbyIgb25jbGljaz0idG9nZ2xlSW5mbygpIj7ihLnvuI8gSW5mbzwvYnV0dG9uPgogICAgCiAgICA8ZGl2IGlkPSJpbmZvIj4KICAgICAgICA8aDM+TmV3dG9uJ3MgQ2hyb21hdGljIEdyaWQ8L2gzPgogICAgICAgIDxkaXY+TGlzdGVuaW5nIHRvIGFsbCBNSURJIGRldmljZXMgYXV0b21hdGljYWxseTwvZGl2PgogICAgICAgIDxkaXYgaWQ9ImRldmljZS1saXN0Ij48L2Rpdj4KICAgICAgICA8ZGl2IHN0eWxlPSJtYXJnaW4tdG9wOiAxMHB4OyBwYWRkaW5nLXRvcDogMTBweDsgYm9yZGVyLXRvcDogMXB4IHNvbGlkICMzMzM7Ij4KICAgICAgICAgICAgPGRpdj5BY3RpdmUgbm90ZXM6IDxzcGFuIGlkPSJub3RlLWNvdW50Ij4wPC9zcGFuPjwvZGl2PgogICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDEwcHg7IG9wYWNpdHk6IDAuNjsgbWFyZ2luLXRvcDogNXB4OyI+CiAgICAgICAgICAgICAgICBQcmVzcyBGMTEgZm9yIGZ1bGxzY3JlZW4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8c2NyaXB0PgogICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAvLyBORVdUT04nUyBDSFJPTUFUSUMgQ09MT1IgRU5HSU5FIC0gRVhBQ1QgTUFQUElORwogICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiAgICAgICAgY29uc3QgUElUQ0hfQ0xBU1NFUyA9IFsKICAgICAgICAgICAgeyBuYW1lOiAnQycsIHNlbWl0b25lOiAwIH0sCiAgICAgICAgICAgIHsgbmFtZTogJ0MjJywgc2VtaXRvbmU6IDEgfSwKICAgICAgICAgICAgeyBuYW1lOiAnRCcsIHNlbWl0b25lOiAyIH0sCiAgICAgICAgICAgIHsgbmFtZTogJ0QjJywgc2VtaXRvbmU6IDMgfSwKICAgICAgICAgICAgeyBuYW1lOiAnRScsIHNlbWl0b25lOiA0IH0sCiAgICAgICAgICAgIHsgbmFtZTogJ0YnLCBzZW1pdG9uZTogNSB9LAogICAgICAgICAgICB7IG5hbWU6ICdGIycsIHNlbWl0b25lOiA2IH0sCiAgICAgICAgICAgIHsgbmFtZTogJ0cnLCBzZW1pdG9uZTogNyB9LAogICAgICAgICAgICB7IG5hbWU6ICdHIycsIHNlbWl0b25lOiA4IH0sCiAgICAgICAgICAgIHsgbmFtZTogJ0EnLCBzZW1pdG9uZTogOSB9LAogICAgICAgICAgICB7IG5hbWU6ICdBIycsIHNlbWl0b25lOiAxMCB9LAogICAgICAgICAgICB7IG5hbWU6ICdCJywgc2VtaXRvbmU6IDExIH0KICAgICAgICBdOwoKICAgICAgICAvLyBFeGFjdCBjb2xvciBtYXBwaW5nIGZyb20gc3ByZWFkc2hlZXQgLSB1c2luZyBoZXggdmFsdWVzIGRpcmVjdGx5CiAgICAgICAgY29uc3QgRVhBQ1RfQ09MT1JTID0gWwogICAgICAgICAgICAvLyBNSURJIDAtMTEgKE9jdGF2ZSAtMSk6IEJsYWNrCiAgICAgICAgICAgIHtyOjAsZzowLGI6MH0se3I6MCxnOjAsYjowfSx7cjowLGc6MCxiOjB9LHtyOjAsZzowLGI6MH0se3I6MCxnOjAsYjowfSx7cjowLGc6MCxiOjB9LAogICAgICAgICAgICB7cjowLGc6MCxiOjB9LHtyOjAsZzowLGI6MH0se3I6MCxnOjAsYjowfSx7cjowLGc6MCxiOjB9LHtyOjAsZzowLGI6MH0se3I6MCxnOjAsYjowfSwKICAgICAgICAgICAgLy8gTUlESSAxMi0yMyAoT2N0YXZlIDApOiBDMC1CMAogICAgICAgICAgICB7cjoweDRDLGc6MHgwMCxiOjB4NEN9LHtyOjB4NjksZzoweDAwLGI6MHhEMn0se3I6MHgwMCxnOjB4MDAsYjoweEZGfSx7cjoweDAwLGc6MHg5OSxiOjB4RkZ9LHtyOjB4MDAsZzoweEZGLGI6MHgwMH0sCiAgICAgICAgICAgIHtyOjB4NkQsZzoweEZGLGI6MHgwMH0se3I6MHhEQixnOjB4RkYsYjoweDAwfSx7cjoweEZGLGc6MHhCMSxiOjB4MDB9LHtyOjB4RkYsZzoweDNCLGI6MHgwMH0se3I6MHhGRixnOjB4MDAsYjoweDAwfSwKICAgICAgICAgICAge3I6MHhGRixnOjB4MDAsYjoweDAwfSx7cjoweEI4LGc6MHgwMCxiOjB4MDB9LAogICAgICAgICAgICAvLyBNSURJIDI0LTM1IChPY3RhdmUgMSk6IEMxLUIxCiAgICAgICAgICAgIHtyOjB4NTUsZzoweDAwLGI6MHg1QX0se3I6MHg2NSxnOjB4MDAsYjoweEUwfSx7cjoweDAwLGc6MHgwRixiOjB4RkZ9LHtyOjB4MDAsZzoweEFELGI6MHhGRn0se3I6MHgwQixnOjB4RkYsYjoweDAwfSwKICAgICAgICAgICAge3I6MHg3OCxnOjB4RkYsYjoweDAwfSx7cjoweEU2LGc6MHhGRixiOjB4MDB9LHtyOjB4RkYsZzoweEE1LGI6MHgwMH0se3I6MHhGRixnOjB4MkYsYjoweDAwfSx7cjoweEZGLGc6MHgwMCxiOjB4MDB9LAogICAgICAgICAgICB7cjoweEZGLGc6MHgwMCxiOjB4MDB9LHtyOjB4QUQsZzoweDAwLGI6MHgwMH0sCiAgICAgICAgICAgIC8vIE1JREkgMzYtNDcgKE9jdGF2ZSAyKTogQzItQjIKICAgICAgICAgICAge3I6MHg1RCxnOjB4MDAsYjoweDY3fSx7cjoweDVGLGc6MHgwMCxiOjB4RUR9LHtyOjB4MDAsZzoweDFGLGI6MHhGRn0se3I6MHgwMCxnOjB4QzIsYjoweEZGfSx7cjoweDE2LGc6MHhGRixiOjB4MDB9LAogICAgICAgICAgICB7cjoweDgzLGc6MHhGRixiOjB4MDB9LHtyOjB4RjAsZzoweEZGLGI6MHgwMH0se3I6MHhGRixnOjB4OTksYjoweDAwfSx7cjoweEZGLGc6MHgyMyxiOjB4MDB9LHtyOjB4RkYsZzoweDAwLGI6MHgwMH0sCiAgICAgICAgICAgIHtyOjB4RkYsZzoweDAwLGI6MHgwMH0se3I6MHhBMixnOjB4MDAsYjoweDAwfSwKICAgICAgICAgICAgLy8gTUlESSA0OC01OSAoT2N0YXZlIDMpOiBDMy1CMwogICAgICAgICAgICB7cjoweDYzLGc6MHgwMCxiOjB4NzV9LHtyOjB4NTgsZzoweDAwLGI6MHhGQn0se3I6MHgwMCxnOjB4MkUsYjoweEZGfSx7cjoweDAwLGc6MHhENixiOjB4RkZ9LHtyOjB4MjEsZzoweEZGLGI6MHgwMH0sCiAgICAgICAgICAgIHtyOjB4OEUsZzoweEZGLGI6MHgwMH0se3I6MHhGQixnOjB4RkYsYjoweDAwfSx7cjoweEZGLGc6MHg4RCxiOjB4MDB9LHtyOjB4RkYsZzoweDE4LGI6MHgwMH0se3I6MHhGRixnOjB4MDAsYjoweDAwfSwKICAgICAgICAgICAge3I6MHhGRixnOjB4MDAsYjoweDAwfSx7cjoweDk3LGc6MHgwMCxiOjB4MDB9LAogICAgICAgICAgICAvLyBNSURJIDYwLTcxIChPY3RhdmUgNCk6IEM0LUI0CiAgICAgICAgICAgIHtyOjB4NjgsZzoweDAwLGI6MHg4Mn0se3I6MHg0QyxnOjB4MDAsYjoweEZGfSx7cjoweDAwLGc6MHgzRCxiOjB4RkZ9LHtyOjB4MDAsZzoweEVCLGI6MHhGRn0se3I6MHgyQyxnOjB4RkYsYjoweDAwfSwKICAgICAgICAgICAge3I6MHg5OSxnOjB4RkYsYjoweDAwfSx7cjoweEZGLGc6MHhGNyxiOjB4MDB9LHtyOjB4RkYsZzoweDgxLGI6MHgwMH0se3I6MHhGRixnOjB4MEMsYjoweDAwfSx7cjoweEZGLGc6MHgwMCxiOjB4MDB9LAogICAgICAgICAgICB7cjoweEY4LGc6MHgwMCxiOjB4MDB9LHtyOjB4OEQsZzoweDAwLGI6MHgwMH0sCiAgICAgICAgICAgIC8vIE1JREkgNzItODMgKE9jdGF2ZSA1KTogQzUtQjUKICAgICAgICAgICAge3I6MHg2QyxnOjB4MDAsYjoweDhGfSx7cjoweDQwLGc6MHgwMCxiOjB4RkZ9LHtyOjB4MDAsZzoweDRDLGI6MHhGRn0se3I6MHgwMCxnOjB4RkYsYjoweEZGfSx7cjoweDM3LGc6MHhGRixiOjB4MDB9LAogICAgICAgICAgICB7cjoweEE0LGc6MHhGRixiOjB4MDB9LHtyOjB4RkYsZzoweEVCLGI6MHgwMH0se3I6MHhGRixnOjB4NzYsYjoweDAwfSx7cjoweEZGLGc6MHgwMCxiOjB4MDB9LHtyOjB4RkYsZzoweDAwLGI6MHgwMH0sCiAgICAgICAgICAgIHtyOjB4RUQsZzoweDAwLGI6MHgwMH0se3I6MHg4MixnOjB4MDAsYjoweDAwfSwKICAgICAgICAgICAgLy8gTUlESSA4NC05NSAoT2N0YXZlIDYpOiBDNi1CNgogICAgICAgICAgICB7cjoweDZFLGc6MHgwMCxiOjB4OUR9LHtyOjB4MzMsZzoweDAwLGI6MHhGRn0se3I6MHgwMCxnOjB4NUMsYjoweEZGfSx7cjoweDAwLGc6MHhGRixiOjB4Q0N9LHtyOjB4NDIsZzoweEZGLGI6MHgwMH0sCiAgICAgICAgICAgIHtyOjB4QUYsZzoweEZGLGI6MHgwMH0se3I6MHhGRixnOjB4RTAsYjoweDAwfSx7cjoweEZGLGc6MHg2QSxiOjB4MDB9LHtyOjB4RkYsZzoweDAwLGI6MHgwMH0se3I6MHhGRixnOjB4MDAsYjoweDAwfSwKICAgICAgICAgICAge3I6MHhFMixnOjB4MDAsYjoweDAwfSx7cjoweDc3LGc6MHgwMCxiOjB4MDB9LAogICAgICAgICAgICAvLyBNSURJIDk2LTEwNyAoT2N0YXZlIDcpOiBDNy1CNwogICAgICAgICAgICB7cjoweDZGLGc6MHgwMCxiOjB4QUF9LHtyOjB4MjYsZzoweDAwLGI6MHhGRn0se3I6MHgwMCxnOjB4NkIsYjoweEZGfSx7cjoweDAwLGc6MHhGRixiOjB4OTl9LHtyOjB4NEMsZzoweEZGLGI6MHgwMH0sCiAgICAgICAgICAgIHtyOjB4QkEsZzoweEZGLGI6MHgwMH0se3I6MHhGRixnOjB4RDQsYjoweDAwfSx7cjoweEZGLGc6MHg1RSxiOjB4MDB9LHtyOjB4RkYsZzoweDAwLGI6MHgwMH0se3I6MHhGRixnOjB4MDAsYjoweDAwfSwKICAgICAgICAgICAge3I6MHhEOCxnOjB4MDAsYjoweDAwfSx7cjoweDZELGc6MHgwMCxiOjB4MDB9LAogICAgICAgICAgICAvLyBNSURJIDEwOC0xMTkgKE9jdGF2ZSA4KTogQzgtQjgKICAgICAgICAgICAge3I6MHg2RSxnOjB4MDAsYjoweEI4fSx7cjoweDFBLGc6MHgwMCxiOjB4RkZ9LHtyOjB4MDAsZzoweDdBLGI6MHhGRn0se3I6MHgwMCxnOjB4RkYsYjoweDY2fSx7cjoweDU3LGc6MHhGRixiOjB4MDB9LAogICAgICAgICAgICB7cjoweEM1LGc6MHhGRixiOjB4MDB9LHtyOjB4RkYsZzoweEM4LGI6MHgwMH0se3I6MHhGRixnOjB4NTIsYjoweDAwfSx7cjoweEZGLGc6MHgwMCxiOjB4MDB9LHtyOjB4RkYsZzoweDAwLGI6MHgwMH0sCiAgICAgICAgICAgIHtyOjB4Q0QsZzoweDAwLGI6MHgwMH0se3I6MHg2MixnOjB4MDAsYjoweDAwfSwKICAgICAgICAgICAgLy8gTUlESSAxMjAtMTI3IChPY3RhdmUgOSk6IEM5LUc5CiAgICAgICAgICAgIHtyOjB4NkMsZzoweDAwLGI6MHhDNX0se3I6MHgwRCxnOjB4MDAsYjoweEZGfSx7cjoweDAwLGc6MHg4QSxiOjB4RkZ9LHtyOjB4MDAsZzoweEZGLGI6MHgzM30se3I6MHg2MixnOjB4RkYsYjoweDAwfSwKICAgICAgICAgICAge3I6MHhEMCxnOjB4RkYsYjoweDAwfSx7cjoweEZGLGc6MHhCQyxiOjB4MDB9LHtyOjB4RkYsZzoweDQ3LGI6MHgwMH0KICAgICAgICBdOwoKICAgICAgICBjbGFzcyBDb2xvckVuZ2luZSB7CiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgICAgICAgdGhpcy5jb2xvclRhYmxlID0gbmV3IE1hcCgpOwogICAgICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZUNvbG9yVGFibGUoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZ2V0Q29sb3IobWlkaU5vdGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbG9yVGFibGUuZ2V0KG1pZGlOb3RlKSB8fCB7IHI6IDAsIGc6IDAsIGI6IDAsIGhleDogJyMwMDAwMDAnIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGdldE5vdGVOYW1lKG1pZGlOb3RlKSB7CiAgICAgICAgICAgICAgICBjb25zdCBwaXRjaENsYXNzID0gbWlkaU5vdGUgJSAxMjsKICAgICAgICAgICAgICAgIGNvbnN0IG9jdGF2ZSA9IE1hdGguZmxvb3IobWlkaU5vdGUgLyAxMikgLSAxOwogICAgICAgICAgICAgICAgcmV0dXJuIGAke1BJVENIX0NMQVNTRVNbcGl0Y2hDbGFzc10ubmFtZX0ke29jdGF2ZX1gOwogICAgICAgICAgICB9CgogICAgICAgICAgICBnZW5lcmF0ZUNvbG9yVGFibGUoKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBtaWRpTm90ZSA9IDA7IG1pZGlOb3RlIDw9IDEyNzsgbWlkaU5vdGUrKykgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbG9yID0gRVhBQ1RfQ09MT1JTW21pZGlOb3RlXTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBoZXggPSBgIyR7Y29sb3Iuci50b1N0cmluZygxNikucGFkU3RhcnQoMiwgJzAnKX0ke2NvbG9yLmcudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJyl9JHtjb2xvci5iLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpfWA7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2xvclRhYmxlLnNldChtaWRpTm90ZSwgeyAuLi5jb2xvciwgaGV4IH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjb25zdCBjb2xvckVuZ2luZSA9IG5ldyBDb2xvckVuZ2luZSgpOwoKICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgLy8gQ0hST01BVElDIEdSSUQgVklTVUFMSVpFUgogICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiAgICAgICAgY2xhc3MgQ2hyb21hdGljR3JpZFZpc3VhbGl6ZXIgewogICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dyaWQtY2FudmFzJyk7CiAgICAgICAgICAgICAgICB0aGlzLmN0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICAgICAgICAgICAgICB0aGlzLm1pZGlBY2Nlc3MgPSBudWxsOwogICAgICAgICAgICAgICAgdGhpcy5kZXZpY2VzID0gW107CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIEdyaWQgbGF5b3V0OiAxMiBjb2x1bW5zIChDIHRocm91Z2ggQiksIDExIHJvd3MgKG9jdGF2ZXMgMC0xMCkKICAgICAgICAgICAgICAgIHRoaXMuY29scyA9IDEyOyAvLyBQaXRjaCBjbGFzc2VzCiAgICAgICAgICAgICAgICB0aGlzLnJvd3MgPSAxMTsgLy8gT2N0YXZlcwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBBY3RpdmUgbm90ZXM6IE1hcDxtaWRpTm90ZSwge3ZlbG9jaXR5LCBzdGFydFRpbWUsIHJlbGVhc2VUaW1lfT4KICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlTm90ZXMgPSBuZXcgTWFwKCk7CiAgICAgICAgICAgICAgICB0aGlzLmRlY2F5VGltZSA9IDQwMDsgLy8gRmFzdCBkZWNheSBmb3IgZ3JpZAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0aGlzLmluaXQoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYXN5bmMgaW5pdCgpIHsKICAgICAgICAgICAgICAgIHRoaXMucmVzaXplQ2FudmFzKCk7CiAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4gdGhpcy5yZXNpemVDYW52YXMoKSk7CgogICAgICAgICAgICAgICAgLy8gUmVxdWVzdCBNSURJIGFjY2VzcyAtIGxpc3RlbiB0byBBTEwgaW5wdXRzIGF1dG9tYXRpY2FsbHkKICAgICAgICAgICAgICAgIGlmIChuYXZpZ2F0b3IucmVxdWVzdE1JRElBY2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1pZGlBY2Nlc3MgPSBhd2FpdCBuYXZpZ2F0b3IucmVxdWVzdE1JRElBY2Nlc3MoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR1cEFsbE1JRElJbnB1dHMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5taWRpQWNjZXNzLm9uc3RhdGVjaGFuZ2UgPSAoKSA9PiB0aGlzLnNldHVwQWxsTUlESUlucHV0cygpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIE1JREkgYWNjZXNzIGdyYW50ZWQgLSBsaXN0ZW5pbmcgdG8gYWxsIGRldmljZXMnKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ01JREkgYWNjZXNzIGRlbmllZC4gUGxlYXNlIGFsbG93IE1JREkgYWNjZXNzIGluIHlvdXIgYnJvd3Nlci4nKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdXZWIgTUlESSBBUEkgbm90IHN1cHBvcnRlZC4gUGxlYXNlIHVzZSBDaHJvbWUsIEVkZ2UsIG9yIE9wZXJhLicpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXNpemVDYW52YXMoKSB7CiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoOwogICAgICAgICAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0OwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2VsbCBkaW1lbnNpb25zCiAgICAgICAgICAgICAgICB0aGlzLmNlbGxXaWR0aCA9IHRoaXMuY2FudmFzLndpZHRoIC8gdGhpcy5jb2xzOwogICAgICAgICAgICAgICAgdGhpcy5jZWxsSGVpZ2h0ID0gdGhpcy5jYW52YXMuaGVpZ2h0IC8gdGhpcy5yb3dzOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzZXR1cEFsbE1JRElJbnB1dHMoKSB7CiAgICAgICAgICAgICAgICB0aGlzLmRldmljZXMgPSBbXTsKICAgICAgICAgICAgICAgIGNvbnN0IGRldmljZUxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV2aWNlLWxpc3QnKTsKICAgICAgICAgICAgICAgIGRldmljZUxpc3QuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRoaXMubWlkaUFjY2Vzcy5pbnB1dHMuZm9yRWFjaChpbnB1dCA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXZpY2VzLnB1c2goeyBpZDogaW5wdXQuaWQsIG5hbWU6IGlucHV0Lm5hbWUgfHwgJ1Vua25vd24gRGV2aWNlJyB9KTsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5vbm1pZGltZXNzYWdlID0gKG1lc3NhZ2UpID0+IHRoaXMuaGFuZGxlTUlESU1lc3NhZ2UobWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgZGl2LmNsYXNzTmFtZSA9ICdkZXZpY2UnOwogICAgICAgICAgICAgICAgICAgIGRpdi50ZXh0Q29udGVudCA9IGDwn461ICR7aW5wdXQubmFtZX1gOwogICAgICAgICAgICAgICAgICAgIGRldmljZUxpc3QuYXBwZW5kQ2hpbGQoZGl2KTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+OtSBMaXN0ZW5pbmcgdG86ICR7aW5wdXQubmFtZX1gKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZXZpY2VzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgIGRldmljZUxpc3QuaW5uZXJIVE1MID0gJzxkaXYgc3R5bGU9ImNvbG9yOiAjZjAwOyI+Tm8gTUlESSBkZXZpY2VzIGRldGVjdGVkPC9kaXY+JzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYPCfk6EgVG90YWwgTUlESSBkZXZpY2VzOiAke3RoaXMuZGV2aWNlcy5sZW5ndGh9YCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGhhbmRsZU1JRElNZXNzYWdlKG1lc3NhZ2UpIHsKICAgICAgICAgICAgICAgIGNvbnN0IFtzdGF0dXMsIG5vdGUsIHZlbG9jaXR5XSA9IG1lc3NhZ2UuZGF0YTsKICAgICAgICAgICAgICAgIGNvbnN0IGNvbW1hbmQgPSBzdGF0dXMgJiAweGYwOwoKICAgICAgICAgICAgICAgIGlmIChjb21tYW5kID09PSAweDkwICYmIHZlbG9jaXR5ID4gMCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlTm90ZU9uKG5vdGUsIHZlbG9jaXR5KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29tbWFuZCA9PT0gMHg4MCB8fCAoY29tbWFuZCA9PT0gMHg5MCAmJiB2ZWxvY2l0eSA9PT0gMCkpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZU5vdGVPZmYobm90ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGhhbmRsZU5vdGVPbihtaWRpTm90ZSwgdmVsb2NpdHkpIHsKICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlTm90ZXMuc2V0KG1pZGlOb3RlLCB7CiAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBwZXJmb3JtYW5jZS5ub3coKSwKICAgICAgICAgICAgICAgICAgICByZWxlYXNlVGltZTogbnVsbAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTm90ZUNvdW50KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGhhbmRsZU5vdGVPZmYobWlkaU5vdGUpIHsKICAgICAgICAgICAgICAgIGNvbnN0IG5vdGUgPSB0aGlzLmFjdGl2ZU5vdGVzLmdldChtaWRpTm90ZSk7CiAgICAgICAgICAgICAgICBpZiAobm90ZSkgewogICAgICAgICAgICAgICAgICAgIG5vdGUucmVsZWFzZVRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgdXBkYXRlTm90ZUNvdW50KCkgewogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vdGUtY291bnQnKS50ZXh0Q29udGVudCA9IHRoaXMuYWN0aXZlTm90ZXMuc2l6ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZHJhd0dyaWQoKSB7CiAgICAgICAgICAgICAgICBjb25zdCBjdHggPSB0aGlzLmN0eDsKICAgICAgICAgICAgICAgIGNvbnN0IG5vdyA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBDbGVhciBjYW52YXMKICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAnIzAwMCc7CiAgICAgICAgICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIERyYXcgZ3JpZCBjZWxscwogICAgICAgICAgICAgICAgZm9yIChsZXQgb2N0YXZlID0gMDsgb2N0YXZlIDwgdGhpcy5yb3dzOyBvY3RhdmUrKykgewogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHBpdGNoQ2xhc3MgPSAwOyBwaXRjaENsYXNzIDwgdGhpcy5jb2xzOyBwaXRjaENsYXNzKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWlkaU5vdGUgPSAob2N0YXZlICsgMSkgKiAxMiArIHBpdGNoQ2xhc3M7IC8vIE9jdGF2ZSAtMSB0byA5IChNSURJIDAtMTI3KQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1pZGlOb3RlID4gMTI3KSBjb250aW51ZTsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHggPSBwaXRjaENsYXNzICogdGhpcy5jZWxsV2lkdGg7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHkgPSBvY3RhdmUgKiB0aGlzLmNlbGxIZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2xvciA9IGNvbG9yRW5naW5lLmdldENvbG9yKG1pZGlOb3RlKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm90ZSA9IHRoaXMuYWN0aXZlTm90ZXMuZ2V0KG1pZGlOb3RlKTsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBicmlnaHRuZXNzID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNob3VsZERlbGV0ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RlLnJlbGVhc2VUaW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmFkaW5nIG91dAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsYXBzZWQgPSBub3cgLSBub3RlLnJlbGVhc2VUaW1lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyaWdodG5lc3MgPSBNYXRoLm1heCgwLCAxIC0gZWxhcHNlZCAvIHRoaXMuZGVjYXlUaW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnJpZ2h0bmVzcyA8PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZERlbGV0ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBY3RpdmUgbm90ZSAtIGJyaWdodG5lc3MgYmFzZWQgb24gdmVsb2NpdHkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmlnaHRuZXNzID0gMC4zICsgKG5vdGUudmVsb2NpdHkgLyAxMjcpICogMC43OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hvdWxkRGVsZXRlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZU5vdGVzLmRlbGV0ZShtaWRpTm90ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOb3RlQ291bnQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAvLyBEcmF3IGNlbGwgYmFja2dyb3VuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnJpZ2h0bmVzcyA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFjdGl2ZSAtIHNob3cgY29sb3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBgcmdiYSgke2NvbG9yLnJ9LCAke2NvbG9yLmd9LCAke2NvbG9yLmJ9LCAke2JyaWdodG5lc3N9KWA7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbmFjdGl2ZSAtIHZlcnkgZGFyawogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGByZ2JhKCR7Y29sb3Iucn0sICR7Y29sb3IuZ30sICR7Y29sb3IuYn0sIDAuMDUpYDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KHggKyAxLCB5ICsgMSwgdGhpcy5jZWxsV2lkdGggLSAyLCB0aGlzLmNlbGxIZWlnaHQgLSAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERyYXcgbm90ZSBsYWJlbCBpZiBjZWxsIGlzIGxhcmdlIGVub3VnaAogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jZWxsV2lkdGggPiA2MCAmJiB0aGlzLmNlbGxIZWlnaHQgPiA0MCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm90ZU5hbWUgPSBjb2xvckVuZ2luZS5nZXROb3RlTmFtZShtaWRpTm90ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gYnJpZ2h0bmVzcyA+IDAuNCA/ICcjMDAwJyA6ICcjNjY2JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5mb250ID0gYCR7TWF0aC5taW4odGhpcy5jZWxsSGVpZ2h0ICogMC4yNSwgMTYpfXB4IG1vbm9zcGFjZWA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgudGV4dEFsaWduID0gJ2NlbnRlcic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gJ21pZGRsZSc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFRleHQobm90ZU5hbWUsIHggKyB0aGlzLmNlbGxXaWR0aCAvIDIsIHkgKyB0aGlzLmNlbGxIZWlnaHQgLyAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gRHJhdyBvY3RhdmUgbGFiZWxzIChsZWZ0IHNpZGUpCiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYW52YXMud2lkdGggPiA4MDApIHsKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gJyM2NjYnOwogICAgICAgICAgICAgICAgICAgIGN0eC5mb250ID0gJzE0cHggbW9ub3NwYWNlJzsKICAgICAgICAgICAgICAgICAgICBjdHgudGV4dEFsaWduID0gJ3JpZ2h0JzsKICAgICAgICAgICAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gJ21pZGRsZSc7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgb2N0YXZlID0gMDsgb2N0YXZlIDwgdGhpcy5yb3dzOyBvY3RhdmUrKykgewogICAgICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFRleHQoYE9DVCAke29jdGF2ZX1gLCA0NSwgb2N0YXZlICogdGhpcy5jZWxsSGVpZ2h0ICsgdGhpcy5jZWxsSGVpZ2h0IC8gMik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBEcmF3IHBpdGNoIGNsYXNzIGxhYmVscyAodG9wKQogICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FudmFzLmhlaWdodCA+IDYwMCkgewogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAnIzY2Nic7CiAgICAgICAgICAgICAgICAgICAgY3R4LmZvbnQgPSAnMTRweCBtb25vc3BhY2UnOwogICAgICAgICAgICAgICAgICAgIGN0eC50ZXh0QWxpZ24gPSAnY2VudGVyJzsKICAgICAgICAgICAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gJ2JvdHRvbSc7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNvbHM7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFRleHQoUElUQ0hfQ0xBU1NFU1tpXS5uYW1lLCBpICogdGhpcy5jZWxsV2lkdGggKyB0aGlzLmNlbGxXaWR0aCAvIDIsIDIwKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFuaW1hdGUoKSB7CiAgICAgICAgICAgICAgICB0aGlzLmRyYXdHcmlkKCk7CiAgICAgICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gdGhpcy5hbmltYXRlKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBJbml0aWFsaXplCiAgICAgICAgY29uc3QgdmlzdWFsaXplciA9IG5ldyBDaHJvbWF0aWNHcmlkVmlzdWFsaXplcigpOwoKICAgICAgICAvLyBJbmZvIHRvZ2dsZQogICAgICAgIGxldCBpbmZvVmlzaWJsZSA9IHRydWU7CiAgICAgICAgZnVuY3Rpb24gdG9nZ2xlSW5mbygpIHsKICAgICAgICAgICAgaW5mb1Zpc2libGUgPSAhaW5mb1Zpc2libGU7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbmZvJykuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJywgIWluZm9WaXNpYmxlKTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1pbmZvJykudGV4dENvbnRlbnQgPSBpbmZvVmlzaWJsZSA/ICfihLnvuI8gSW5mbycgOiAn4oS577iPIFNob3cgSW5mbyc7CiAgICAgICAgfQoKICAgICAgICAvLyBGMTEgaGludAogICAgICAgIGNvbnNvbGUubG9nKCdQcmVzcyBGMTEgZm9yIGZ1bGxzY3JlZW4gbW9kZScpOwogICAgPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPgo=";
        const VISUALIZER_4_B64 = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+TmV3dG9uJ3MgQ2hyb21hdGljIE1JREkgVmlzdWFsaXplciAtIEVuaGFuY2VkPC90aXRsZT4KICAgIDxzdHlsZT4KICAgICAgICAqIHsKICAgICAgICAgICAgbWFyZ2luOiAwOwogICAgICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogICAgICAgIH0KCiAgICAgICAgYm9keSB7CiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICdTZWdvZSBVSScsIEFyaWFsLCBzYW5zLXNlcmlmOwogICAgICAgICAgICAtLWJnLWNvbG9yOiAjMDAwOwogICAgICAgICAgICAtLXRleHQtY29sb3I6ICNmZmY7CiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJnLWNvbG9yKTsKICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpOwogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuM3MgZWFzZTsKICAgICAgICB9CgogICAgICAgIGJvZHkubGlnaHQtbW9kZSB7CiAgICAgICAgICAgIC0tYmctY29sb3I6ICNmZmY7CiAgICAgICAgICAgIC0tdGV4dC1jb2xvcjogIzAwMDsKICAgICAgICB9CgogICAgICAgICNjb250cm9sLXBhbmVsIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICB0b3A6IDA7CiAgICAgICAgICAgIGxlZnQ6IDA7CiAgICAgICAgICAgIHJpZ2h0OiAwOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuOTUpOwogICAgICAgICAgICBib3JkZXItYm90dG9tOiAycHggc29saWQgIzMzMzsKICAgICAgICAgICAgcGFkZGluZzogMTVweDsKICAgICAgICAgICAgei1pbmRleDogMTAwMDsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgZmxleC13cmFwOiB3cmFwOwogICAgICAgICAgICBnYXA6IDIwcHg7CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjNzIGVhc2U7CiAgICAgICAgfQoKICAgICAgICAjY29udHJvbC1wYW5lbC5jb2xsYXBzZWQgewogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwMCUpOwogICAgICAgIH0KCiAgICAgICAgI2NvbnRyb2wtdG9nZ2xlIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICB0b3A6IDEwcHg7CiAgICAgICAgICAgIHJpZ2h0OiAyMHB4OwogICAgICAgICAgICB6LWluZGV4OiAxMDAxOwogICAgICAgICAgICBwYWRkaW5nOiA4cHggMTZweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjgpOwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjNTU1OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICAgICAgICAgIGNvbG9yOiAjZmZmOwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTNweDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnM7CiAgICAgICAgfQoKICAgICAgICAjY29udHJvbC10b2dnbGU6aG92ZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuOTUpOwogICAgICAgICAgICBib3JkZXItY29sb3I6ICM3Nzc7CiAgICAgICAgfQoKICAgICAgICBib2R5LmxpZ2h0LW1vZGUgI2NvbnRyb2wtdG9nZ2xlIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjkpOwogICAgICAgICAgICBjb2xvcjogIzAwMDsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiAjY2NjOwogICAgICAgIH0KCiAgICAgICAgYm9keS5saWdodC1tb2RlICNjb250cm9sLXRvZ2dsZTpob3ZlciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMSk7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogIzk5OTsKICAgICAgICB9CgogICAgICAgICNjb250cm9sLXBhbmVsIGgxIHsKICAgICAgICAgICAgZm9udC1zaXplOiAxOHB4OwogICAgICAgICAgICBmb250LXdlaWdodDogNjAwOwogICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICAgIGNvbG9yOiAjZmZmOwogICAgICAgIH0KCiAgICAgICAgLm1vZGUtdG9nZ2xlIHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgZ2FwOiA1cHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wNSk7CiAgICAgICAgICAgIHBhZGRpbmc6IDRweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjNDQ0OwogICAgICAgIH0KCiAgICAgICAgLm1vZGUtYnV0dG9uIHsKICAgICAgICAgICAgcGFkZGluZzogNnB4IDE2cHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OwogICAgICAgICAgICBjb2xvcjogI2FhYTsKICAgICAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgZm9udC1zaXplOiAxM3B4OwogICAgICAgICAgICBmb250LXdlaWdodDogNjAwOwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4yczsKICAgICAgICB9CgogICAgICAgIC5tb2RlLWJ1dHRvbjpob3ZlciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgICAgICAgICAgY29sb3I6ICNmZmY7CiAgICAgICAgfQoKICAgICAgICAubW9kZS1idXR0b24uYWN0aXZlIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzBhODRmZjsKICAgICAgICAgICAgY29sb3I6ICNmZmY7CiAgICAgICAgfQoKICAgICAgICAubGFuZS1jb250cm9sIHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgZ2FwOiAxMHB4OwogICAgICAgICAgICBwYWRkaW5nOiA4cHggMTJweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA1KTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjNDQ0OwogICAgICAgIH0KCiAgICAgICAgLmxhbmUtY29udHJvbCBsYWJlbCB7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTNweDsKICAgICAgICAgICAgY29sb3I6ICNhYWE7CiAgICAgICAgfQoKICAgICAgICAubGFuZS1jb250cm9sIHNlbGVjdCB7CiAgICAgICAgICAgIHBhZGRpbmc6IDZweCAxMHB4OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMjIyOwogICAgICAgICAgICBjb2xvcjogI2ZmZjsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgIzU1NTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4OwogICAgICAgICAgICBmb250LXNpemU6IDEzcHg7CiAgICAgICAgICAgIG1pbi13aWR0aDogMTgwcHg7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICB9CgogICAgICAgIC5sYW5lLWNvbnRyb2wgc2VsZWN0OmhvdmVyIHsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiAjNzc3OwogICAgICAgIH0KCiAgICAgICAgLmluc3RydW1lbnQtYmFkZ2UgewogICAgICAgICAgICBwYWRkaW5nOiA0cHggMTBweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4OwogICAgICAgICAgICBmb250LXNpemU6IDExcHg7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7CiAgICAgICAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7CiAgICAgICAgICAgIGxldHRlci1zcGFjaW5nOiAwLjVweDsKICAgICAgICB9CgogICAgICAgIC5pbnN0cnVtZW50LWJhc3MgeyBiYWNrZ3JvdW5kOiAjOGIwMGZmOyBjb2xvcjogI2ZmZjsgfQogICAgICAgIC5pbnN0cnVtZW50LWNob3JkcyB7IGJhY2tncm91bmQ6ICMwMGE4ZmY7IGNvbG9yOiAjZmZmOyB9CiAgICAgICAgLmluc3RydW1lbnQtbWVsb2R5IHsgYmFja2dyb3VuZDogI2ZmNmIwMDsgY29sb3I6ICNmZmY7IH0KICAgICAgICAuaW5zdHJ1bWVudC1wZXJjdXNzaW9uIHsgYmFja2dyb3VuZDogI2ZmMDA4MDsgY29sb3I6ICNmZmY7IH0KCiAgICAgICAgLm5vdGUtY291bnQgewogICAgICAgICAgICBwYWRkaW5nOiA0cHggMTBweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzMzMzsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgICAgICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICAgICAgICBmb250LXdlaWdodDogNjAwOwogICAgICAgICAgICBtaW4td2lkdGg6IDYwcHg7CiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgICAgICB9CgogICAgICAgIC5ub3RlLWNvdW50LmFjdGl2ZSB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMwYTA7CiAgICAgICAgICAgIGNvbG9yOiAjMDAwOwogICAgICAgIH0KCiAgICAgICAgI2NhbnZhcy1jb250YWluZXIgewogICAgICAgICAgICBtYXJnaW4tdG9wOiAwOwogICAgICAgICAgICBoZWlnaHQ6IDEwMHZoOwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgICAgIHRyYW5zaXRpb246IG1hcmdpbi10b3AgMC4zcyBlYXNlOwogICAgICAgIH0KCiAgICAgICAgI2NhbnZhcy1jb250YWluZXIuc2hvdy1jb250cm9scyB7CiAgICAgICAgICAgIG1hcmdpbi10b3A6IDEwMHB4OwogICAgICAgICAgICBoZWlnaHQ6IGNhbGMoMTAwdmggLSAxMDBweCk7CiAgICAgICAgfQoKICAgICAgICAjY2FudmFzLWNvbnRhaW5lci5jb21iaW5hdGlvbi1tb2RlIHsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgfQoKICAgICAgICAubGFuZSB7CiAgICAgICAgICAgIGZsZXg6IDE7CiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkICMzMzM7CiAgICAgICAgfQoKICAgICAgICAubGFuZTpsYXN0LWNoaWxkIHsKICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogbm9uZTsKICAgICAgICB9CgogICAgICAgICNjYW52YXMtY29udGFpbmVyLmNvbWJpbmF0aW9uLW1vZGUgLmxhbmUgewogICAgICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgIH0KCiAgICAgICAgLmxhbmUgY2FudmFzIHsKICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7CiAgICAgICAgfQoKICAgICAgICAjY29tYmluYXRpb24tY2FudmFzIHsKICAgICAgICAgICAgZGlzcGxheTogbm9uZTsKICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICB0b3A6IDA7CiAgICAgICAgICAgIGxlZnQ6IDA7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgfQoKICAgICAgICAjY2FudmFzLWNvbnRhaW5lci5jb21iaW5hdGlvbi1tb2RlICNjb21iaW5hdGlvbi1jYW52YXMgewogICAgICAgICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgICB9CgogICAgICAgICN0aW1lbGluZS1jYW52YXMgewogICAgICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgIHRvcDogMDsKICAgICAgICAgICAgbGVmdDogMDsKICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICAgICAgei1pbmRleDogMTA7CiAgICAgICAgfQoKICAgICAgICAjY2FudmFzLWNvbnRhaW5lci50aW1lbGluZS1tb2RlICN0aW1lbGluZS1jYW52YXMgewogICAgICAgICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgICB9CgogICAgICAgICNjYW52YXMtY29udGFpbmVyLnRpbWVsaW5lLW1vZGUgLmxhbmUgewogICAgICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgIH0KCiAgICAgICAgLmxhbmUtbGFiZWwgewogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgIHRvcDogMTVweDsKICAgICAgICAgICAgbGVmdDogMTVweDsKICAgICAgICAgICAgZm9udC1zaXplOiAzMnB4OwogICAgICAgICAgICBmb250LXdlaWdodDogNzAwOwogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA4KTsKICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICAgICAgICAgIGxldHRlci1zcGFjaW5nOiAycHg7CiAgICAgICAgfQoKICAgICAgICAjbm8tbWlkaS1tZXNzYWdlIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICB0b3A6IDUwJTsKICAgICAgICAgICAgbGVmdDogNTAlOwogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgICAgICBjb2xvcjogIzY2NjsKICAgICAgICAgICAgZm9udC1zaXplOiAxOHB4OwogICAgICAgICAgICBsaW5lLWhlaWdodDogMS44OwogICAgICAgICAgICBtYXgtd2lkdGg6IDYwMHB4OwogICAgICAgICAgICBwYWRkaW5nOiA0MHB4OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDIpOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAxMnB4OwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjMzMzOwogICAgICAgIH0KCiAgICAgICAgI25vLW1pZGktbWVzc2FnZSBoMiB7CiAgICAgICAgICAgIGNvbG9yOiAjOTk5OwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAyMHB4OwogICAgICAgICAgICBmb250LXNpemU6IDI0cHg7CiAgICAgICAgfQoKICAgICAgICAjbm8tbWlkaS1tZXNzYWdlLmhpZGRlbiB7CiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICAgICAgfQoKICAgICAgICAuaW5mby1idXR0b24gewogICAgICAgICAgICBwYWRkaW5nOiA2cHggMTJweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzMzMzsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgIzU1NTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4OwogICAgICAgICAgICBjb2xvcjogI2ZmZjsKICAgICAgICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzOwogICAgICAgIH0KCiAgICAgICAgLmluZm8tYnV0dG9uOmhvdmVyIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzQ0NDsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiAjNzc3OwogICAgICAgIH0KCiAgICAgICAgI2luZm8tbW9kYWwgewogICAgICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIHRvcDogMDsKICAgICAgICAgICAgbGVmdDogMDsKICAgICAgICAgICAgcmlnaHQ6IDA7CiAgICAgICAgICAgIGJvdHRvbTogMDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjk1KTsKICAgICAgICAgICAgei1pbmRleDogMjAwMDsKICAgICAgICAgICAgb3ZlcmZsb3cteTogYXV0bzsKICAgICAgICAgICAgcGFkZGluZzogNDBweCAyMHB4OwogICAgICAgIH0KCiAgICAgICAgI2luZm8tbW9kYWwudmlzaWJsZSB7CiAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOwogICAgICAgIH0KCiAgICAgICAgLm1vZGFsLWNvbnRlbnQgewogICAgICAgICAgICBtYXgtd2lkdGg6IDkwMHB4OwogICAgICAgICAgICBtYXJnaW46IDAgYXV0bzsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzFhMWExYTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgICAgICAgICAgcGFkZGluZzogNDBweDsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgIzMzMzsKICAgICAgICB9CgogICAgICAgIC5tb2RhbC1jb250ZW50IGgyIHsKICAgICAgICAgICAgbWFyZ2luLXRvcDogMzBweDsKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsKICAgICAgICAgICAgY29sb3I6ICNmZmY7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjRweDsKICAgICAgICB9CgogICAgICAgIC5tb2RhbC1jb250ZW50IGgyOmZpcnN0LWNoaWxkIHsKICAgICAgICAgICAgbWFyZ2luLXRvcDogMDsKICAgICAgICB9CgogICAgICAgIC5tb2RhbC1jb250ZW50IHAsIC5tb2RhbC1jb250ZW50IGxpIHsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuODsKICAgICAgICAgICAgY29sb3I6ICNjY2M7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgICAgICAgfQoKICAgICAgICAubW9kYWwtY29udGVudCB1bCB7CiAgICAgICAgICAgIG1hcmdpbi1sZWZ0OiAyMHB4OwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAyMHB4OwogICAgICAgIH0KCiAgICAgICAgLm1vZGFsLWNvbnRlbnQgY29kZSB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMwMDA7CiAgICAgICAgICAgIHBhZGRpbmc6IDJweCA2cHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDNweDsKICAgICAgICAgICAgZm9udC1mYW1pbHk6ICdDb3VyaWVyIE5ldycsIG1vbm9zcGFjZTsKICAgICAgICAgICAgY29sb3I6ICMwZjA7CiAgICAgICAgfQoKICAgICAgICAuY2xvc2UtYnV0dG9uIHsKICAgICAgICAgICAgZmxvYXQ6IHJpZ2h0OwogICAgICAgICAgICBmb250LXNpemU6IDMycHg7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiAzMDA7CiAgICAgICAgICAgIGNvbG9yOiAjNjY2OwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxOwogICAgICAgICAgICBwYWRkaW5nOiAwIDEwcHg7CiAgICAgICAgfQoKICAgICAgICAuY2xvc2UtYnV0dG9uOmhvdmVyIHsKICAgICAgICAgICAgY29sb3I6ICNmZmY7CiAgICAgICAgfQoKICAgICAgICAuaW5zdHJ1bWVudC1leGFtcGxlcyB7CiAgICAgICAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZml0LCBtaW5tYXgoMjAwcHgsIDFmcikpOwogICAgICAgICAgICBnYXA6IDE1cHg7CiAgICAgICAgICAgIG1hcmdpbjogMjBweCAwOwogICAgICAgIH0KCiAgICAgICAgLmluc3RydW1lbnQtZXhhbXBsZSB7CiAgICAgICAgICAgIHBhZGRpbmc6IDE1cHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgIzMzMzsKICAgICAgICB9CgogICAgICAgIC5pbnN0cnVtZW50LWV4YW1wbGUgaDMgewogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4OwogICAgICAgICAgICBmb250LXNpemU6IDE2cHg7CiAgICAgICAgfQoKICAgICAgICAuaW5zdHJ1bWVudC1leGFtcGxlIHAgewogICAgICAgICAgICBmb250LXNpemU6IDEzcHg7CiAgICAgICAgICAgIGNvbG9yOiAjOTk5OwogICAgICAgIH0KICAgIDwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+CiAgICA8YnV0dG9uIGlkPSJjb250cm9sLXRvZ2dsZSIgb25jbGljaz0idG9nZ2xlQ29udHJvbHMoKSI+4pqZIFNldHRpbmdzPC9idXR0b24+CgogICAgPGRpdiBpZD0iY29udHJvbC1wYW5lbCI+CiAgICAgICAgPGgxPk5ld3RvbidzIENocm9tYXRpYyBNSURJIFZpc3VhbGl6ZXI8L2gxPgogICAgICAgIAogICAgICAgIDxkaXYgY2xhc3M9Im1vZGUtdG9nZ2xlIj4KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibW9kZS1idXR0b24gYWN0aXZlIiBvbmNsaWNrPSJzZXRWaWV3TW9kZSgnbGFuZXMnKSI+TGFuZXMgTW9kZTwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJtb2RlLWJ1dHRvbiIgb25jbGljaz0ic2V0Vmlld01vZGUoJ2NvbWJpbmF0aW9uJykiPkNvbWJpbmF0aW9uIE1vZGU8L2J1dHRvbj4KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibW9kZS1idXR0b24iIG9uY2xpY2s9InNldFZpZXdNb2RlKCd0aW1lbGluZScpIj5UaW1lbGluZSBWaWV3PC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICAgICAgCiAgICAgICAgPGRpdiBjbGFzcz0ibGFuZS1jb250cm9sIj4KICAgICAgICAgICAgPGxhYmVsPkxhbmUgMTo8L2xhYmVsPgogICAgICAgICAgICA8c2VsZWN0IGlkPSJkZXZpY2Utc2VsZWN0LTAiPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3QgTUlESSBEZXZpY2UuLi48L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgIDxzZWxlY3QgaWQ9Imluc3RydW1lbnQtc2VsZWN0LTAiPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibWVsb2R5Ij5NZWxvZHk8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImJhc3MiPkJhc3M8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImNob3JkcyI+Q2hvcmRzPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJwZXJjdXNzaW9uIj5QZXJjdXNzaW9uPC9vcHRpb24+CiAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICA8c3BhbiBjbGFzcz0iaW5zdHJ1bWVudC1iYWRnZSBpbnN0cnVtZW50LW1lbG9keSIgaWQ9Imluc3RydW1lbnQtYmFkZ2UtMCI+TUVMT0RZPC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ibm90ZS1jb3VudCIgaWQ9Im5vdGUtY291bnQtMCI+MCBub3Rlczwvc3Bhbj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBjbGFzcz0ibGFuZS1jb250cm9sIj4KICAgICAgICAgICAgPGxhYmVsPkxhbmUgMjo8L2xhYmVsPgogICAgICAgICAgICA8c2VsZWN0IGlkPSJkZXZpY2Utc2VsZWN0LTEiPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3QgTUlESSBEZXZpY2UuLi48L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgIDxzZWxlY3QgaWQ9Imluc3RydW1lbnQtc2VsZWN0LTEiPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iY2hvcmRzIj5DaG9yZHM8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Im1lbG9keSI+TWVsb2R5PC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJiYXNzIj5CYXNzPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJwZXJjdXNzaW9uIj5QZXJjdXNzaW9uPC9vcHRpb24+CiAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICA8c3BhbiBjbGFzcz0iaW5zdHJ1bWVudC1iYWRnZSBpbnN0cnVtZW50LWNob3JkcyIgaWQ9Imluc3RydW1lbnQtYmFkZ2UtMSI+Q0hPUkRTPC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ibm90ZS1jb3VudCIgaWQ9Im5vdGUtY291bnQtMSI+MCBub3Rlczwvc3Bhbj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBjbGFzcz0ibGFuZS1jb250cm9sIj4KICAgICAgICAgICAgPGxhYmVsPkxhbmUgMzo8L2xhYmVsPgogICAgICAgICAgICA8c2VsZWN0IGlkPSJkZXZpY2Utc2VsZWN0LTIiPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3QgTUlESSBEZXZpY2UuLi48L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgIDxzZWxlY3QgaWQ9Imluc3RydW1lbnQtc2VsZWN0LTIiPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iYmFzcyI+QmFzczwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibWVsb2R5Ij5NZWxvZHk8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImNob3JkcyI+Q2hvcmRzPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJwZXJjdXNzaW9uIj5QZXJjdXNzaW9uPC9vcHRpb24+CiAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICA8c3BhbiBjbGFzcz0iaW5zdHJ1bWVudC1iYWRnZSBpbnN0cnVtZW50LWJhc3MiIGlkPSJpbnN0cnVtZW50LWJhZGdlLTIiPkJBU1M8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJub3RlLWNvdW50IiBpZD0ibm90ZS1jb3VudC0yIj4wIG5vdGVzPC9zcGFuPgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJsYW5lLWNvbnRyb2wiPgogICAgICAgICAgICA8bGFiZWw+TGFuZSA0OjwvbGFiZWw+CiAgICAgICAgICAgIDxzZWxlY3QgaWQ9ImRldmljZS1zZWxlY3QtMyI+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPlNlbGVjdCBNSURJIERldmljZS4uLjwvb3B0aW9uPgogICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgPHNlbGVjdCBpZD0iaW5zdHJ1bWVudC1zZWxlY3QtMyI+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJwZXJjdXNzaW9uIj5QZXJjdXNzaW9uPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJtZWxvZHkiPk1lbG9keTwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iY2hvcmRzIj5DaG9yZHM8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImJhc3MiPkJhc3M8L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJpbnN0cnVtZW50LWJhZGdlIGluc3RydW1lbnQtcGVyY3Vzc2lvbiIgaWQ9Imluc3RydW1lbnQtYmFkZ2UtMyI+UEVSQ1VTU0lPTjwvc3Bhbj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9Im5vdGUtY291bnQiIGlkPSJub3RlLWNvdW50LTMiPjAgbm90ZXM8L3NwYW4+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9ImxhbmUtY29udHJvbCI+CiAgICAgICAgICAgIDxsYWJlbD5UaGVtZTo8L2xhYmVsPgogICAgICAgICAgICA8c2VsZWN0IGlkPSJ0aGVtZS1zZWxlY3QiIG9uY2hhbmdlPSJzZXRUaGVtZSh0aGlzLnZhbHVlKSI+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJkYXJrIj5EYXJrIE1vZGU8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImxpZ2h0Ij5MaWdodCBNb2RlPC9vcHRpb24+CiAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJsYW5lLWNvbnRyb2wiIHN0eWxlPSJib3JkZXItdG9wOiAxcHggc29saWQgIzMzMzsgcGFkZGluZy10b3A6IDE1cHg7IG1hcmdpbi10b3A6IDEwcHg7Ij4KICAgICAgICAgICAgPGxhYmVsPlBhdHRlcm4gQ2xlYXIgQWZ0ZXI6PC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IHR5cGU9Im51bWJlciIgaWQ9InRvdGFsLW5vdGVzLXRocmVzaG9sZCIgbWluPSIxMCIgbWF4PSIyMDAiIHZhbHVlPSI1MCIgCiAgICAgICAgICAgICAgICAgICBvbmNoYW5nZT0idXBkYXRlVG90YWxOb3Rlc1RocmVzaG9sZCh0aGlzLnZhbHVlKSIgCiAgICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDgwcHg7IHBhZGRpbmc6IDhweDsgYmFja2dyb3VuZDogIzFhMWExYTsgYm9yZGVyOiAxcHggc29saWQgIzQ0NDsgY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDRweDsiPgogICAgICAgICAgICA8c3BhbiBzdHlsZT0ib3BhY2l0eTogMC42OyBmb250LXNpemU6IDEycHg7Ij5ub3RlcyAodG90YWwpPC9zcGFuPgogICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDExcHg7IG9wYWNpdHk6IDAuNTsgbWFyZ2luLXRvcDogNXB4OyBsaW5lLWhlaWdodDogMS40OyI+CiAgICAgICAgICAgICAgICBQYXR0ZXJuIGNsZWFycyBhZnRlciB0aGlzIG1hbnkgdG90YWwgbm90ZXMgT1IgMjQgdW5pcXVlIG5vdGVzICh3aGljaGV2ZXIgY29tZXMgZmlyc3QpCiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJsYW5lLWNvbnRyb2wiIHN0eWxlPSJib3JkZXItdG9wOiAxcHggc29saWQgIzMzMzsgcGFkZGluZy10b3A6IDE1cHg7IG1hcmdpbi10b3A6IDEwcHg7Ij4KICAgICAgICAgICAgPGxhYmVsPlJlY29yZGluZzo8L2xhYmVsPgogICAgICAgICAgICA8YnV0dG9uIGlkPSJyZWNvcmQtYnRuIiBvbmNsaWNrPSJ0b2dnbGVSZWNvcmRpbmcoKSIgCiAgICAgICAgICAgICAgICAgICAgc3R5bGU9InBhZGRpbmc6IDEwcHggMjBweDsgYmFja2dyb3VuZDogI2M0MWUzYTsgYm9yZGVyOiBub25lOyBjb2xvcjogI2ZmZjsgYm9yZGVyLXJhZGl1czogNHB4OyBjdXJzb3I6IHBvaW50ZXI7IGZvbnQtd2VpZ2h0OiBib2xkOyBtYXJnaW4tcmlnaHQ6IDEwcHg7Ij4KICAgICAgICAgICAgICAgIOKPuiBTdGFydCBSZWNvcmRpbmcKICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gaWQ9ImNsZWFyLXJlY29yZGluZy1idG4iIG9uY2xpY2s9ImNsZWFyUmVjb3JkaW5nKCkiIAogICAgICAgICAgICAgICAgICAgIHN0eWxlPSJwYWRkaW5nOiAxMHB4IDIwcHg7IGJhY2tncm91bmQ6ICM0NDQ7IGJvcmRlcjogbm9uZTsgY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDRweDsgY3Vyc29yOiBwb2ludGVyOyI+CiAgICAgICAgICAgICAgICDwn5eR77iPIENsZWFyIFJlY29yZGluZwogICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgPGRpdiBpZD0icmVjb3JkaW5nLWluZm8iIHN0eWxlPSJmb250LXNpemU6IDEycHg7IG9wYWNpdHk6IDAuNzsgbWFyZ2luLXRvcDogOHB4OyI+CiAgICAgICAgICAgICAgICA8c3BhbiBpZD0icmVjb3JkaW5nLXN0YXR1cyI+Tm90IHJlY29yZGluZzwvc3Bhbj4gfCAKICAgICAgICAgICAgICAgIDxzcGFuIGlkPSJyZWNvcmRpbmctZHVyYXRpb24iPjA6MDA8L3NwYW4+IHwgCiAgICAgICAgICAgICAgICA8c3BhbiBpZD0icmVjb3JkZWQtbm90ZXMtY291bnQiPjAgbm90ZXM8L3NwYW4+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8YnV0dG9uIGNsYXNzPSJpbmZvLWJ1dHRvbiIgb25jbGljaz0idG9nZ2xlSW5mbygpIj7ihLnvuI8gSW5mbzwvYnV0dG9uPgogICAgICAgIDxidXR0b24gY2xhc3M9ImluZm8tYnV0dG9uIiBpZD0iY2xlYXItcGF0dGVybi1idG4iIG9uY2xpY2s9ImNsZWFyQ29tYmluYXRpb25QYXR0ZXJuKCkiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+8J+Xke+4jyBDbGVhciBQYXR0ZXJuPC9idXR0b24+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGlkPSJjYW52YXMtY29udGFpbmVyIj4KICAgICAgICA8Y2FudmFzIGlkPSJjb21iaW5hdGlvbi1jYW52YXMiPjwvY2FudmFzPgogICAgICAgIDxjYW52YXMgaWQ9InRpbWVsaW5lLWNhbnZhcyI+PC9jYW52YXM+CiAgICAgICAgCiAgICAgICAgPGRpdiBjbGFzcz0ibGFuZSI+CiAgICAgICAgICAgIDxjYW52YXMgaWQ9ImNhbnZhcy0wIj48L2NhbnZhcz4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibGFuZS1sYWJlbCI+TEFORSAxPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ibGFuZSI+CiAgICAgICAgICAgIDxjYW52YXMgaWQ9ImNhbnZhcy0xIj48L2NhbnZhcz4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibGFuZS1sYWJlbCI+TEFORSAyPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ibGFuZSI+CiAgICAgICAgICAgIDxjYW52YXMgaWQ9ImNhbnZhcy0yIj48L2NhbnZhcz4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibGFuZS1sYWJlbCI+TEFORSAzPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ibGFuZSI+CiAgICAgICAgICAgIDxjYW52YXMgaWQ9ImNhbnZhcy0zIj48L2NhbnZhcz4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibGFuZS1sYWJlbCI+TEFORSA0PC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGlkPSJuby1taWRpLW1lc3NhZ2UiPgogICAgICAgIDxoMj5ObyBNSURJIERldmljZXMgRGV0ZWN0ZWQ8L2gyPgogICAgICAgIDxwPlBsZWFzZSBjb25uZWN0IGEgTUlESSBjb250cm9sbGVyIG9yIHNldCB1cCBhbiBJQUMgRHJpdmVyIGZvciBMb2dpYyBQcm8uPC9wPgogICAgICAgIDxwIHN0eWxlPSJtYXJnaW4tdG9wOiAyMHB4OyBmb250LXNpemU6IDE0cHg7Ij4KICAgICAgICAgICAgPHN0cm9uZz5Vc2luZyBDaHJvbWUsIEVkZ2UsIG9yIE9wZXJhPzwvc3Ryb25nPiBUaGVzZSBicm93c2VycyBzdXBwb3J0IFdlYiBNSURJLjxicj4KICAgICAgICAgICAgU2FmYXJpIGhhcyBsaW1pdGVkIHN1cHBvcnQuCiAgICAgICAgPC9wPgogICAgPC9kaXY+CgogICAgPGRpdiBpZD0iaW5mby1tb2RhbCI+CiAgICAgICAgPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJjbG9zZS1idXR0b24iIG9uY2xpY2s9InRvZ2dsZUluZm8oKSI+JnRpbWVzOzwvc3Bhbj4KICAgICAgICAgICAgPGgyPkVuaGFuY2VkIE1JREkgVmlzdWFsaXplcjwvaDI+CiAgICAgICAgICAgIDxwPlJlYWwtdGltZSBNSURJIHZpc3VhbGl6YXRpb24gd2l0aCBOZXd0b24ncyBjb2xvciBtYXBwaW5nIGFuZCBpbnN0cnVtZW50LXNwZWNpZmljIHJlbmRlcmluZyBtb2Rlcy48L3A+CgogICAgICAgICAgICA8aDI+VmlldyBNb2RlczwvaDI+CiAgICAgICAgICAgIDxwPjxzdHJvbmc+TGFuZXMgTW9kZTo8L3N0cm9uZz4gVGhyZWUgc2VwYXJhdGUgbGFuZXMsIGVhY2ggd2l0aCBpdHMgb3duIE1JREkgaW5wdXQgYW5kIGluc3RydW1lbnQgdmlzdWFsaXphdGlvbjwvcD4KICAgICAgICAgICAgPHA+PHN0cm9uZz5Db21iaW5hdGlvbiBNb2RlOjwvc3Ryb25nPiBBbGwgTUlESSBpbnB1dHMgY29tYmluZWQgaW50byBhbiBvcmJpdGFsIHZpc3VhbGl6YXRpb24gLSBlYWNoIG5vdGUgY3JlYXRlcyBhIGNvbG9yZWQgcmluZyB0aGF0IG9yYml0cyBhcm91bmQgYSBjZW50cmFsIG51Y2xldXMuIFRoZSBhbmdsZSBvZiBlYWNoIG9yYml0IGlzIGRldGVybWluZWQgYnkgcGl0Y2gsIGFuZCB0aGUgc2l6ZS90aGlja25lc3MgaXMgY29udHJvbGxlZCBieSB2ZWxvY2l0eS48L3A+CgogICAgICAgICAgICA8aDI+SW5zdHJ1bWVudCBUeXBlczwvaDI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9Imluc3RydW1lbnQtZXhhbXBsZXMiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaW5zdHJ1bWVudC1leGFtcGxlIiBzdHlsZT0iYm9yZGVyLWNvbG9yOiAjOGIwMGZmOyI+CiAgICAgICAgICAgICAgICAgICAgPGgzPvCfjrggQkFTUzwvaDM+CiAgICAgICAgICAgICAgICAgICAgPHA+RnVsbC1sYW5lIGNvbG9yIGZpbGwgYmFzZWQgb24gY3VycmVudCBub3RlLiBWZWxvY2l0eSBjb250cm9scyBmYWRlIHNwZWVkIGJldHdlZW4gbm90ZXMgdXNpbmcgYWRkaXRpdmUgUkdCIGNvbG9yIG1peGluZy48L3A+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imluc3RydW1lbnQtZXhhbXBsZSIgc3R5bGU9ImJvcmRlci1jb2xvcjogIzAwYThmZjsiPgogICAgICAgICAgICAgICAgICAgIDxoMz7wn465IENIT1JEUzwvaDM+CiAgICAgICAgICAgICAgICAgICAgPHA+TGFuZSBzcGxpdCBpbnRvIDUgaG9yaXpvbnRhbCB6b25lcyBmb3IgY2hvcmQgbm90ZXMuIEFkZGl0aXZlIGNvbG9yIGJsZW5kaW5nIHdpdGggNTAlIGdyYWRpZW50IGNyZWF0ZXMgaGFybW9uaW91cyBjb2xvciBjaG9yZHMuPC9wPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0cnVtZW50LWV4YW1wbGUiIHN0eWxlPSJib3JkZXItY29sb3I6ICNmZjZiMDA7Ij4KICAgICAgICAgICAgICAgICAgICA8aDM+8J+OtSBNRUxPRFk8L2gzPgogICAgICAgICAgICAgICAgICAgIDxwPkxhcmdlIGNpcmNsZXMgd2l0aCBzb2Z0IGJsZW5kZWQgZWRnZXMuIEVuaGFuY2VkIGZyb20gb3JpZ2luYWwgZGVzaWduIGZvciBwcm9taW5lbnQgbWVsb2RpYyBsaW5lcy48L3A+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imluc3RydW1lbnQtZXhhbXBsZSIgc3R5bGU9ImJvcmRlci1jb2xvcjogI2ZmMDA4MDsiPgogICAgICAgICAgICAgICAgICAgIDxoMz7wn6WBIFBFUkNVU1NJT048L2gzPgogICAgICAgICAgICAgICAgICAgIDxwPkV4cGxvc2l2ZSBidXJzdHMgcmFkaWF0aW5nIGZyb20gbm90ZSBwb3NpdGlvbi4gQnVyc3Qgc2l6ZSBzY2FsZXMgd2l0aCB2ZWxvY2l0eSBmb3IgZHluYW1pYyB2aXN1YWwgaW1wYWN0LjwvcD4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxoMj5Db2xvciBNYXBwaW5nPC9oMj4KICAgICAgICAgICAgPHA+QmFzZWQgb24gTmV3dG9uJ3Mgc3BlY3RydW0gd2l0aCBDPVZpb2xldCAoMzgwLTQxMG5tKSB0aHJvdWdoIEI9UmVkICg3MjAtNzUwbm0pLiBDb2xvcnMgaW50ZXJwb2xhdGUgYWNyb3NzIG9jdGF2ZXMgdXNpbmcgd2F2ZWxlbmd0aCBwaHlzaWNzLjwvcD4KCiAgICAgICAgICAgIDxoMj5Ib3cgdG8gVXNlPC9oMj4KICAgICAgICAgICAgPHVsPgogICAgICAgICAgICAgICAgPGxpPlNlbGVjdCB2aWV3IG1vZGU6IExhbmVzIG9yIENvbWJpbmF0aW9uPC9saT4KICAgICAgICAgICAgICAgIDxsaT5Db25uZWN0IE1JREkgZGV2aWNlcyB0byBlYWNoIGxhbmU8L2xpPgogICAgICAgICAgICAgICAgPGxpPkNob29zZSBpbnN0cnVtZW50IHR5cGUgZm9yIGVhY2ggbGFuZTwvbGk+CiAgICAgICAgICAgICAgICA8bGk+UGxheSBhbmQgd2F0Y2ggdGhlIHZpc3VhbGl6YXRpb24gcmVzcG9uZCE8L2xpPgogICAgICAgICAgICA8L3VsPgoKICAgICAgICAgICAgPGgyPkFkZGl0aXZlIENvbG9yIE1peGluZzwvaDI+CiAgICAgICAgICAgIDxwPkJhc3MgYW5kIENob3JkcyBtb2RlcyB1c2UgUkdCIGFkZGl0aXZlIGNvbG9yIG1peGluZzo8L3A+CiAgICAgICAgICAgIDx1bD4KICAgICAgICAgICAgICAgIDxsaT5NdWx0aXBsZSBub3RlcyBibGVuZCB0b2dldGhlciBsaWtlIGxpZ2h0IHdhdmVzPC9saT4KICAgICAgICAgICAgICAgIDxsaT5DcmVhdGVzIG5hdHVyYWwgaGFybW9uaWMgY29sb3IgY29tYmluYXRpb25zPC9saT4KICAgICAgICAgICAgICAgIDxsaT5WZWxvY2l0eS1iYXNlZCBncmFkaWVudHMgZm9yIHNtb290aCB0cmFuc2l0aW9uczwvbGk+CiAgICAgICAgICAgIDwvdWw+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8c2NyaXB0PgogICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAvLyBDT0xPUiBFTkdJTkUgLSBOZXd0b24ncyBDaHJvbWF0aWMgTWFwcGluZwogICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAKICAgICAgICBjb25zdCBQSVRDSF9DTEFTU0VTID0gewogICAgICAgICAgICAwOiB7IG5hbWU6ICdDJywgY29sb3JOYW1lOiAnVmlvbGV0JywgbWluV2F2ZWxlbmd0aDogMzgwLCBtYXhXYXZlbGVuZ3RoOiA0MTAgfSwKICAgICAgICAgICAgMTogeyBuYW1lOiAnQyMnLCBjb2xvck5hbWU6ICdJbmRpZ28tVmlvbGV0JywgbWluV2F2ZWxlbmd0aDogNDEwLCBtYXhXYXZlbGVuZ3RoOiA0NDAgfSwKICAgICAgICAgICAgMjogeyBuYW1lOiAnRCcsIGNvbG9yTmFtZTogJ0luZGlnbycsIG1pbldhdmVsZW5ndGg6IDQ0MCwgbWF4V2F2ZWxlbmd0aDogNDcwIH0sCiAgICAgICAgICAgIDM6IHsgbmFtZTogJ0QjJywgY29sb3JOYW1lOiAnQmx1ZScsIG1pbldhdmVsZW5ndGg6IDQ3MCwgbWF4V2F2ZWxlbmd0aDogNTEwIH0sCiAgICAgICAgICAgIDQ6IHsgbmFtZTogJ0UnLCBjb2xvck5hbWU6ICdCbHVlLUN5YW4nLCBtaW5XYXZlbGVuZ3RoOiA1MTAsIG1heFdhdmVsZW5ndGg6IDU0MCB9LAogICAgICAgICAgICA1OiB7IG5hbWU6ICdGJywgY29sb3JOYW1lOiAnQ3lhbi1HcmVlbicsIG1pbldhdmVsZW5ndGg6IDU0MCwgbWF4V2F2ZWxlbmd0aDogNTcwIH0sCiAgICAgICAgICAgIDY6IHsgbmFtZTogJ0YjJywgY29sb3JOYW1lOiAnR3JlZW4nLCBtaW5XYXZlbGVuZ3RoOiA1NzAsIG1heFdhdmVsZW5ndGg6IDYwMCB9LAogICAgICAgICAgICA3OiB7IG5hbWU6ICdHJywgY29sb3JOYW1lOiAnWWVsbG93LUdyZWVuJywgbWluV2F2ZWxlbmd0aDogNjAwLCBtYXhXYXZlbGVuZ3RoOiA2MzAgfSwKICAgICAgICAgICAgODogeyBuYW1lOiAnRyMnLCBjb2xvck5hbWU6ICdZZWxsb3cnLCBtaW5XYXZlbGVuZ3RoOiA2MzAsIG1heFdhdmVsZW5ndGg6IDY2MCB9LAogICAgICAgICAgICA5OiB7IG5hbWU6ICdBJywgY29sb3JOYW1lOiAnT3JhbmdlJywgbWluV2F2ZWxlbmd0aDogNjYwLCBtYXhXYXZlbGVuZ3RoOiA2OTAgfSwKICAgICAgICAgICAgMTA6IHsgbmFtZTogJ0EjJywgY29sb3JOYW1lOiAnUmVkLU9yYW5nZScsIG1pbldhdmVsZW5ndGg6IDY5MCwgbWF4V2F2ZWxlbmd0aDogNzIwIH0sCiAgICAgICAgICAgIDExOiB7IG5hbWU6ICdCJywgY29sb3JOYW1lOiAnUmVkJywgbWluV2F2ZWxlbmd0aDogNzIwLCBtYXhXYXZlbGVuZ3RoOiA3NTAgfQogICAgICAgIH07CgogICAgICAgIGNsYXNzIENvbG9yRW5naW5lIHsKICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yVGFibGUgPSBuZXcgTWFwKCk7CiAgICAgICAgICAgICAgICB0aGlzLmdlbmVyYXRlQ29sb3JUYWJsZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBub3RlVG9XYXZlbGVuZ3RoKG1pZGlOb3RlKSB7CiAgICAgICAgICAgICAgICBjb25zdCBwaXRjaENsYXNzID0gbWlkaU5vdGUgJSAxMjsKICAgICAgICAgICAgICAgIGNvbnN0IG9jdGF2ZSA9IE1hdGguZmxvb3IobWlkaU5vdGUgLyAxMikgLSAxOwogICAgICAgICAgICAgICAgY29uc3QgcGl0Y2hJbmZvID0gUElUQ0hfQ0xBU1NFU1twaXRjaENsYXNzXTsKICAgICAgICAgICAgICAgIGNvbnN0IHsgbWluV2F2ZWxlbmd0aCwgbWF4V2F2ZWxlbmd0aCB9ID0gcGl0Y2hJbmZvOwogICAgICAgICAgICAgICAgY29uc3QgY29sb3JPY3RhdmUgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxMCwgb2N0YXZlKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbWluV2F2ZWxlbmd0aCArIChjb2xvck9jdGF2ZSAvIDEwKSAqIChtYXhXYXZlbGVuZ3RoIC0gbWluV2F2ZWxlbmd0aCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHdhdmVsZW5ndGhUb1JHQih3YXZlbGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBsZXQgciA9IDAsIGcgPSAwLCBiID0gMDsKCiAgICAgICAgICAgICAgICBpZiAod2F2ZWxlbmd0aCA8IDM4MCB8fCB3YXZlbGVuZ3RoID4gNzUwKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgcjogMCwgZzogMCwgYjogMCwgaGV4OiAnIzAwMDAwMCcgfTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAod2F2ZWxlbmd0aCA+PSAzODAgJiYgd2F2ZWxlbmd0aCA8IDQ0MCkgewogICAgICAgICAgICAgICAgICAgIHIgPSAtKHdhdmVsZW5ndGggLSA0NDApIC8gKDQ0MCAtIDM4MCk7CiAgICAgICAgICAgICAgICAgICAgYiA9IDEuMDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAod2F2ZWxlbmd0aCA+PSA0NDAgJiYgd2F2ZWxlbmd0aCA8IDQ5MCkgewogICAgICAgICAgICAgICAgICAgIGcgPSAod2F2ZWxlbmd0aCAtIDQ0MCkgLyAoNDkwIC0gNDQwKTsKICAgICAgICAgICAgICAgICAgICBiID0gMS4wOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh3YXZlbGVuZ3RoID49IDQ5MCAmJiB3YXZlbGVuZ3RoIDwgNTEwKSB7CiAgICAgICAgICAgICAgICAgICAgZyA9IDEuMDsKICAgICAgICAgICAgICAgICAgICBiID0gLSh3YXZlbGVuZ3RoIC0gNTEwKSAvICg1MTAgLSA0OTApOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh3YXZlbGVuZ3RoID49IDUxMCAmJiB3YXZlbGVuZ3RoIDwgNTgwKSB7CiAgICAgICAgICAgICAgICAgICAgciA9ICh3YXZlbGVuZ3RoIC0gNTEwKSAvICg1ODAgLSA1MTApOwogICAgICAgICAgICAgICAgICAgIGcgPSAxLjA7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHdhdmVsZW5ndGggPj0gNTgwICYmIHdhdmVsZW5ndGggPCA2NDUpIHsKICAgICAgICAgICAgICAgICAgICByID0gMS4wOwogICAgICAgICAgICAgICAgICAgIGcgPSAtKHdhdmVsZW5ndGggLSA2NDUpIC8gKDY0NSAtIDU4MCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHdhdmVsZW5ndGggPj0gNjQ1ICYmIHdhdmVsZW5ndGggPD0gNzUwKSB7CiAgICAgICAgICAgICAgICAgICAgciA9IDEuMDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBsZXQgaW50ZW5zaXR5ID0gMS4wOwogICAgICAgICAgICAgICAgaWYgKHdhdmVsZW5ndGggPj0gMzgwICYmIHdhdmVsZW5ndGggPCA0MjApIHsKICAgICAgICAgICAgICAgICAgICBpbnRlbnNpdHkgPSAwLjMgKyAwLjcgKiAod2F2ZWxlbmd0aCAtIDM4MCkgLyAoNDIwIC0gMzgwKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAod2F2ZWxlbmd0aCA+PSA3MDAgJiYgd2F2ZWxlbmd0aCA8PSA3NTApIHsKICAgICAgICAgICAgICAgICAgICBpbnRlbnNpdHkgPSAwLjMgKyAwLjcgKiAoNzUwIC0gd2F2ZWxlbmd0aCkgLyAoNzUwIC0gNzAwKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zdCByMjU1ID0gTWF0aC5yb3VuZChNYXRoLnBvdyhyICogaW50ZW5zaXR5LCAwLjgpICogMjU1KTsKICAgICAgICAgICAgICAgIGNvbnN0IGcyNTUgPSBNYXRoLnJvdW5kKE1hdGgucG93KGcgKiBpbnRlbnNpdHksIDAuOCkgKiAyNTUpOwogICAgICAgICAgICAgICAgY29uc3QgYjI1NSA9IE1hdGgucm91bmQoTWF0aC5wb3coYiAqIGludGVuc2l0eSwgMC44KSAqIDI1NSk7CgogICAgICAgICAgICAgICAgcmV0dXJuIHsgCiAgICAgICAgICAgICAgICAgICAgcjogcjI1NSwgCiAgICAgICAgICAgICAgICAgICAgZzogZzI1NSwgCiAgICAgICAgICAgICAgICAgICAgYjogYjI1NSwgCiAgICAgICAgICAgICAgICAgICAgaGV4OiBgIyR7cjI1NS50b1N0cmluZygxNikucGFkU3RhcnQoMiwgJzAnKX0ke2cyNTUudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJyl9JHtiMjU1LnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpfWAudG9VcHBlckNhc2UoKQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZ2V0Q29sb3IobWlkaU5vdGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbG9yVGFibGUuZ2V0KG1pZGlOb3RlKSB8fCB7IHI6IDAsIGc6IDAsIGI6IDAsIGhleDogJyMwMDAwMDAnIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGdldE5vdGVOYW1lKG1pZGlOb3RlKSB7CiAgICAgICAgICAgICAgICBjb25zdCBwaXRjaENsYXNzID0gbWlkaU5vdGUgJSAxMjsKICAgICAgICAgICAgICAgIGNvbnN0IG9jdGF2ZSA9IE1hdGguZmxvb3IobWlkaU5vdGUgLyAxMikgLSAxOwogICAgICAgICAgICAgICAgcmV0dXJuIGAke1BJVENIX0NMQVNTRVNbcGl0Y2hDbGFzc10ubmFtZX0ke29jdGF2ZX1gOwogICAgICAgICAgICB9CgogICAgICAgICAgICBnZW5lcmF0ZUNvbG9yVGFibGUoKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBtaWRpTm90ZSA9IDA7IG1pZGlOb3RlIDw9IDEyNzsgbWlkaU5vdGUrKykgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHdhdmVsZW5ndGggPSB0aGlzLm5vdGVUb1dhdmVsZW5ndGgobWlkaU5vdGUpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbG9yID0gdGhpcy53YXZlbGVuZ3RoVG9SR0Iod2F2ZWxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2xvclRhYmxlLnNldChtaWRpTm90ZSwgY29sb3IpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBBZGRpdGl2ZSBSR0IgY29sb3IgbWl4aW5nCiAgICAgICAgICAgIG1peENvbG9ycyhjb2xvcnMsIHdlaWdodHMgPSBudWxsKSB7CiAgICAgICAgICAgICAgICBpZiAoY29sb3JzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgcjogMCwgZzogMCwgYjogMCB9OwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBsZXQgdG90YWxSID0gMCwgdG90YWxHID0gMCwgdG90YWxCID0gMDsKICAgICAgICAgICAgICAgIGNvbnN0IHcgPSB3ZWlnaHRzIHx8IGNvbG9ycy5tYXAoKCkgPT4gMSk7CiAgICAgICAgICAgICAgICBjb25zdCB0b3RhbFdlaWdodCA9IHcucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7CgogICAgICAgICAgICAgICAgY29sb3JzLmZvckVhY2goKGNvbG9yLCBpKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2VpZ2h0ID0gd1tpXSAvIHRvdGFsV2VpZ2h0OwogICAgICAgICAgICAgICAgICAgIHRvdGFsUiArPSBjb2xvci5yICogd2VpZ2h0OwogICAgICAgICAgICAgICAgICAgIHRvdGFsRyArPSBjb2xvci5nICogd2VpZ2h0OwogICAgICAgICAgICAgICAgICAgIHRvdGFsQiArPSBjb2xvci5iICogd2VpZ2h0OwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICByOiBNYXRoLm1pbigyNTUsIE1hdGgucm91bmQodG90YWxSKSksCiAgICAgICAgICAgICAgICAgICAgZzogTWF0aC5taW4oMjU1LCBNYXRoLnJvdW5kKHRvdGFsRykpLAogICAgICAgICAgICAgICAgICAgIGI6IE1hdGgubWluKDI1NSwgTWF0aC5yb3VuZCh0b3RhbEIpKQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29uc3QgY29sb3JFbmdpbmUgPSBuZXcgQ29sb3JFbmdpbmUoKTsKCiAgICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICAgIC8vIEVOSEFOQ0VEIE1JREkgVklTVUFMSVpFUgogICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiAgICAgICAgY2xhc3MgTUlESVZpc3VhbGl6ZXIgewogICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgICAgIHRoaXMubWlkaUFjY2VzcyA9IG51bGw7CiAgICAgICAgICAgICAgICB0aGlzLnZpZXdNb2RlID0gJ2xhbmVzJzsgLy8gJ2xhbmVzJyBvciAnY29tYmluYXRpb24nCiAgICAgICAgICAgICAgICB0aGlzLnRoZW1lID0gJ2RhcmsnOyAvLyAnZGFyaycgb3IgJ2xpZ2h0JwogICAgICAgICAgICAgICAgdGhpcy5sYW5lcyA9IFsKICAgICAgICAgICAgICAgICAgICB7IGFjdGl2ZU5vdGVzOiBuZXcgTWFwKCksIGNvbm5lY3RlZERldmljZTogbnVsbCwgY2FudmFzOiBudWxsLCBjdHg6IG51bGwsIGluc3RydW1lbnQ6ICdtZWxvZHknLCBwcmV2Q29sb3I6IG51bGwsIGZhZGVTdGFydFRpbWU6IG51bGwgfSwKICAgICAgICAgICAgICAgICAgICB7IGFjdGl2ZU5vdGVzOiBuZXcgTWFwKCksIGNvbm5lY3RlZERldmljZTogbnVsbCwgY2FudmFzOiBudWxsLCBjdHg6IG51bGwsIGluc3RydW1lbnQ6ICdjaG9yZHMnLCBwcmV2Q29sb3I6IG51bGwsIGZhZGVTdGFydFRpbWU6IG51bGwgfSwKICAgICAgICAgICAgICAgICAgICB7IGFjdGl2ZU5vdGVzOiBuZXcgTWFwKCksIGNvbm5lY3RlZERldmljZTogbnVsbCwgY2FudmFzOiBudWxsLCBjdHg6IG51bGwsIGluc3RydW1lbnQ6ICdiYXNzJywgcHJldkNvbG9yOiBudWxsLCBmYWRlU3RhcnRUaW1lOiBudWxsIH0sCiAgICAgICAgICAgICAgICAgICAgeyBhY3RpdmVOb3RlczogbmV3IE1hcCgpLCBjb25uZWN0ZWREZXZpY2U6IG51bGwsIGNhbnZhczogbnVsbCwgY3R4OiBudWxsLCBpbnN0cnVtZW50OiAncGVyY3Vzc2lvbicsIHByZXZDb2xvcjogbnVsbCwgZmFkZVN0YXJ0VGltZTogbnVsbCB9CiAgICAgICAgICAgICAgICBdOwogICAgICAgICAgICAgICAgdGhpcy5jb21iaW5hdGlvbkNhbnZhcyA9IG51bGw7CiAgICAgICAgICAgICAgICB0aGlzLmNvbWJpbmF0aW9uQ3R4ID0gbnVsbDsKICAgICAgICAgICAgICAgIHRoaXMuZGV2aWNlcyA9IFtdOwogICAgICAgICAgICAgICAgdGhpcy5kZWNheVRpbWUgPSAxMDAwOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBQYXR0ZXJuIGNvbXBsZXRpb24gdHJhY2tpbmcgZm9yIGNvbWJpbmF0aW9uIG1vZGUKICAgICAgICAgICAgICAgIHRoaXMuY29tYmluYXRpb25Ob3RlcyA9IG5ldyBNYXAoKTsgLy8gUGVyc2lzdGVudCBub3RlcyBpbiBjb21iaW5hdGlvbiBtb2RlCiAgICAgICAgICAgICAgICB0aGlzLm5vdGVTZXF1ZW5jZSA9IFtdOyAvLyBUcmFjayBvcmRlciBvZiBub3RlcyBhZGRlZAogICAgICAgICAgICAgICAgdGhpcy5tYXhOb3Rlc0JlZm9yZUNsZWFyID0gMjQ7IC8vIDM2MMKwIC8gMTXCsCA9IDI0IG5vdGVzIGZvciBmdWxsIGNpcmNsZQogICAgICAgICAgICAgICAgdGhpcy5pc0NsZWFyaW5nID0gZmFsc2U7IC8vIEZsYWcgdG8gcHJldmVudCBhZGRpbmcgbm90ZXMgZHVyaW5nIGNsZWFyCiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsTm90ZXNQbGF5ZWQgPSAwOyAvLyBUcmFjayB0b3RhbCBub3RlcyBpbmNsdWRpbmcgcmVwZWF0cwogICAgICAgICAgICAgICAgdGhpcy5tYXhUb3RhbE5vdGVzID0gNTA7IC8vIENsZWFyIGFmdGVyIDUwIHRvdGFsIG5vdGVzIChpbmNsdWRpbmcgcmVwZWF0cykKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gUmVjb3JkaW5nIHN5c3RlbQogICAgICAgICAgICAgICAgdGhpcy5pc1JlY29yZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy5yZWNvcmRpbmdTdGFydFRpbWUgPSBudWxsOwogICAgICAgICAgICAgICAgdGhpcy5yZWNvcmRlZE5vdGVzID0gW107IC8vIEFycmF5IG9mIHttaWRpTm90ZSwgdmVsb2NpdHksIHN0YXJ0VGltZSwgZW5kVGltZSwgbGFuZUluZGV4LCBjb2xvcn0KICAgICAgICAgICAgICAgIHRoaXMucmVjb3JkaW5nRHVyYXRpb24gPSAwOyAvLyBUb3RhbCBkdXJhdGlvbiBpbiBtcwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0aGlzLmluaXQoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYXN5bmMgaW5pdCgpIHsKICAgICAgICAgICAgICAgIC8vIFNldHVwIGxhbmUgY2FudmFzZXMKICAgICAgICAgICAgICAgIHRoaXMubGFuZXMuZm9yRWFjaCgobGFuZSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgICAgICBsYW5lLmNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjYW52YXMtJHtpbmRleH1gKTsKICAgICAgICAgICAgICAgICAgICBsYW5lLmN0eCA9IGxhbmUuY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemVDYW52YXMoaW5kZXgpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIEluc3RydW1lbnQgc2VsZWN0IGhhbmRsZXIKICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnN0cnVtZW50U2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGluc3RydW1lbnQtc2VsZWN0LSR7aW5kZXh9YCk7CiAgICAgICAgICAgICAgICAgICAgaW5zdHJ1bWVudFNlbGVjdC52YWx1ZSA9IGxhbmUuaW5zdHJ1bWVudDsKICAgICAgICAgICAgICAgICAgICBpbnN0cnVtZW50U2VsZWN0Lm9uY2hhbmdlID0gKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBsYW5lLmluc3RydW1lbnQgPSBpbnN0cnVtZW50U2VsZWN0LnZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUluc3RydW1lbnRCYWRnZShpbmRleCk7CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUluc3RydW1lbnRCYWRnZShpbmRleCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAvLyBTZXR1cCBjb21iaW5hdGlvbiBjYW52YXMKICAgICAgICAgICAgICAgIHRoaXMuY29tYmluYXRpb25DYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tYmluYXRpb24tY2FudmFzJyk7CiAgICAgICAgICAgICAgICB0aGlzLmNvbWJpbmF0aW9uQ3R4ID0gdGhpcy5jb21iaW5hdGlvbkNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICAgICAgICAgICAgdGhpcy5yZXNpemVDb21iaW5hdGlvbkNhbnZhcygpOwoKICAgICAgICAgICAgICAgIC8vIFNldHVwIHRpbWVsaW5lIGNhbnZhcwogICAgICAgICAgICAgICAgdGhpcy50aW1lbGluZUNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aW1lbGluZS1jYW52YXMnKTsKICAgICAgICAgICAgICAgIHRoaXMudGltZWxpbmVDdHggPSB0aGlzLnRpbWVsaW5lQ2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZVRpbWVsaW5lQ2FudmFzKCk7CgogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0NvbWJpbmF0aW9uIGNhbnZhcyBpbml0aWFsaXplZDonLCB7CiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMuY29tYmluYXRpb25DYW52YXMud2lkdGgsCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmNvbWJpbmF0aW9uQ2FudmFzLmhlaWdodCwKICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmNvbWJpbmF0aW9uQ2FudmFzKS5kaXNwbGF5CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMubGFuZXMuZm9yRWFjaCgoXywgaW5kZXgpID0+IHRoaXMucmVzaXplQ2FudmFzKGluZGV4KSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemVDb21iaW5hdGlvbkNhbnZhcygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplVGltZWxpbmVDYW52YXMoKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIC8vIFJlcXVlc3QgTUlESSBhY2Nlc3MKICAgICAgICAgICAgICAgIGlmIChuYXZpZ2F0b3IucmVxdWVzdE1JRElBY2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1pZGlBY2Nlc3MgPSBhd2FpdCBuYXZpZ2F0b3IucmVxdWVzdE1JRElBY2Nlc3MoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEZXZpY2VMaXN0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWlkaUFjY2Vzcy5vbnN0YXRlY2hhbmdlID0gKCkgPT4gdGhpcy51cGRhdGVEZXZpY2VMaXN0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZU5vTWlkaU1lc3NhZ2UoKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ01JREkgYWNjZXNzIGRlbmllZC4gUGxlYXNlIGFsbG93IE1JREkgYWNjZXNzIGluIHlvdXIgYnJvd3Nlci4nKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdXZWIgTUlESSBBUEkgbm90IHN1cHBvcnRlZC4gUGxlYXNlIHVzZSBDaHJvbWUsIEVkZ2UsIG9yIE9wZXJhLicpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXNpemVDYW52YXMobGFuZUluZGV4KSB7CiAgICAgICAgICAgICAgICBjb25zdCBjYW52YXMgPSB0aGlzLmxhbmVzW2xhbmVJbmRleF0uY2FudmFzOwogICAgICAgICAgICAgICAgY2FudmFzLndpZHRoID0gY2FudmFzLm9mZnNldFdpZHRoOwogICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IGNhbnZhcy5vZmZzZXRIZWlnaHQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJlc2l6ZUNvbWJpbmF0aW9uQ2FudmFzKCkgewogICAgICAgICAgICAgICAgdGhpcy5jb21iaW5hdGlvbkNhbnZhcy53aWR0aCA9IHRoaXMuY29tYmluYXRpb25DYW52YXMub2Zmc2V0V2lkdGg7CiAgICAgICAgICAgICAgICB0aGlzLmNvbWJpbmF0aW9uQ2FudmFzLmhlaWdodCA9IHRoaXMuY29tYmluYXRpb25DYW52YXMub2Zmc2V0SGVpZ2h0OwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXNpemVUaW1lbGluZUNhbnZhcygpIHsKICAgICAgICAgICAgICAgIHRoaXMudGltZWxpbmVDYW52YXMud2lkdGggPSB0aGlzLnRpbWVsaW5lQ2FudmFzLm9mZnNldFdpZHRoOwogICAgICAgICAgICAgICAgdGhpcy50aW1lbGluZUNhbnZhcy5oZWlnaHQgPSB0aGlzLnRpbWVsaW5lQ2FudmFzLm9mZnNldEhlaWdodDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdXBkYXRlSW5zdHJ1bWVudEJhZGdlKGxhbmVJbmRleCkgewogICAgICAgICAgICAgICAgY29uc3QgaW5zdHJ1bWVudCA9IHRoaXMubGFuZXNbbGFuZUluZGV4XS5pbnN0cnVtZW50OwogICAgICAgICAgICAgICAgY29uc3QgYmFkZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgaW5zdHJ1bWVudC1iYWRnZS0ke2xhbmVJbmRleH1gKTsKICAgICAgICAgICAgICAgIGJhZGdlLmNsYXNzTmFtZSA9IGBpbnN0cnVtZW50LWJhZGdlIGluc3RydW1lbnQtJHtpbnN0cnVtZW50fWA7CiAgICAgICAgICAgICAgICBiYWRnZS50ZXh0Q29udGVudCA9IGluc3RydW1lbnQudG9VcHBlckNhc2UoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdXBkYXRlRGV2aWNlTGlzdCgpIHsKICAgICAgICAgICAgICAgIHRoaXMuZGV2aWNlcyA9IFtdOwogICAgICAgICAgICAgICAgdGhpcy5taWRpQWNjZXNzLmlucHV0cy5mb3JFYWNoKGlucHV0ID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRldmljZXMucHVzaCh7IGlkOiBpbnB1dC5pZCwgbmFtZTogaW5wdXQubmFtZSB8fCAnVW5rbm93biBEZXZpY2UnIH0pOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgZGV2aWNlLXNlbGVjdC0ke2l9YCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gc2VsZWN0LnZhbHVlOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iIj5TZWxlY3QgTUlESSBEZXZpY2UuLi48L29wdGlvbj4nOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZGV2aWNlcy5mb3JFYWNoKGRldmljZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpOwogICAgICAgICAgICAgICAgICAgICAgICBvcHRpb24udmFsdWUgPSBkZXZpY2UuaWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbi50ZXh0Q29udGVudCA9IGRldmljZS5uYW1lOwogICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBzZWxlY3QudmFsdWUgPSBjdXJyZW50VmFsdWU7CiAgICAgICAgICAgICAgICAgICAgc2VsZWN0Lm9uY2hhbmdlID0gKCkgPT4gdGhpcy5jb25uZWN0RGV2aWNlVG9MYW5lKHNlbGVjdC52YWx1ZSwgaSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRoaXMuZGV2aWNlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWRlTm9NaWRpTWVzc2FnZSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dOb01pZGlNZXNzYWdlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbm5lY3REZXZpY2VUb0xhbmUoZGV2aWNlSWQsIGxhbmVJbmRleCkgewogICAgICAgICAgICAgICAgaWYgKCF0aGlzLm1pZGlBY2Nlc3MpIHJldHVybjsKCiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RGV2aWNlID0gdGhpcy5sYW5lc1tsYW5lSW5kZXhdLmNvbm5lY3RlZERldmljZTsKICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RGV2aWNlKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLm1pZGlBY2Nlc3MuaW5wdXRzLmdldChjdXJyZW50RGV2aWNlKTsKICAgICAgICAgICAgICAgICAgICBpZiAoaW5wdXQpIGlucHV0Lm9ubWlkaW1lc3NhZ2UgPSBudWxsOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChkZXZpY2VJZCkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gdGhpcy5taWRpQWNjZXNzLmlucHV0cy5nZXQoZGV2aWNlSWQpOwogICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dCkgewogICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5vbm1pZGltZXNzYWdlID0gKG1lc3NhZ2UpID0+IHRoaXMuaGFuZGxlTUlESU1lc3NhZ2UobWVzc2FnZSwgbGFuZUluZGV4KTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sYW5lc1tsYW5lSW5kZXhdLmNvbm5lY3RlZERldmljZSA9IGRldmljZUlkOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYW5lc1tsYW5lSW5kZXhdLmNvbm5lY3RlZERldmljZSA9IG51bGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGhhbmRsZU1JRElNZXNzYWdlKG1lc3NhZ2UsIGxhbmVJbmRleCkgewogICAgICAgICAgICAgICAgY29uc3QgW3N0YXR1cywgbm90ZSwgdmVsb2NpdHldID0gbWVzc2FnZS5kYXRhOwogICAgICAgICAgICAgICAgY29uc3QgY29tbWFuZCA9IHN0YXR1cyAmIDB4ZjA7CgogICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQgPT09IDB4OTAgJiYgdmVsb2NpdHkgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVOb3RlT24obm90ZSwgdmVsb2NpdHksIGxhbmVJbmRleCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbW1hbmQgPT09IDB4ODAgfHwgKGNvbW1hbmQgPT09IDB4OTAgJiYgdmVsb2NpdHkgPT09IDApKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVOb3RlT2ZmKG5vdGUsIGxhbmVJbmRleCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGhhbmRsZU5vdGVPbihtaWRpTm90ZSwgdmVsb2NpdHksIGxhbmVJbmRleCkgewogICAgICAgICAgICAgICAgY29uc3QgY29sb3IgPSBjb2xvckVuZ2luZS5nZXRDb2xvcihtaWRpTm90ZSk7CiAgICAgICAgICAgICAgICBjb25zdCBub3cgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29uc3Qgbm90ZURhdGEgPSB7CiAgICAgICAgICAgICAgICAgICAgbWlkaU5vdGUsCiAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgY29sb3IsCiAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBub3csCiAgICAgICAgICAgICAgICAgICAgcmVsZWFzZVRpbWU6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgbGFuZUluZGV4CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBSZWNvcmQgdGhlIG5vdGUgaWYgcmVjb3JkaW5nIGlzIGFjdGl2ZQogICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNSZWNvcmRpbmcpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCByZWNvcmRlZE5vdGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC4uLm5vdGVEYXRhLAogICAgICAgICAgICAgICAgICAgICAgICByZWNvcmRpbmdTdGFydFRpbWU6IG5vdyAtIHRoaXMucmVjb3JkaW5nU3RhcnRUaW1lLCAvLyBUaW1lIHJlbGF0aXZlIHRvIHJlY29yZGluZyBzdGFydAogICAgICAgICAgICAgICAgICAgICAgICBlbmRUaW1lOiBudWxsIC8vIFdpbGwgYmUgc2V0IG9uIG5vdGVPZmYKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHRoaXMucmVjb3JkZWROb3Rlcy5wdXNoKHJlY29yZGVkTm90ZSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVSZWNvcmRpbmdJbmZvKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRoaXMubGFuZXNbbGFuZUluZGV4XS5hY3RpdmVOb3Rlcy5zZXQobWlkaU5vdGUsIG5vdGVEYXRhKTsKICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTm90ZUNvdW50KGxhbmVJbmRleCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIEluIGNvbWJpbmF0aW9uIG1vZGUsIGFkZCB0byBwZXJzaXN0ZW50IGNvbGxlY3Rpb24KICAgICAgICAgICAgICAgIGlmICh0aGlzLnZpZXdNb2RlID09PSAnY29tYmluYXRpb24nKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYPCfjrUgQ29tYmluYXRpb24gbW9kZSAtIGlzQ2xlYXJpbmc6ICR7dGhpcy5pc0NsZWFyaW5nfSwgdW5pcXVlOiAke3RoaXMubm90ZVNlcXVlbmNlLmxlbmd0aH0sIHRvdGFsOiAke3RoaXMudG90YWxOb3Rlc1BsYXllZH1gKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0NsZWFyaW5nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfij7jvuI8gQ3VycmVudGx5IGNsZWFyaW5nLCBpZ25vcmluZyBub3RlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gQ291bnQgZXZlcnkgbm90ZSBwbGF5ZWQgKGluY2x1ZGluZyByZXBlYXRzKQogICAgICAgICAgICAgICAgICAgIHRoaXMudG90YWxOb3Rlc1BsYXllZCsrOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIEFkZCBub3RlIHRvIHBlcnNpc3RlbnQgY29sbGVjdGlvbiBpZiBub3QgYWxyZWFkeSB0aGVyZQogICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jb21iaW5hdGlvbk5vdGVzLmhhcyhtaWRpTm90ZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21iaW5hdGlvbk5vdGVzLnNldChtaWRpTm90ZSwgeyAuLi5ub3RlRGF0YSwgYWRkZWRJbmRleDogdGhpcy5ub3RlU2VxdWVuY2UubGVuZ3RoIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGVTZXF1ZW5jZS5wdXNoKG1pZGlOb3RlKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYOKchSBBZGRlZCBORVcgbm90ZSAke2NvbG9yRW5naW5lLmdldE5vdGVOYW1lKG1pZGlOb3RlKX0gYXQgaW5kZXggJHt0aGlzLm5vdGVTZXF1ZW5jZS5sZW5ndGggLSAxfSB8IFVuaXF1ZTogJHt0aGlzLm5vdGVTZXF1ZW5jZS5sZW5ndGh9LzI0IHwgVG90YWw6ICR7dGhpcy50b3RhbE5vdGVzUGxheWVkfS8ke3RoaXMubWF4VG90YWxOb3Rlc31gKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhpc3Rpbmcgbm90ZSAocmVmcmVzaCB2ZWxvY2l0eS90aW1lIGJ1dCBrZWVwIHBvc2l0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleGlzdGluZyA9IHRoaXMuY29tYmluYXRpb25Ob3Rlcy5nZXQobWlkaU5vdGUpOwogICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZy52ZWxvY2l0eSA9IHZlbG9jaXR5OwogICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZy5zdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmcucmVsZWFzZVRpbWUgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+UhCBVcGRhdGVkIGV4aXN0aW5nIG5vdGUgJHtjb2xvckVuZ2luZS5nZXROb3RlTmFtZShtaWRpTm90ZSl9IGF0IHBvc2l0aW9uICR7ZXhpc3RpbmcuYWRkZWRJbmRleH0gfCBVbmlxdWU6ICR7dGhpcy5ub3RlU2VxdWVuY2UubGVuZ3RofS8yNCB8IFRvdGFsOiAke3RoaXMudG90YWxOb3Rlc1BsYXllZH0vJHt0aGlzLm1heFRvdGFsTm90ZXN9YCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGNvbXBsZXRpb246IGVpdGhlciAyNCB1bmlxdWUgbm90ZXMgT1IgbWF4VG90YWxOb3RlcyBwbGF5ZWQKICAgICAgICAgICAgICAgICAgICBjb25zdCB1bmlxdWVDb21wbGV0ZSA9IHRoaXMubm90ZVNlcXVlbmNlLmxlbmd0aCA+PSB0aGlzLm1heE5vdGVzQmVmb3JlQ2xlYXI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG90YWxDb21wbGV0ZSA9IHRoaXMudG90YWxOb3Rlc1BsYXllZCA+PSB0aGlzLm1heFRvdGFsTm90ZXM7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKHVuaXF1ZUNvbXBsZXRlIHx8IHRvdGFsQ29tcGxldGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVhc29uID0gdW5pcXVlQ29tcGxldGUgPyAnMjQgdW5pcXVlIG5vdGVzJyA6IGAke3RoaXMubWF4VG90YWxOb3Rlc30gdG90YWwgbm90ZXNgOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+OifCfjonwn46JIFBBVFRFUk4gQ09NUExFVEUhICgke3JlYXNvbn0pIFN0YXJ0aW5nIGNsZWFyIHNlcXVlbmNlLi4uYCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNDbGVhcmluZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAvLyBDbGVhciBhZnRlciBzaG93aW5nIGNvbXBsZXRlIHBhdHRlcm4KICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn8J+nuSBDbGVhcmluZyBub3cuLi4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tYmluYXRpb25Ob3Rlcy5jbGVhcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RlU2VxdWVuY2UgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG90YWxOb3Rlc1BsYXllZCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzQ2xlYXJpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinKggUGF0dGVybiBjbGVhcmVkIC0gcmVhZHkgZm9yIG5ldyBwYXR0ZXJuISBBbGwgY291bnRzIHJlc2V0IHRvIDAnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSwgMjAwMCk7IC8vIDIgc2Vjb25kcyB0byBhZG1pcmUgdGhlIHBhdHRlcm4KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBOb3RlIE9OOiAke2NvbG9yRW5naW5lLmdldE5vdGVOYW1lKG1pZGlOb3RlKX0gaW4gTGFuZSAke2xhbmVJbmRleCArIDF9LCBNb2RlOiAke3RoaXMudmlld01vZGV9YCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGhhbmRsZU5vdGVPZmYobWlkaU5vdGUsIGxhbmVJbmRleCkgewogICAgICAgICAgICAgICAgY29uc3Qgbm90ZSA9IHRoaXMubGFuZXNbbGFuZUluZGV4XS5hY3RpdmVOb3Rlcy5nZXQobWlkaU5vdGUpOwogICAgICAgICAgICAgICAgaWYgKG5vdGUpIHsKICAgICAgICAgICAgICAgICAgICBub3RlLnJlbGVhc2VUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSByZWNvcmRlZCBub3RlJ3MgZW5kIHRpbWUgaWYgcmVjb3JkaW5nCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNSZWNvcmRpbmcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCB0aGUgbW9zdCByZWNlbnQgbm90ZSB3aXRoIHRoaXMgbWlkaU5vdGUgYW5kIGxhbmVJbmRleCB0aGF0IGRvZXNuJ3QgaGF2ZSBhbiBlbmRUaW1lCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSB0aGlzLnJlY29yZGVkTm90ZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlY05vdGUgPSB0aGlzLnJlY29yZGVkTm90ZXNbaV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVjTm90ZS5taWRpTm90ZSA9PT0gbWlkaU5vdGUgJiYgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjTm90ZS5sYW5lSW5kZXggPT09IGxhbmVJbmRleCAmJiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNOb3RlLmVuZFRpbWUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNOb3RlLmVuZFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHRoaXMucmVjb3JkaW5nU3RhcnRUaW1lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBOb3RlIE9GRjogJHtjb2xvckVuZ2luZS5nZXROb3RlTmFtZShtaWRpTm90ZSl9IGluIExhbmUgJHtsYW5lSW5kZXggKyAxfWApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBJbiBjb21iaW5hdGlvbiBtb2RlLCBub3RlcyBwZXJzaXN0IC0gZG9uJ3QgcmVtb3ZlIG9uIHJlbGVhc2UKICAgICAgICAgICAgICAgIC8vIFRoZXkgb25seSBjbGVhciB3aGVuIHBhdHRlcm4gaXMgY29tcGxldGUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdXBkYXRlTm90ZUNvdW50KGxhbmVJbmRleCkgewogICAgICAgICAgICAgICAgY29uc3QgY291bnQgPSB0aGlzLmxhbmVzW2xhbmVJbmRleF0uYWN0aXZlTm90ZXMuc2l6ZTsKICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgbm90ZS1jb3VudC0ke2xhbmVJbmRleH1gKTsKICAgICAgICAgICAgICAgIGVsZW1lbnQudGV4dENvbnRlbnQgPSBgJHtjb3VudH0gbm90ZSR7Y291bnQgIT09IDEgPyAncycgOiAnJ31gOwogICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCBjb3VudCA+IDApOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBMb2cgZm9yIGRlYnVnZ2luZwogICAgICAgICAgICAgICAgaWYgKHRoaXMudmlld01vZGUgPT09ICdjb21iaW5hdGlvbicpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0b3RhbE5vdGVzID0gdGhpcy5sYW5lcy5yZWR1Y2UoKHN1bSwgbGFuZSkgPT4gc3VtICsgbGFuZS5hY3RpdmVOb3Rlcy5zaXplLCAwKTsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgVG90YWwgYWN0aXZlIG5vdGVzOiAke3RvdGFsTm90ZXN9YCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAgICAgLy8gUkVOREVSSU5HIC0gSW5zdHJ1bWVudC1zcGVjaWZpYyB2aXN1YWxpemF0aW9ucwogICAgICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgogICAgICAgICAgICByZW5kZXJCYXNzKGxhbmUsIGN0eCwgY2FudmFzLCBub3cpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGJnQ29sb3IgPSB0aGlzLnRoZW1lID09PSAnZGFyaycgPyAnIzAwMCcgOiAnI2ZmZic7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIEdldCBtb3N0IHJlY2VudCBub3RlIChiYXNzIGxpbmVzIGFyZSB0eXBpY2FsbHkgbW9ub3Bob25pYykKICAgICAgICAgICAgICAgIGxldCBjdXJyZW50Tm90ZSA9IG51bGw7CiAgICAgICAgICAgICAgICBsZXQgbGF0ZXN0VGltZSA9IDA7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxhbmUuYWN0aXZlTm90ZXMuZm9yRWFjaChub3RlID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoIW5vdGUucmVsZWFzZVRpbWUgJiYgbm90ZS5zdGFydFRpbWUgPiBsYXRlc3RUaW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROb3RlID0gbm90ZTsKICAgICAgICAgICAgICAgICAgICAgICAgbGF0ZXN0VGltZSA9IG5vdGUuc3RhcnRUaW1lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Tm90ZSkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldENvbG9yID0gY3VycmVudE5vdGUuY29sb3I7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBwcmV2aW91cyBjb2xvciBpZiBuZWVkZWQKICAgICAgICAgICAgICAgICAgICBpZiAoIWxhbmUucHJldkNvbG9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxhbmUucHJldkNvbG9yID0gdGFyZ2V0Q29sb3I7CiAgICAgICAgICAgICAgICAgICAgICAgIGxhbmUuZmFkZVN0YXJ0VGltZSA9IG5vdzsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBmYWRlIHByb2dyZXNzIGJhc2VkIG9uIHZlbG9jaXR5IChoaWdoZXIgdmVsb2NpdHkgPSBsb25nZXIgZmFkZSkKICAgICAgICAgICAgICAgICAgICBjb25zdCBmYWRlU3BlZWQgPSA1MDAgKyAoY3VycmVudE5vdGUudmVsb2NpdHkgLyAxMjcpICogMTUwMDsgLy8gNTAwLTIwMDBtcwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZhZGVQcm9ncmVzcyA9IE1hdGgubWluKDEsIChub3cgLSBsYW5lLmZhZGVTdGFydFRpbWUpIC8gZmFkZVNwZWVkKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gQURESVRJVkUgUkdCIGxpZ2h0IG1peGluZyBmb3Igc21vb3RoIHRyYW5zaXRpb25zCiAgICAgICAgICAgICAgICAgICAgLy8gSW5zdGVhZCBvZiBsaW5lYXIgaW50ZXJwb2xhdGlvbiwgdXNlIGFkZGl0aXZlIGJsZW5kaW5nCiAgICAgICAgICAgICAgICAgICAgbGV0IHIsIGcsIGI7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKGZhZGVQcm9ncmVzcyA8IDAuNSkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBGaXJzdCBoYWxmOiBmYWRlIG91dCBvbGQgY29sb3IgdXNpbmcgYWRkaXRpdmUgYmxlbmQKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGZhZGVQcm9ncmVzcyAqIDI7IC8vIDAgdG8gMQogICAgICAgICAgICAgICAgICAgICAgICByID0gTWF0aC5yb3VuZChsYW5lLnByZXZDb2xvci5yICogKDEgLSB0KSArIHRhcmdldENvbG9yLnIgKiB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgZyA9IE1hdGgucm91bmQobGFuZS5wcmV2Q29sb3IuZyAqICgxIC0gdCkgKyB0YXJnZXRDb2xvci5nICogdCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBNYXRoLnJvdW5kKGxhbmUucHJldkNvbG9yLmIgKiAoMSAtIHQpICsgdGFyZ2V0Q29sb3IuYiAqIHQpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNlY29uZCBoYWxmOiBhZGRpdGl2ZSBibGVuZCB0aGVuIGZhZGUgdG8gdGFyZ2V0CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSAoZmFkZVByb2dyZXNzIC0gMC41KSAqIDI7IC8vIDAgdG8gMQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkaXRpdmUgbWl4CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1peFIgPSBNYXRoLm1pbigyNTUsIGxhbmUucHJldkNvbG9yLnIgKyB0YXJnZXRDb2xvci5yKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWl4RyA9IE1hdGgubWluKDI1NSwgbGFuZS5wcmV2Q29sb3IuZyArIHRhcmdldENvbG9yLmcpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtaXhCID0gTWF0aC5taW4oMjU1LCBsYW5lLnByZXZDb2xvci5iICsgdGFyZ2V0Q29sb3IuYik7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAvLyBCbGVuZCBmcm9tIGFkZGl0aXZlIG1peCB0byB0YXJnZXQKICAgICAgICAgICAgICAgICAgICAgICAgciA9IE1hdGgucm91bmQobWl4UiAqICgxIC0gdCkgKyB0YXJnZXRDb2xvci5yICogdCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBNYXRoLnJvdW5kKG1peEcgKiAoMSAtIHQpICsgdGFyZ2V0Q29sb3IuZyAqIHQpOwogICAgICAgICAgICAgICAgICAgICAgICBiID0gTWF0aC5yb3VuZChtaXhCICogKDEgLSB0KSArIHRhcmdldENvbG9yLmIgKiB0KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIEZpbGwgZW50aXJlIGxhbmUgd2l0aCBjb2xvcgogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBgcmdiKCR7cn0sICR7Z30sICR7Yn0pYDsKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsKCiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIGlmIGZhZGUgY29tcGxldGUKICAgICAgICAgICAgICAgICAgICBpZiAoZmFkZVByb2dyZXNzID49IDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGFuZS5wcmV2Q29sb3IgPSB0YXJnZXRDb2xvcjsKICAgICAgICAgICAgICAgICAgICAgICAgbGFuZS5mYWRlU3RhcnRUaW1lID0gbm93OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gRmFkZSB0byBiYWNrZ3JvdW5kIHdoZW4gbm8gbm90ZXMKICAgICAgICAgICAgICAgICAgICBpZiAobGFuZS5wcmV2Q29sb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmFkZVNwZWVkID0gMTAwMDsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmFkZVByb2dyZXNzID0gTWF0aC5taW4oMSwgKG5vdyAtIChsYW5lLmZhZGVTdGFydFRpbWUgfHwgbm93KSkgLyBmYWRlU3BlZWQpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gTWF0aC5yb3VuZChsYW5lLnByZXZDb2xvci5yICogKDEgLSBmYWRlUHJvZ3Jlc3MpKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZyA9IE1hdGgucm91bmQobGFuZS5wcmV2Q29sb3IuZyAqICgxIC0gZmFkZVByb2dyZXNzKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGIgPSBNYXRoLnJvdW5kKGxhbmUucHJldkNvbG9yLmIgKiAoMSAtIGZhZGVQcm9ncmVzcykpOwogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGByZ2IoJHtyfSwgJHtnfSwgJHtifSlgOwogICAgICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmYWRlUHJvZ3Jlc3MgPj0gMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFuZS5wcmV2Q29sb3IgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGJnQ29sb3I7CiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVuZGVyQ2hvcmRzKGxhbmUsIGN0eCwgY2FudmFzLCBub3cpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGJnQ29sb3IgPSB0aGlzLnRoZW1lID09PSAnZGFyaycgPyAnIzAwMCcgOiAnI2ZmZic7CiAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gYmdDb2xvcjsKICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpOwoKICAgICAgICAgICAgICAgIC8vIEdldCBhY3RpdmUgbm90ZXMgc29ydGVkIGJ5IHBpdGNoCiAgICAgICAgICAgICAgICBjb25zdCBhY3RpdmVOb3RlcyA9IEFycmF5LmZyb20obGFuZS5hY3RpdmVOb3Rlcy52YWx1ZXMoKSkKICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKG5vdGUgPT4gIW5vdGUucmVsZWFzZVRpbWUgfHwgKG5vdyAtIG5vdGUucmVsZWFzZVRpbWUgPCB0aGlzLmRlY2F5VGltZSkpCiAgICAgICAgICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGEubWlkaU5vdGUgLSBiLm1pZGlOb3RlKTsKCiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlTm90ZXMubGVuZ3RoID09PSAwKSByZXR1cm47CgogICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG9wYWNpdGllcwogICAgICAgICAgICAgICAgYWN0aXZlTm90ZXMuZm9yRWFjaCgobm90ZSkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmIChub3RlLnJlbGVhc2VUaW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGUuY3VycmVudE9wYWNpdHkgPSBNYXRoLm1heCgwLCAxIC0gKG5vdyAtIG5vdGUucmVsZWFzZVRpbWUpIC8gdGhpcy5kZWNheVRpbWUpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90ZS5jdXJyZW50T3BhY2l0eSA8PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYW5lLmFjdGl2ZU5vdGVzLmRlbGV0ZShub3RlLm1pZGlOb3RlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGUuY3VycmVudE9wYWNpdHkgPSAxLjA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgLy8gNSBob3Jpem9udGFsIHpvbmVzCiAgICAgICAgICAgICAgICBjb25zdCB6b25lcyA9IFswLjEsIDAuMywgMC41LCAwLjcsIDAuOV07CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIEFzc2lnbiB6b25lcyB0byBub3RlcwogICAgICAgICAgICAgICAgY29uc3Qgbm90ZVpvbmVzID0gYWN0aXZlTm90ZXMubWFwKChub3RlLCBpbmRleCkgPT4gewogICAgICAgICAgICAgICAgICAgIGxldCB6b25lWTsKICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlTm90ZXMubGVuZ3RoID09PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHpvbmVZID0gem9uZXNbMl07CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3RpdmVOb3Rlcy5sZW5ndGggPT09IDIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgem9uZVkgPSB6b25lc1tpbmRleCA9PT0gMCA/IDEgOiAzXTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB6b25lWSA9IHpvbmVzW01hdGgubWluKGluZGV4LCB6b25lcy5sZW5ndGggLSAxKV07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiB7IG5vdGUsIHpvbmVZLCBpbmRleCB9OwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgLy8gVXNlIGFkZGl0aXZlIGJsZW5kaW5nIG1vZGUgZm9yIHRoZSBlbnRpcmUgcmVuZGVyaW5nCiAgICAgICAgICAgICAgICBjdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ2xpZ2h0ZXInOwoKICAgICAgICAgICAgICAgIC8vIERyYXcgZWFjaCBub3RlIHdpdGggc21vb3RoIGdyYWRpZW50cwogICAgICAgICAgICAgICAgbm90ZVpvbmVzLmZvckVhY2goKHsgbm90ZSwgem9uZVksIGluZGV4IH0pID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCB5ID0gY2FudmFzLmhlaWdodCAqIHpvbmVZOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHpvbmVIZWlnaHQgPSBjYW52YXMuaGVpZ2h0ICogMC4xMjsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBHZXQgYWRqYWNlbnQgbm90ZXMgZm9yIHNtb290aGVyIGJsZW5kaW5nCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldk5vdGUgPSBpbmRleCA+IDAgPyBub3RlWm9uZXNbaW5kZXggLSAxXSA6IG51bGw7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dE5vdGUgPSBpbmRleCA8IG5vdGVab25lcy5sZW5ndGggLSAxID8gbm90ZVpvbmVzW2luZGV4ICsgMV0gOiBudWxsOwoKICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSB2ZXJ5IHNtb290aCBncmFkaWVudAogICAgICAgICAgICAgICAgICAgIGNvbnN0IGdyYWRpZW50SGVpZ2h0ID0gem9uZUhlaWdodCAqIDIuNTsgLy8gTGFyZ2VyIGdyYWRpZW50IGFyZWEKICAgICAgICAgICAgICAgICAgICBjb25zdCBncmFkaWVudCA9IGN0eC5jcmVhdGVMaW5lYXJHcmFkaWVudCgwLCB5IC0gZ3JhZGllbnRIZWlnaHQsIDAsIHkgKyBncmFkaWVudEhlaWdodCk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgdHJhbnNwYXJlbnQKICAgICAgICAgICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMCwgYHJnYmEoJHtub3RlLmNvbG9yLnJ9LCAke25vdGUuY29sb3IuZ30sICR7bm90ZS5jb2xvci5ifSwgMClgKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBCbGVuZCBmcm9tIHByZXZpb3VzIG5vdGUgaWYgZXhpc3RzCiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZOb3RlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZZID0gY2FudmFzLmhlaWdodCAqIHByZXZOb3RlLnpvbmVZOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBibGVuZFN0YXJ0ID0gMC4xNTsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNtb290aCB0cmFuc2l0aW9uIGZyb20gcHJldmlvdXMKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxlbmRSID0gTWF0aC5yb3VuZCgocHJldk5vdGUubm90ZS5jb2xvci5yICsgbm90ZS5jb2xvci5yKSAvIDIpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBibGVuZEcgPSBNYXRoLnJvdW5kKChwcmV2Tm90ZS5ub3RlLmNvbG9yLmcgKyBub3RlLmNvbG9yLmcpIC8gMik7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJsZW5kQiA9IE1hdGgucm91bmQoKHByZXZOb3RlLm5vdGUuY29sb3IuYiArIG5vdGUuY29sb3IuYikgLyAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxlbmRPcGFjaXR5ID0gKHByZXZOb3RlLm5vdGUuY3VycmVudE9wYWNpdHkgKyBub3RlLmN1cnJlbnRPcGFjaXR5KSAvIDI7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoYmxlbmRTdGFydCwgYHJnYmEoJHtibGVuZFJ9LCAke2JsZW5kR30sICR7YmxlbmRCfSwgJHtibGVuZE9wYWNpdHkgKiAwLjN9KWApOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBQZWFrIGF0IGNlbnRlciB3aXRoIG11bHRpcGxlIHN0b3BzIGZvciBzbW9vdGhuZXNzCiAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAuMzUsIGByZ2JhKCR7bm90ZS5jb2xvci5yfSwgJHtub3RlLmNvbG9yLmd9LCAke25vdGUuY29sb3IuYn0sICR7bm90ZS5jdXJyZW50T3BhY2l0eSAqIDAuNn0pYCk7CiAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAuNSwgYHJnYmEoJHtub3RlLmNvbG9yLnJ9LCAke25vdGUuY29sb3IuZ30sICR7bm90ZS5jb2xvci5ifSwgJHtub3RlLmN1cnJlbnRPcGFjaXR5fSlgKTsKICAgICAgICAgICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMC42NSwgYHJnYmEoJHtub3RlLmNvbG9yLnJ9LCAke25vdGUuY29sb3IuZ30sICR7bm90ZS5jb2xvci5ifSwgJHtub3RlLmN1cnJlbnRPcGFjaXR5ICogMC42fSlgKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBCbGVuZCB0byBuZXh0IG5vdGUgaWYgZXhpc3RzCiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHROb3RlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJsZW5kRW5kID0gMC44NTsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNtb290aCB0cmFuc2l0aW9uIHRvIG5leHQKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxlbmRSID0gTWF0aC5yb3VuZCgobm90ZS5jb2xvci5yICsgbmV4dE5vdGUubm90ZS5jb2xvci5yKSAvIDIpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBibGVuZEcgPSBNYXRoLnJvdW5kKChub3RlLmNvbG9yLmcgKyBuZXh0Tm90ZS5ub3RlLmNvbG9yLmcpIC8gMik7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJsZW5kQiA9IE1hdGgucm91bmQoKG5vdGUuY29sb3IuYiArIG5leHROb3RlLm5vdGUuY29sb3IuYikgLyAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxlbmRPcGFjaXR5ID0gKG5vdGUuY3VycmVudE9wYWNpdHkgKyBuZXh0Tm90ZS5ub3RlLmN1cnJlbnRPcGFjaXR5KSAvIDI7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoYmxlbmRFbmQsIGByZ2JhKCR7YmxlbmRSfSwgJHtibGVuZEd9LCAke2JsZW5kQn0sICR7YmxlbmRPcGFjaXR5ICogMC4zfSlgKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gRW5kIHRyYW5zcGFyZW50CiAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsIGByZ2JhKCR7bm90ZS5jb2xvci5yfSwgJHtub3RlLmNvbG9yLmd9LCAke25vdGUuY29sb3IuYn0sIDApYCk7CgogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBncmFkaWVudDsKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFJlY3QoMCwgeSAtIGdyYWRpZW50SGVpZ2h0LCBjYW52YXMud2lkdGgsIGdyYWRpZW50SGVpZ2h0ICogMik7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAvLyBEcmF3IHNtb290aCBpbnRlci1ub3RlIGJsZW5kcwogICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub3RlWm9uZXMubGVuZ3RoIC0gMTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IG5vdGVab25lc1tpXTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0ID0gbm90ZVpvbmVzW2kgKyAxXTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBjb25zdCB5MSA9IGNhbnZhcy5oZWlnaHQgKiBjdXJyZW50LnpvbmVZOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHkyID0gY2FudmFzLmhlaWdodCAqIG5leHQuem9uZVk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWlkWSA9ICh5MSArIHkyKSAvIDI7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxlbmRIZWlnaHQgPSBNYXRoLmFicyh5MiAtIHkxKSAqIDAuODsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdWx0cmEtc21vb3RoIGJsZW5kIGJldHdlZW4gbm90ZXMKICAgICAgICAgICAgICAgICAgICBjb25zdCBibGVuZEdyYWRpZW50ID0gY3R4LmNyZWF0ZUxpbmVhckdyYWRpZW50KDAsIG1pZFkgLSBibGVuZEhlaWdodC8yLCAwLCBtaWRZICsgYmxlbmRIZWlnaHQvMik7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gTXVsdGlwbGUgY29sb3Igc3RvcHMgZm9yIHNtb290aCB0cmFuc2l0aW9uCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RlcHMgPSA5OwogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHN0ZXAgPSAwOyBzdGVwIDw9IHN0ZXBzOyBzdGVwKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHN0ZXAgLyBzdGVwczsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IE1hdGgucm91bmQoY3VycmVudC5ub3RlLmNvbG9yLnIgKiAoMSAtIHQpICsgbmV4dC5ub3RlLmNvbG9yLnIgKiB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZyA9IE1hdGgucm91bmQoY3VycmVudC5ub3RlLmNvbG9yLmcgKiAoMSAtIHQpICsgbmV4dC5ub3RlLmNvbG9yLmcgKiB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYiA9IE1hdGgucm91bmQoY3VycmVudC5ub3RlLmNvbG9yLmIgKiAoMSAtIHQpICsgbmV4dC5ub3RlLmNvbG9yLmIgKiB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3BhY2l0eSA9IChjdXJyZW50Lm5vdGUuY3VycmVudE9wYWNpdHkgKiAoMSAtIHQpICsgbmV4dC5ub3RlLmN1cnJlbnRPcGFjaXR5ICogdCkgKiAwLjU7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBibGVuZEdyYWRpZW50LmFkZENvbG9yU3RvcCh0LCBgcmdiYSgke3J9LCAke2d9LCAke2J9LCAke29wYWNpdHl9KWApOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gYmxlbmRHcmFkaWVudDsKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFJlY3QoMCwgbWlkWSAtIGJsZW5kSGVpZ2h0LzIsIGNhbnZhcy53aWR0aCwgYmxlbmRIZWlnaHQpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIFJlc2V0IGNvbXBvc2l0ZSBvcGVyYXRpb24KICAgICAgICAgICAgICAgIGN0eC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnc291cmNlLW92ZXInOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZW5kZXJNZWxvZHkobGFuZSwgY3R4LCBjYW52YXMsIG5vdykgewogICAgICAgICAgICAgICAgY29uc3QgYmdDb2xvciA9IHRoaXMudGhlbWUgPT09ICdkYXJrJyA/ICcjMDAwJyA6ICcjZmZmJzsKICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBiZ0NvbG9yOwogICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7CgogICAgICAgICAgICAgICAgbGFuZS5hY3RpdmVOb3Rlcy5mb3JFYWNoKChub3RlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgbGV0IG9wYWNpdHkgPSAxLjA7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGUucmVsZWFzZVRpbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eSA9IE1hdGgubWF4KDAsIDEgLSAobm93IC0gbm90ZS5yZWxlYXNlVGltZSkgLyB0aGlzLmRlY2F5VGltZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcGFjaXR5IDw9IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbmUuYWN0aXZlTm90ZXMuZGVsZXRlKG5vdGUubWlkaU5vdGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBjb25zdCB4ID0gKG5vdGUubWlkaU5vdGUgLyAxMjcpICogY2FudmFzLndpZHRoOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHkgPSBjYW52YXMuaGVpZ2h0IC8gMjsKICAgICAgICAgICAgICAgICAgICBjb25zdCByYWRpdXMgPSAoMzAgKyAobm90ZS52ZWxvY2l0eSAvIDEyNykgKiA0MCkgKiA0OyAvLyA0MDAlIGxhcmdlciAoNHgpCgogICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSByYWRpYWwgZ3JhZGllbnQgZm9yIHNvZnQgYmxlbmRlZCBlZGdlcwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGdyYWRpZW50ID0gY3R4LmNyZWF0ZVJhZGlhbEdyYWRpZW50KHgsIHksIDAsIHgsIHksIHJhZGl1cyk7CiAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAsIGByZ2JhKCR7bm90ZS5jb2xvci5yfSwgJHtub3RlLmNvbG9yLmd9LCAke25vdGUuY29sb3IuYn0sICR7b3BhY2l0eX0pYCk7CiAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAuNywgYHJnYmEoJHtub3RlLmNvbG9yLnJ9LCAke25vdGUuY29sb3IuZ30sICR7bm90ZS5jb2xvci5ifSwgJHtvcGFjaXR5ICogMC41fSlgKTsKICAgICAgICAgICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMSwgYHJnYmEoJHtub3RlLmNvbG9yLnJ9LCAke25vdGUuY29sb3IuZ30sICR7bm90ZS5jb2xvci5ifSwgMClgKTsKCiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGdyYWRpZW50OwogICAgICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICBjdHguYXJjKHgsIHksIHJhZGl1cywgMCwgTWF0aC5QSSAqIDIpOwogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7CgogICAgICAgICAgICAgICAgICAgIC8vIE5vdGUgbmFtZSAtIGxhcmdlciB0ZXh0IHRvIG1hdGNoCiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGByZ2JhKDI1NSwgMjU1LCAyNTUsICR7b3BhY2l0eX0pYDsKICAgICAgICAgICAgICAgICAgICBjdHguZm9udCA9ICdib2xkIDMycHggbW9ub3NwYWNlJzsgLy8gTGFyZ2VyIGZvbnQKICAgICAgICAgICAgICAgICAgICBjdHgudGV4dEFsaWduID0gJ2NlbnRlcic7CiAgICAgICAgICAgICAgICAgICAgY3R4LnRleHRCYXNlbGluZSA9ICdtaWRkbGUnOwogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsVGV4dChjb2xvckVuZ2luZS5nZXROb3RlTmFtZShub3RlLm1pZGlOb3RlKSwgeCwgeSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVuZGVyUGVyY3Vzc2lvbihsYW5lLCBjdHgsIGNhbnZhcywgbm93KSB7CiAgICAgICAgICAgICAgICBjb25zdCBiZ0NvbG9yID0gdGhpcy50aGVtZSA9PT0gJ2RhcmsnID8gJyMwMDAnIDogJyNmZmYnOwogICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGJnQ29sb3I7CiAgICAgICAgICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsKCiAgICAgICAgICAgICAgICBsYW5lLmFjdGl2ZU5vdGVzLmZvckVhY2goKG5vdGUpID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBhZ2UgPSBub3RlLnJlbGVhc2VUaW1lID8gKG5vdyAtIG5vdGUucmVsZWFzZVRpbWUpIDogKG5vdyAtIG5vdGUuc3RhcnRUaW1lKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBidXJzdER1cmF0aW9uID0gMzAwOyAvLyBtcwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIChhZ2UgPiBidXJzdER1cmF0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxhbmUuYWN0aXZlTm90ZXMuZGVsZXRlKG5vdGUubWlkaU5vdGUpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9ncmVzcyA9IGFnZSAvIGJ1cnN0RHVyYXRpb247CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3BhY2l0eSA9IDEgLSBwcm9ncmVzczsKICAgICAgICAgICAgICAgICAgICBjb25zdCB4ID0gKG5vdGUubWlkaU5vdGUgLyAxMjcpICogY2FudmFzLndpZHRoOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHkgPSBjYW52YXMuaGVpZ2h0IC8gMjsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBCdXJzdCBzaXplIGJhc2VkIG9uIHZlbG9jaXR5CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF4UmFkaXVzID0gNTAgKyAobm90ZS52ZWxvY2l0eSAvIDEyNykgKiAxMDA7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFJhZGl1cyA9IG1heFJhZGl1cyAqIHByb2dyZXNzOwoKICAgICAgICAgICAgICAgICAgICAvLyBSYWRpYXRpbmcgcGFydGljbGVzCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFydGljbGVDb3VudCA9IE1hdGguZmxvb3IoOCArIChub3RlLnZlbG9jaXR5IC8gMTI3KSAqIDE2KTsKICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcnRpY2xlQ291bnQ7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhbmdsZSA9IChpIC8gcGFydGljbGVDb3VudCkgKiBNYXRoLlBJICogMjsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHggPSB4ICsgTWF0aC5jb3MoYW5nbGUpICogY3VycmVudFJhZGl1czsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHkgPSB5ICsgTWF0aC5zaW4oYW5nbGUpICogY3VycmVudFJhZGl1czsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmFyYyhweCwgcHksIDMgKyAobm90ZS52ZWxvY2l0eSAvIDEyNykgKiA1LCAwLCBNYXRoLlBJICogMik7CiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBgcmdiYSgke25vdGUuY29sb3Iucn0sICR7bm90ZS5jb2xvci5nfSwgJHtub3RlLmNvbG9yLmJ9LCAke29wYWNpdHl9KWA7CiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAvLyBDZW50cmFsIGZsYXNoCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ3JhZGllbnQgPSBjdHguY3JlYXRlUmFkaWFsR3JhZGllbnQoeCwgeSwgMCwgeCwgeSwgY3VycmVudFJhZGl1cyAqIDAuNSk7CiAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAsIGByZ2JhKCR7bm90ZS5jb2xvci5yfSwgJHtub3RlLmNvbG9yLmd9LCAke25vdGUuY29sb3IuYn0sICR7b3BhY2l0eX0pYCk7CiAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsIGByZ2JhKCR7bm90ZS5jb2xvci5yfSwgJHtub3RlLmNvbG9yLmd9LCAke25vdGUuY29sb3IuYn0sIDApYCk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGdyYWRpZW50OwogICAgICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICBjdHguYXJjKHgsIHksIGN1cnJlbnRSYWRpdXMgKiAwLjUsIDAsIE1hdGguUEkgKiAyKTsKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbCgpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJlbmRlckNvbWJpbmF0aW9uKG5vdykgewogICAgICAgICAgICAgICAgY29uc3QgY3R4ID0gdGhpcy5jb21iaW5hdGlvbkN0eDsKICAgICAgICAgICAgICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuY29tYmluYXRpb25DYW52YXM7CiAgICAgICAgICAgICAgICBjb25zdCBiZ0NvbG9yID0gdGhpcy50aGVtZSA9PT0gJ2RhcmsnID8gJyMwMDAnIDogJyNmZmYnOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gYmdDb2xvcjsKICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpOwoKICAgICAgICAgICAgICAgIGNvbnN0IGNlbnRlclggPSBjYW52YXMud2lkdGggLyAyOwogICAgICAgICAgICAgICAgY29uc3QgY2VudGVyWSA9IGNhbnZhcy5oZWlnaHQgLyAyOwogICAgICAgICAgICAgICAgY29uc3QgbWF4UmFkaXVzID0gTWF0aC5taW4oY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KSAqIDAuNDU7CgogICAgICAgICAgICAgICAgLy8gVXNlIHBlcnNpc3RlbnQgY29tYmluYXRpb24gbm90ZXMKICAgICAgICAgICAgICAgIGNvbnN0IGFsbE5vdGVzID0gQXJyYXkuZnJvbSh0aGlzLmNvbWJpbmF0aW9uTm90ZXMudmFsdWVzKCkpOwoKICAgICAgICAgICAgICAgIC8vIERyYXcgb3JiaXRhbCByaW5ncyBmb3IgZWFjaCBub3RlIC0gcm90YXRlIDE1JSAoNTQgZGVncmVlcykgcGVyIG5vdGUKICAgICAgICAgICAgICAgIGFsbE5vdGVzLmZvckVhY2goKG5vdGUpID0+IHsKICAgICAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgb3JiaXRhbCBwYXJhbWV0ZXJzIHVzaW5nIHRoZSBvcmRlciB0aGV5IHdlcmUgYWRkZWQKICAgICAgICAgICAgICAgICAgICBjb25zdCBub3RlQW5nbGUgPSAobm90ZS5taWRpTm90ZSAvIDEyNykgKiBNYXRoLlBJICogMjsKICAgICAgICAgICAgICAgICAgICBjb25zdCByb3RhdGlvblBlck5vdGUgPSAoMTUgLyAxMDApICogTWF0aC5QSSAqIDI7IC8vIDE1JSA9IDU0IGRlZ3JlZXMKICAgICAgICAgICAgICAgICAgICBjb25zdCB0b3RhbFJvdGF0aW9uID0gbm90ZUFuZ2xlICsgKG5vdGUuYWRkZWRJbmRleCAqIHJvdGF0aW9uUGVyTm90ZSk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmVsb2NpdHlGYWN0b3IgPSAobm90ZS52ZWxvY2l0eSAvIDEyNyk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gVmVsb2NpdHkgYWZmZWN0cyB0aGUgc2l6ZSBvZiB0aGUgb3JiaXQgKDAuNSB0byAxLjAgc2NhbGUpCiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmVsb2NpdHlTY2FsZSA9IDAuNSArIHZlbG9jaXR5RmFjdG9yICogMC41OwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGJhc2VSYWRpdXMgPSBtYXhSYWRpdXMgKiB2ZWxvY2l0eVNjYWxlOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIE1ha2Ugb3ZhbHMgbXVjaCBuYXJyb3dlciAtIGxpa2UgaW4gdGhlIHJlZmVyZW5jZSBpbWFnZQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhZGl1c1ggPSBiYXNlUmFkaXVzOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhZGl1c1kgPSBiYXNlUmFkaXVzICogMC40OyAvLyBPbmx5IDQwJSBoZWlnaHQgZm9yIG5hcnJvdyBvdmFscwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIFJpbmcgdGhpY2tuZXNzIGJhc2VkIG9uIHZlbG9jaXR5CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGhpY2tuZXNzID0gNCArIHZlbG9jaXR5RmFjdG9yICogMTA7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gRnVsbCBvcGFjaXR5IC0gbm90ZXMgcGVyc2lzdCB1bnRpbCBwYXR0ZXJuIGNvbXBsZXRlCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3BhY2l0eSA9IDEuMDsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgZ3JhZGllbnQgZm9yIHRoZSBvcmJpdGFsIHJpbmcKICAgICAgICAgICAgICAgICAgICBjdHguc2F2ZSgpOwogICAgICAgICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IG9wYWNpdHk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gRHJhdyB0aGUgb3JiaXRhbCBvdmFsCiAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgICAgIGN0eC5lbGxpcHNlKAogICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXJYLCAKICAgICAgICAgICAgICAgICAgICAgICAgY2VudGVyWSwgCiAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1c1gsIAogICAgICAgICAgICAgICAgICAgICAgICByYWRpdXNZLAogICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFJvdGF0aW9uLCAvLyBJbmRpdmlkdWFsIHJvdGF0aW9uIGZvciBlYWNoIG5vdGUKICAgICAgICAgICAgICAgICAgICAgICAgMCwgCiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguUEkgKiAyCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBTdHJva2Ugd2l0aCBjb2xvcgogICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGByZ2JhKCR7bm90ZS5jb2xvci5yfSwgJHtub3RlLmNvbG9yLmd9LCAke25vdGUuY29sb3IuYn0sICR7b3BhY2l0eSAqIDAuODV9KWA7CiAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IHRoaWNrbmVzczsKICAgICAgICAgICAgICAgICAgICBjdHgubGluZUNhcCA9ICdyb3VuZCc7CiAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZSgpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIEFkZCBzdWJ0bGUgaW5uZXIgZ2xvdwogICAgICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICBjdHguZWxsaXBzZSgKICAgICAgICAgICAgICAgICAgICAgICAgY2VudGVyWCwgCiAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlclksIAogICAgICAgICAgICAgICAgICAgICAgICByYWRpdXNYIC0gdGhpY2tuZXNzLzIsIAogICAgICAgICAgICAgICAgICAgICAgICByYWRpdXNZIC0gdGhpY2tuZXNzLzIsCiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsUm90YXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgIDAsIAogICAgICAgICAgICAgICAgICAgICAgICBNYXRoLlBJICogMgogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gYHJnYmEoJHtub3RlLmNvbG9yLnJ9LCAke25vdGUuY29sb3IuZ30sICR7bm90ZS5jb2xvci5ifSwgJHtvcGFjaXR5ICogMC4yfSlgOwogICAgICAgICAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSB0aGlja25lc3MgKiAwLjQ7CiAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZSgpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIERyYXcgYSBnbG93aW5nIGRvdCBhdCB0aGUgInRvcCIgb2YgZWFjaCBvcmJpdAogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvdFggPSBjZW50ZXJYICsgTWF0aC5jb3MoLU1hdGguUEkgLyAyICsgdG90YWxSb3RhdGlvbikgKiByYWRpdXNYOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvdFkgPSBjZW50ZXJZICsgTWF0aC5zaW4oLU1hdGguUEkgLyAyICsgdG90YWxSb3RhdGlvbikgKiByYWRpdXNZOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvdFJhZGl1cyA9IDMgKyB2ZWxvY2l0eUZhY3RvciAqIDY7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ3JhZGllbnQgPSBjdHguY3JlYXRlUmFkaWFsR3JhZGllbnQoZG90WCwgZG90WSwgMCwgZG90WCwgZG90WSwgZG90UmFkaXVzICogMi41KTsKICAgICAgICAgICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMCwgYHJnYmEoJHtub3RlLmNvbG9yLnJ9LCAke25vdGUuY29sb3IuZ30sICR7bm90ZS5jb2xvci5ifSwgJHtvcGFjaXR5fSlgKTsKICAgICAgICAgICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMC40LCBgcmdiYSgke25vdGUuY29sb3Iucn0sICR7bm90ZS5jb2xvci5nfSwgJHtub3RlLmNvbG9yLmJ9LCAke29wYWNpdHkgKiAwLjZ9KWApOwogICAgICAgICAgICAgICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgxLCBgcmdiYSgke25vdGUuY29sb3Iucn0sICR7bm90ZS5jb2xvci5nfSwgJHtub3RlLmNvbG9yLmJ9LCAwKWApOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBncmFkaWVudDsKICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgICAgICAgICAgICAgY3R4LmFyYyhkb3RYLCBkb3RZLCBkb3RSYWRpdXMgKiAyLjUsIDAsIE1hdGguUEkgKiAyKTsKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbCgpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIFNvbGlkIGNlbnRlciBkb3QKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gYHJnYmEoJHtub3RlLmNvbG9yLnJ9LCAke25vdGUuY29sb3IuZ30sICR7bm90ZS5jb2xvci5ifSwgJHtvcGFjaXR5fSlgOwogICAgICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICBjdHguYXJjKGRvdFgsIGRvdFksIGRvdFJhZGl1cywgMCwgTWF0aC5QSSAqIDIpOwogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBEcmF3IGNlbnRyYWwgbnVjbGV1cwogICAgICAgICAgICAgICAgaWYgKGFsbE5vdGVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBudWNsZXVzUmFkaXVzID0gMTA7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ3JhZGllbnQgPSBjdHguY3JlYXRlUmFkaWFsR3JhZGllbnQoY2VudGVyWCwgY2VudGVyWSwgMCwgY2VudGVyWCwgY2VudGVyWSwgbnVjbGV1c1JhZGl1cyAqIDMpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRoZW1lID09PSAnZGFyaycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAsICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOTUpJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgwLjQsICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNSknKTsKICAgICAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDApJyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAsICdyZ2JhKDAsIDAsIDAsIDAuOTUpJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgwLjQsICdyZ2JhKDAsIDAsIDAsIDAuNSknKTsKICAgICAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsICdyZ2JhKDAsIDAsIDAsIDApJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBncmFkaWVudDsKICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgICAgICAgICAgICAgY3R4LmFyYyhjZW50ZXJYLCBjZW50ZXJZLCBudWNsZXVzUmFkaXVzICogMywgMCwgTWF0aC5QSSAqIDIpOwogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gU29saWQgY2VudGVyCiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUgPT09ICdkYXJrJyA/ICcjZmZmJyA6ICcjMDAwJzsKICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgICAgICAgICAgICAgY3R4LmFyYyhjZW50ZXJYLCBjZW50ZXJZLCBudWNsZXVzUmFkaXVzLCAwLCBNYXRoLlBJICogMik7CiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGwoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gU2hvdyBwcm9ncmVzcyBpbmRpY2F0b3IKICAgICAgICAgICAgICAgIGlmIChhbGxOb3Rlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUgPT09ICdkYXJrJyA/ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNSknIDogJ3JnYmEoMCwgMCwgMCwgMC41KSc7CiAgICAgICAgICAgICAgICAgICAgY3R4LmZvbnQgPSAnMTRweCBtb25vc3BhY2UnOwogICAgICAgICAgICAgICAgICAgIGN0eC50ZXh0QWxpZ24gPSAnY2VudGVyJzsKICAgICAgICAgICAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gJ3RvcCc7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNDbGVhcmluZykgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBTaG93ICJDT01QTEVURSEiIG1lc3NhZ2Ugd2hlbiBwYXR0ZXJuIGlzIGZ1bGwKICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUgPT09ICdkYXJrJyA/ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOSknIDogJ3JnYmEoMCwgMCwgMCwgMC45KSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5mb250ID0gJ2JvbGQgMjRweCBzYW5zLXNlcmlmJzsKICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxUZXh0KCfwn46JIFBBVFRFUk4gQ09NUExFVEUhIPCfjoknLCBjZW50ZXJYLCAyMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5mb250ID0gJzE0cHggc2Fucy1zZXJpZic7CiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5maWxsVGV4dCgnQ2xlYXJpbmcuLi4nLCBjZW50ZXJYLCA1MCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2hvdyBib3RoIGNvdW50ZXJzCiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5maWxsVGV4dChgVW5pcXVlOiAke2FsbE5vdGVzLmxlbmd0aH0vMjQgfCBUb3RhbDogJHt0aGlzLnRvdGFsTm90ZXNQbGF5ZWR9LyR7dGhpcy5tYXhUb3RhbE5vdGVzfWAsIGNlbnRlclgsIDIwKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIENlbnRlciB0ZXh0IHdoZW4gbm8gbm90ZXMKICAgICAgICAgICAgICAgIGlmIChhbGxOb3Rlcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gdGhpcy50aGVtZSA9PT0gJ2RhcmsnID8gJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC4zKScgOiAncmdiYSgwLCAwLCAwLCAwLjMpJzsKICAgICAgICAgICAgICAgICAgICBjdHguZm9udCA9ICcxNnB4IHNhbnMtc2VyaWYnOwogICAgICAgICAgICAgICAgICAgIGN0eC50ZXh0QWxpZ24gPSAnY2VudGVyJzsKICAgICAgICAgICAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gJ21pZGRsZSc7CiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxUZXh0KCdQbGF5IG5vdGVzIHRvIGJ1aWxkIHBhdHRlcm4uLi4nLCBjZW50ZXJYLCBjZW50ZXJZKTsKICAgICAgICAgICAgICAgICAgICBjdHguZm9udCA9ICcxMnB4IHNhbnMtc2VyaWYnOwogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsVGV4dCgnKENsZWFycyBhZnRlciAyNCB1bmlxdWUgbm90ZXMgT1IgNTAgdG90YWwgbm90ZXMpJywgY2VudGVyWCwgY2VudGVyWSArIDI1KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVuZGVyVGltZWxpbmUoKSB7CiAgICAgICAgICAgICAgICBjb25zdCBjdHggPSB0aGlzLnRpbWVsaW5lQ3R4OwogICAgICAgICAgICAgICAgY29uc3QgY2FudmFzID0gdGhpcy50aW1lbGluZUNhbnZhczsKICAgICAgICAgICAgICAgIGNvbnN0IGJnQ29sb3IgPSB0aGlzLnRoZW1lID09PSAnZGFyaycgPyAnIzAwMCcgOiAnI2ZmZic7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBiZ0NvbG9yOwogICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7CgogICAgICAgICAgICAgICAgaWYgKHRoaXMucmVjb3JkZWROb3Rlcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgICAgICAvLyBTaG93IGluc3RydWN0aW9ucwogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lID09PSAnZGFyaycgPyAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjMpJyA6ICdyZ2JhKDAsIDAsIDAsIDAuMyknOwogICAgICAgICAgICAgICAgICAgIGN0eC5mb250ID0gJzIwcHggc2Fucy1zZXJpZic7CiAgICAgICAgICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9ICdjZW50ZXInOwogICAgICAgICAgICAgICAgICAgIGN0eC50ZXh0QmFzZWxpbmUgPSAnbWlkZGxlJzsKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFRleHQoJ05vIHJlY29yZGluZyB5ZXQnLCBjYW52YXMud2lkdGggLyAyLCBjYW52YXMuaGVpZ2h0IC8gMiAtIDMwKTsKICAgICAgICAgICAgICAgICAgICBjdHguZm9udCA9ICcxNHB4IHNhbnMtc2VyaWYnOwogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsVGV4dCgnUHJlc3MgIlN0YXJ0IFJlY29yZGluZyIgYW5kIHBsYXkgc29tZSBub3RlcycsIGNhbnZhcy53aWR0aCAvIDIsIGNhbnZhcy5oZWlnaHQgLyAyICsgMTApOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgZHVyYXRpb24gdG8gZGlzcGxheSAodXNlIHJlY29yZGluZyBkdXJhdGlvbiBvciBleHRlbmQgc2xpZ2h0bHkpCiAgICAgICAgICAgICAgICBjb25zdCBkaXNwbGF5RHVyYXRpb24gPSBNYXRoLm1heCh0aGlzLnJlY29yZGluZ0R1cmF0aW9uLCAxMDAwMCk7IC8vIEF0IGxlYXN0IDEwIHNlY29uZHMKICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVTY2FsZSA9IGNhbnZhcy53aWR0aCAvIGRpc3BsYXlEdXJhdGlvbjsgLy8gcGl4ZWxzIHBlciBtcwoKICAgICAgICAgICAgICAgIC8vIE1JREkgbm90ZSByYW5nZTogMC0xMjcsIGJ1dCB0eXBpY2FsbHkgdXNlIDIxIChBMCkgdG8gMTA4IChDOCkKICAgICAgICAgICAgICAgIGNvbnN0IG1pbk5vdGUgPSAyMTsKICAgICAgICAgICAgICAgIGNvbnN0IG1heE5vdGUgPSAxMDg7CiAgICAgICAgICAgICAgICBjb25zdCBub3RlUmFuZ2UgPSBtYXhOb3RlIC0gbWluTm90ZTsKICAgICAgICAgICAgICAgIGNvbnN0IG5vdGVIZWlnaHQgPSBjYW52YXMuaGVpZ2h0IC8gbm90ZVJhbmdlOwoKICAgICAgICAgICAgICAgIC8vIERyYXcgdGltZSBncmlkIChldmVyeSBzZWNvbmQpCiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSB0aGlzLnRoZW1lID09PSAnZGFyaycgPyAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpJyA6ICdyZ2JhKDAsIDAsIDAsIDAuMSknOwogICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDE7CiAgICAgICAgICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IGRpc3BsYXlEdXJhdGlvbjsgdCArPSAxMDAwKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgeCA9IHQgKiB0aW1lU2NhbGU7CiAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8oeCwgMCk7CiAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyh4LCBjYW52YXMuaGVpZ2h0KTsKICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gVGltZSBsYWJlbHMKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gdGhpcy50aGVtZSA9PT0gJ2RhcmsnID8gJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC41KScgOiAncmdiYSgwLCAwLCAwLCAwLjUpJzsKICAgICAgICAgICAgICAgICAgICBjdHguZm9udCA9ICcxMHB4IG1vbm9zcGFjZSc7CiAgICAgICAgICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9ICdsZWZ0JzsKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFRleHQoYCR7KHQvMTAwMCkudG9GaXhlZCgwKX1zYCwgeCArIDIsIDEyKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBEcmF3IG5vdGUgZ3JpZCAoZXZlcnkgb2N0YXZlID0gMTIgc2VtaXRvbmVzKQogICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy50aGVtZSA9PT0gJ2RhcmsnID8gJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC4wNSknIDogJ3JnYmEoMCwgMCwgMCwgMC4wNSknOwogICAgICAgICAgICAgICAgZm9yIChsZXQgbm90ZSA9IG1pbk5vdGU7IG5vdGUgPD0gbWF4Tm90ZTsgbm90ZSArPSAxMikgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHkgPSBjYW52YXMuaGVpZ2h0IC0gKChub3RlIC0gbWluTm90ZSkgKiBub3RlSGVpZ2h0KTsKICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgICAgICAgICAgICAgY3R4Lm1vdmVUbygwLCB5KTsKICAgICAgICAgICAgICAgICAgICBjdHgubGluZVRvKGNhbnZhcy53aWR0aCwgeSk7CiAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZSgpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIE9jdGF2ZSBsYWJlbHMKICAgICAgICAgICAgICAgICAgICBjb25zdCBvY3RhdmUgPSBNYXRoLmZsb29yKG5vdGUgLyAxMikgLSAxOwogICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lID09PSAnZGFyaycgPyAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjMpJyA6ICdyZ2JhKDAsIDAsIDAsIDAuMyknOwogICAgICAgICAgICAgICAgICAgIGN0eC5mb250ID0gJzEwcHggbW9ub3NwYWNlJzsKICAgICAgICAgICAgICAgICAgICBjdHgudGV4dEFsaWduID0gJ3JpZ2h0JzsKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFRleHQoYEMke29jdGF2ZX1gLCBjYW52YXMud2lkdGggLSA1LCB5IC0gMik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gRHJhdyByZWNvcmRlZCBub3RlcwogICAgICAgICAgICAgICAgdGhpcy5yZWNvcmRlZE5vdGVzLmZvckVhY2gobm90ZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgeCA9IG5vdGUucmVjb3JkaW5nU3RhcnRUaW1lICogdGltZVNjYWxlOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGR1cmF0aW9uID0gbm90ZS5lbmRUaW1lID8gKG5vdGUuZW5kVGltZSAtIG5vdGUucmVjb3JkaW5nU3RhcnRUaW1lKSA6IDEwMDsgLy8gRGVmYXVsdCAxMDBtcyBpZiBzdGlsbCBwbGF5aW5nCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2lkdGggPSBNYXRoLm1heCgyLCBkdXJhdGlvbiAqIHRpbWVTY2FsZSk7IC8vIEF0IGxlYXN0IDIgcGl4ZWxzIHdpZGUKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBZIHBvc2l0aW9uIGJhc2VkIG9uIE1JREkgbm90ZSAoaW52ZXJ0ZWQgLSBoaWdoIG5vdGVzIGF0IHRvcCkKICAgICAgICAgICAgICAgICAgICBjb25zdCB5ID0gY2FudmFzLmhlaWdodCAtICgobm90ZS5taWRpTm90ZSAtIG1pbk5vdGUpICogbm90ZUhlaWdodCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGVpZ2h0ID0gTWF0aC5tYXgoMiwgbm90ZUhlaWdodCAqIDAuOCk7IC8vIDgwJSBvZiBub3RlIGhlaWdodCBmb3Igc3BhY2luZwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIERyYXcgbm90ZSByZWN0YW5nbGUgd2l0aCBjb2xvcgogICAgICAgICAgICAgICAgICAgIGNvbnN0IGFscGhhID0gKG5vdGUudmVsb2NpdHkgLyAxMjcpICogMC44ICsgMC4yOyAvLyAwLjIgdG8gMS4wIGJhc2VkIG9uIHZlbG9jaXR5CiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGByZ2JhKCR7bm90ZS5jb2xvci5yfSwgJHtub3RlLmNvbG9yLmd9LCAke25vdGUuY29sb3IuYn0sICR7YWxwaGF9KWA7CiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KHgsIHkgLSBoZWlnaHQvMiwgd2lkdGgsIGhlaWdodCk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGJvcmRlciBmb3IgZGVmaW5pdGlvbgogICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGByZ2JhKCR7bm90ZS5jb2xvci5yfSwgJHtub3RlLmNvbG9yLmd9LCAke25vdGUuY29sb3IuYn0sIDEpYDsKICAgICAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMTsKICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlUmVjdCh4LCB5IC0gaGVpZ2h0LzIsIHdpZHRoLCBoZWlnaHQpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgLy8gRHJhdyBwbGF5aGVhZCBpZiByZWNvcmRpbmcKICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUmVjb3JkaW5nKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHRoaXMucmVjb3JkaW5nU3RhcnRUaW1lOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBsYXloZWFkWCA9IGN1cnJlbnRUaW1lICogdGltZVNjYWxlOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICcjZmYwMDAwJzsKICAgICAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMjsKICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgICAgICAgICAgICAgY3R4Lm1vdmVUbyhwbGF5aGVhZFgsIDApOwogICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8ocGxheWhlYWRYLCBjYW52YXMuaGVpZ2h0KTsKICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gTGVnZW5kCiAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gdGhpcy50aGVtZSA9PT0gJ2RhcmsnID8gJ3JnYmEoMCwgMCwgMCwgMC43KScgOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjcpJzsKICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCgxMCwgMTAsIDIwMCwgODApOwogICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUgPT09ICdkYXJrJyA/ICcjZmZmJyA6ICcjMDAwJzsKICAgICAgICAgICAgICAgIGN0eC5mb250ID0gJzEycHggc2Fucy1zZXJpZic7CiAgICAgICAgICAgICAgICBjdHgudGV4dEFsaWduID0gJ2xlZnQnOwogICAgICAgICAgICAgICAgY3R4LmZpbGxUZXh0KGBSZWNvcmRlZCBOb3RlczogJHt0aGlzLnJlY29yZGVkTm90ZXMubGVuZ3RofWAsIDIwLCAzMCk7CiAgICAgICAgICAgICAgICBjdHguZmlsbFRleHQoYER1cmF0aW9uOiAkeyhkaXNwbGF5RHVyYXRpb24vMTAwMCkudG9GaXhlZCgxKX1zYCwgMjAsIDUwKTsKICAgICAgICAgICAgICAgIGN0eC5maWxsVGV4dChgVGltZSDihpJgLCAyMCwgNzApOwogICAgICAgICAgICAgICAgY3R4LmZpbGxUZXh0KGBQaXRjaCDihpFgLCAyMCwgODUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB1cGRhdGVSZWNvcmRpbmdJbmZvKCkgewogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlY29yZGVkLW5vdGVzLWNvdW50JykudGV4dENvbnRlbnQgPSBgJHt0aGlzLnJlY29yZGVkTm90ZXMubGVuZ3RofSBub3Rlc2A7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1JlY29yZGluZykgewogICAgICAgICAgICAgICAgICAgIHRoaXMucmVjb3JkaW5nRHVyYXRpb24gPSBwZXJmb3JtYW5jZS5ub3coKSAtIHRoaXMucmVjb3JkaW5nU3RhcnRUaW1lOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKHRoaXMucmVjb3JkaW5nRHVyYXRpb24gLyA2MDAwMCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2Vjb25kcyA9IE1hdGguZmxvb3IoKHRoaXMucmVjb3JkaW5nRHVyYXRpb24gJSA2MDAwMCkgLyAxMDAwKTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVjb3JkaW5nLWR1cmF0aW9uJykudGV4dENvbnRlbnQgPSAKICAgICAgICAgICAgICAgICAgICAgICAgYCR7bWludXRlc306JHtzZWNvbmRzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBhbmltYXRlKCkgewogICAgICAgICAgICAgICAgY29uc3Qgbm93ID0gcGVyZm9ybWFuY2Uubm93KCk7CgogICAgICAgICAgICAgICAgaWYgKHRoaXMudmlld01vZGUgPT09ICdsYW5lcycpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxhbmVzLmZvckVhY2goKGxhbmUsIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IGxhbmUuY3R4OwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYW52YXMgPSBsYW5lLmNhbnZhczsKCiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobGFuZS5pbnN0cnVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdiYXNzJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckJhc3MobGFuZSwgY3R4LCBjYW52YXMsIG5vdyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjaG9yZHMnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyQ2hvcmRzKGxhbmUsIGN0eCwgY2FudmFzLCBub3cpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWVsb2R5JzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlck1lbG9keShsYW5lLCBjdHgsIGNhbnZhcywgbm93KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3BlcmN1c3Npb24nOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyUGVyY3Vzc2lvbihsYW5lLCBjdHgsIGNhbnZhcywgbm93KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnZpZXdNb2RlID09PSAnY29tYmluYXRpb24nKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gQ291bnQgdG90YWwgYWN0aXZlIG5vdGVzCiAgICAgICAgICAgICAgICAgICAgbGV0IHRvdGFsTm90ZXMgPSAwOwogICAgICAgICAgICAgICAgICAgIHRoaXMubGFuZXMuZm9yRWFjaChsYW5lID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxOb3RlcyArPSBsYW5lLmFjdGl2ZU5vdGVzLnNpemU7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsTm90ZXMgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBSZW5kZXJpbmcgY29tYmluYXRpb24gbW9kZSB3aXRoICR7dG90YWxOb3Rlc30gdG90YWwgbm90ZXNgKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJDb21iaW5hdGlvbihub3cpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnZpZXdNb2RlID09PSAndGltZWxpbmUnKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJUaW1lbGluZSgpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSByZWNvcmRpbmcgaW5mbyBpZiByZWNvcmRpbmcKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1JlY29yZGluZykgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVJlY29yZGluZ0luZm8oKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHRoaXMuYW5pbWF0ZSgpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc2hvd05vTWlkaU1lc3NhZ2UoKSB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm8tbWlkaS1tZXNzYWdlJykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGhpZGVOb01pZGlNZXNzYWdlKCkgewogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vLW1pZGktbWVzc2FnZScpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBJbml0aWFsaXplIHZpc3VhbGl6ZXIKICAgICAgICBjb25zdCB2aXN1YWxpemVyID0gbmV3IE1JRElWaXN1YWxpemVyKCk7CgogICAgICAgIC8vIENvbnRyb2wgcGFuZWwgdG9nZ2xlCiAgICAgICAgbGV0IGNvbnRyb2xzVmlzaWJsZSA9IHRydWU7CiAgICAgICAgZnVuY3Rpb24gdG9nZ2xlQ29udHJvbHMoKSB7CiAgICAgICAgICAgIGNvbnRyb2xzVmlzaWJsZSA9ICFjb250cm9sc1Zpc2libGU7CiAgICAgICAgICAgIGNvbnN0IHBhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRyb2wtcGFuZWwnKTsKICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcy1jb250YWluZXInKTsKICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRyb2wtdG9nZ2xlJyk7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoY29udHJvbHNWaXNpYmxlKSB7CiAgICAgICAgICAgICAgICBwYW5lbC5jbGFzc0xpc3QucmVtb3ZlKCdjb2xsYXBzZWQnKTsKICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdzaG93LWNvbnRyb2xzJyk7CiAgICAgICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSAn4pqZIFNldHRpbmdzJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHBhbmVsLmNsYXNzTGlzdC5hZGQoJ2NvbGxhcHNlZCcpOwogICAgICAgICAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctY29udHJvbHMnKTsKICAgICAgICAgICAgICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9ICfimpkgU2hvdyBTZXR0aW5ncyc7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFN0YXJ0IHdpdGggY29udHJvbHMgdmlzaWJsZQogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4gewogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzLWNvbnRhaW5lcicpLmNsYXNzTGlzdC5hZGQoJ3Nob3ctY29udHJvbHMnKTsKICAgICAgICB9KTsKCiAgICAgICAgLy8gVGhlbWUgc3dpdGNoaW5nCiAgICAgICAgZnVuY3Rpb24gc2V0VGhlbWUodGhlbWUpIHsKICAgICAgICAgICAgdmlzdWFsaXplci50aGVtZSA9IHRoZW1lOwogICAgICAgICAgICBpZiAodGhlbWUgPT09ICdsaWdodCcpIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnbGlnaHQtbW9kZScpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdsaWdodC1tb2RlJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFZpZXcgbW9kZSBzd2l0Y2hpbmcKICAgICAgICBmdW5jdGlvbiBzZXRWaWV3TW9kZShtb2RlKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTd2l0Y2hpbmcgdG8gJHttb2RlfSBtb2RlYCk7CiAgICAgICAgICAgIHZpc3VhbGl6ZXIudmlld01vZGUgPSBtb2RlOwogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzLWNvbnRhaW5lcicpOwogICAgICAgICAgICBjb25zdCBjbGVhckJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGVhci1wYXR0ZXJuLWJ0bicpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gU2hvdy9oaWRlIGNsZWFyIGJ1dHRvbiBiYXNlZCBvbiBtb2RlCiAgICAgICAgICAgIGlmIChtb2RlID09PSAnY29tYmluYXRpb24nKSB7CiAgICAgICAgICAgICAgICBjbGVhckJ0bi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNsZWFyQnRuLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFByZXNlcnZlIHNob3ctY29udHJvbHMgY2xhc3MKICAgICAgICAgICAgY29uc3QgaGFzQ29udHJvbHMgPSBjb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWNvbnRyb2xzJyk7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2NvbWJpbmF0aW9uJykgewogICAgICAgICAgICAgICAgY29udGFpbmVyLmNsYXNzTmFtZSA9ICdjb21iaW5hdGlvbi1tb2RlJzsKICAgICAgICAgICAgICAgIGlmIChoYXNDb250cm9scykgewogICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdzaG93LWNvbnRyb2xzJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2aXN1YWxpemVyLnJlc2l6ZUNvbWJpbmF0aW9uQ2FudmFzKCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gJ3RpbWVsaW5lJykgewogICAgICAgICAgICAgICAgY29udGFpbmVyLmNsYXNzTmFtZSA9ICd0aW1lbGluZS1tb2RlJzsKICAgICAgICAgICAgICAgIGlmIChoYXNDb250cm9scykgewogICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdzaG93LWNvbnRyb2xzJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2aXN1YWxpemVyLnJlc2l6ZVRpbWVsaW5lQ2FudmFzKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gJyc7CiAgICAgICAgICAgICAgICBpZiAoaGFzQ29udHJvbHMpIHsKICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgnc2hvdy1jb250cm9scycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBVcGRhdGUgYnV0dG9uIHN0YXRlcwogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubW9kZS1idXR0b24nKS5mb3JFYWNoKGJ0biA9PiB7CiAgICAgICAgICAgICAgICBidG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zb2xlLmxvZyhgVmlldyBtb2RlIGlzIG5vdzogJHt2aXN1YWxpemVyLnZpZXdNb2RlfWApOwogICAgICAgIH0KCiAgICAgICAgLy8gQ2xlYXIgY29tYmluYXRpb24gcGF0dGVybiBtYW51YWxseQogICAgICAgIGZ1bmN0aW9uIGNsZWFyQ29tYmluYXRpb25QYXR0ZXJuKCkgewogICAgICAgICAgICB2aXN1YWxpemVyLmNvbWJpbmF0aW9uTm90ZXMuY2xlYXIoKTsKICAgICAgICAgICAgdmlzdWFsaXplci5ub3RlU2VxdWVuY2UgPSBbXTsKICAgICAgICAgICAgdmlzdWFsaXplci50b3RhbE5vdGVzUGxheWVkID0gMDsKICAgICAgICAgICAgdmlzdWFsaXplci5pc0NsZWFyaW5nID0gZmFsc2U7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5eR77iPIFBhdHRlcm4gY2xlYXJlZCBtYW51YWxseScpOwogICAgICAgIH0KCiAgICAgICAgLy8gVXBkYXRlIHRvdGFsIG5vdGVzIHRocmVzaG9sZAogICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVRvdGFsTm90ZXNUaHJlc2hvbGQodmFsdWUpIHsKICAgICAgICAgICAgY29uc3QgdGhyZXNob2xkID0gcGFyc2VJbnQodmFsdWUpOwogICAgICAgICAgICBpZiAodGhyZXNob2xkID49IDEwICYmIHRocmVzaG9sZCA8PSAyMDApIHsKICAgICAgICAgICAgICAgIHZpc3VhbGl6ZXIubWF4VG90YWxOb3RlcyA9IHRocmVzaG9sZDsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGDinI/vuI8gUGF0dGVybiBjbGVhciB0aHJlc2hvbGQgdXBkYXRlZCB0byAke3RocmVzaG9sZH0gdG90YWwgbm90ZXNgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gVG9nZ2xlIHJlY29yZGluZwogICAgICAgIGZ1bmN0aW9uIHRvZ2dsZVJlY29yZGluZygpIHsKICAgICAgICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlY29yZC1idG4nKTsKICAgICAgICAgICAgY29uc3Qgc3RhdHVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlY29yZGluZy1zdGF0dXMnKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICghdmlzdWFsaXplci5pc1JlY29yZGluZykgewogICAgICAgICAgICAgICAgLy8gU3RhcnQgcmVjb3JkaW5nCiAgICAgICAgICAgICAgICB2aXN1YWxpemVyLmlzUmVjb3JkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHZpc3VhbGl6ZXIucmVjb3JkaW5nU3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgICAgICAgICAgICB2aXN1YWxpemVyLnJlY29yZGVkTm90ZXMgPSBbXTsKICAgICAgICAgICAgICAgIHZpc3VhbGl6ZXIucmVjb3JkaW5nRHVyYXRpb24gPSAwOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSAn4o+5IFN0b3AgUmVjb3JkaW5nJzsKICAgICAgICAgICAgICAgIGJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJyM0NDQnOwogICAgICAgICAgICAgICAgc3RhdHVzLnRleHRDb250ZW50ID0gJ1JlY29yZGluZy4uLic7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5S0IFJlY29yZGluZyBzdGFydGVkJyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBTdG9wIHJlY29yZGluZwogICAgICAgICAgICAgICAgdmlzdWFsaXplci5pc1JlY29yZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgdmlzdWFsaXplci5yZWNvcmRpbmdEdXJhdGlvbiA9IHBlcmZvcm1hbmNlLm5vdygpIC0gdmlzdWFsaXplci5yZWNvcmRpbmdTdGFydFRpbWU7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGJ0bi50ZXh0Q29udGVudCA9ICfij7ogU3RhcnQgUmVjb3JkaW5nJzsKICAgICAgICAgICAgICAgIGJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJyNjNDFlM2EnOwogICAgICAgICAgICAgICAgc3RhdHVzLnRleHRDb250ZW50ID0gJ1JlY29yZGluZyBzdG9wcGVkJzsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYOKPuSBSZWNvcmRpbmcgc3RvcHBlZC4gRHVyYXRpb246ICR7KHZpc3VhbGl6ZXIucmVjb3JkaW5nRHVyYXRpb24vMTAwMCkudG9GaXhlZCgyKX1zLCBOb3RlczogJHt2aXN1YWxpemVyLnJlY29yZGVkTm90ZXMubGVuZ3RofWApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICB2aXN1YWxpemVyLnVwZGF0ZVJlY29yZGluZ0luZm8oKTsKICAgICAgICB9CgogICAgICAgIC8vIENsZWFyIHJlY29yZGluZwogICAgICAgIGZ1bmN0aW9uIGNsZWFyUmVjb3JkaW5nKCkgewogICAgICAgICAgICBpZiAoY29uZmlybSgnQ2xlYXIgdGhlIGN1cnJlbnQgcmVjb3JkaW5nPycpKSB7CiAgICAgICAgICAgICAgICB2aXN1YWxpemVyLnJlY29yZGVkTm90ZXMgPSBbXTsKICAgICAgICAgICAgICAgIHZpc3VhbGl6ZXIucmVjb3JkaW5nRHVyYXRpb24gPSAwOwogICAgICAgICAgICAgICAgdmlzdWFsaXplci51cGRhdGVSZWNvcmRpbmdJbmZvKCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWNvcmRpbmctc3RhdHVzJykudGV4dENvbnRlbnQgPSAnUmVjb3JkaW5nIGNsZWFyZWQnOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ/Cfl5HvuI8gUmVjb3JkaW5nIGNsZWFyZWQnKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gSW5mbyBtb2RhbAogICAgICAgIGZ1bmN0aW9uIHRvZ2dsZUluZm8oKSB7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbmZvLW1vZGFsJykuY2xhc3NMaXN0LnRvZ2dsZSgndmlzaWJsZScpOwogICAgICAgIH0KCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm8tbW9kYWwnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7CiAgICAgICAgICAgIGlmIChlLnRhcmdldC5pZCA9PT0gJ2luZm8tbW9kYWwnKSB0b2dnbGVJbmZvKCk7CiAgICAgICAgfSk7CgogICAgICAgIGNvbnNvbGUubG9nKCdFbmhhbmNlZCBOZXd0b25cJ3MgQ2hyb21hdGljIE1JREkgVmlzdWFsaXplciBsb2FkZWQnKTsKICAgIDwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4K";

    </script>
</body>
</html>
